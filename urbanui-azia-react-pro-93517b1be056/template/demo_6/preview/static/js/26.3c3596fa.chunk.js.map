{"version":3,"sources":["../node_modules/@fullcalendar/core/main.esm.js","../node_modules/@fullcalendar/react/main.esm.js","../node_modules/fast-deep-equal/index.js","../node_modules/@fullcalendar/daygrid/main.esm.js"],"names":["elementPropHash","className","colSpan","rowSpan","containerTagHash","createElement","tagName","attrs","content","el","document","attrName","applyStyle","setAttribute","innerHTML","appendToElement","htmlToElement","html","trim","container","computeContainerTag","firstChild","htmlToElements","Array","prototype","slice","call","childNodes","htmlToNodeList","substr","normalizeContent","i","length","appendChild","prependToElement","parent","newEls","afterEl","insertBefore","insertAfterElement","refEl","nextSibling","parentNode","Node","removeElement","removeChild","matchesMethod","Element","matches","matchesSelector","msMatchesSelector","closestMethod","closest","selector","this","documentElement","contains","elementMatches","parentElement","nodeType","elementClosest","findElements","containers","HTMLElement","allMatches","querySelectorAll","j","push","findChildren","parents","children","childNode","PIXEL_PROP_RE","props","propName","applyStyleProp","name","val","style","test","isRtlScrollbarOnLeft","getIsRtlScrollbarOnLeft","outerEl","position","top","left","border","padding","overflow","direction","body","res","getBoundingClientRect","computeIsRtlScrollbarOnLeft","sanitizeScrollbarWidth","width","Math","max","round","computeEdges","getPadding","computedStyle","window","getComputedStyle","borderLeft","parseInt","borderLeftWidth","borderRight","borderRightWidth","borderTop","borderTopWidth","borderBottom","borderBottomWidth","scrollbarLeftRight","offsetWidth","clientWidth","scrollbarBottom","offsetHeight","clientHeight","scrollbarLeft","scrollbarRight","paddingLeft","paddingRight","paddingTop","paddingBottom","computeRect","rect","pageXOffset","pageYOffset","right","bottom","computeHeightAndMargins","height","computeVMargins","computed","marginTop","marginBottom","computeClippingRect","overflowY","overflowX","getClippingParents","map","goWithinPadding","outerRect","edges","computeInnerRect","concat","reduce","rect0","rect1","rect2","min","intersectRects","listenBySelector","eventType","handler","realHandler","ev","matchedChild","target","addEventListener","removeEventListener","DAY_IDS","addWeeks","m","n","a","dateToUtcArray","arrayToUtcDate","addDays","addMs","diffWeeks","m0","m1","diffDays","valueOf","diffWholeDays","timeAsMs","startOfDay","getUTCFullYear","getUTCMonth","getUTCDate","weekOfGivenYear","marker","year","dow","doy","firstWeekStart","firstWeekOffset","dayStart","days","floor","fwd","getUTCDay","dateToLocalArray","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","arrayToLocalDate","Date","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","UTC","apply","isValidDate","isNaN","PARSE_RE","createDuration","input","unit","_a","s","exec","sign","years","months","milliseconds","parseString","normalizeObject","obj","month","day","getWeeksFromInput","hours","hour","minutes","minute","seconds","second","millisecond","ms","weeks","week","durationsEqual","d0","d1","asRoughDays","dur","asRoughMs","greatestDurationDenominator","dontReturnWeeks","value","compensateScroll","rowEl","scrollbarWidths","marginLeft","marginRight","uncompensateScroll","distributeHeight","els","availableHeight","shouldRedistribute","minOffset1","minOffset2","flexEls","flexOffsets","flexHeights","usedHeight","undistributeHeight","forEach","minOffset","naturalHeight","naturalOffset","newHeight","matchCellWidths","maxInnerWidth","innerEl","innerWidth_1","subtractInnerElHeight","reflowStyleProps","diff","resetStyleProps","compareByFieldSpec","obj0","obj1","fieldSpec","func","b","String","localeCompare","flexibleCompare","field","order","capitaliseFirstLetter","str","charAt","toUpperCase","padStart","len","isInt","applyAll","functions","thisObj","args","ret","firstDefined","_i","arguments","undefined","debounce","wait","timeout","context","timestamp","result","later","last","setTimeout","refineProps","rawProps","processors","defaults","leftoverProps","refined","key","processor","Function","Number","Boolean","computeAlignedDayRange","timedRange","dayCnt","start","end","computeVisibleDayRange","nextDayThreshold","startDay","endDay","endTimeMS","diffDates","date0","date1","dateEnv","largeUnit","diffWholeYears","diffWholeMonths","m0day","m1day","diffDayAndTime","extendStatics","d","Object","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","create","__assign","assign","t","expandRecurringRanges","eventDef","duration","framingRange","recurringTypes","markers","recurringDef","typeId","expand","typeData","subtract","allDay","mergeProps","propObjs","complexProps","complexObjs","dest","unshift","filterHash","hash","filtered","mapHash","newHash","arrayToHash","a_1","hashValuesToArray","isPropsEqual","parseEvents","rawEvents","sourceId","calendar","allowOpenRange","eventStore","defs","instances","rawEvents_1","tuple","parseEvent","eventTupleToStore","def","defId","instance","instanceId","expandRecurring","defaultAllDayEventDuration","defaultTimedEventDuration","starts_1","pluginSystem","hooks","createEventInstance","add","getRelevantEvents","def_1","newStore","filterEventStoreDefs","lookDef","def0","def1","groupId","transformEachRawEvent","refinedEvents","rawEvents_2","rawEvent","refinedEvent","mergeEventStores","store0","store1","filterFunc","parseRange","createMarker","invertRanges","ranges","constraintRange","dateRange","invertedRanges","sort","compareRanges","range0","range1","intersectRanges","newRange","rangesEqual","rangesIntersect","rangeContainsRange","outerRange","innerRange","rangeContainsMarker","range","isArraysEqual","a0","a1","memoize","workerFunc","EXTENDED_SETTINGS_AND_SEVERITIES","separator","omitZeroMinute","meridiem","omitCommas","STANDARD_DATE_PROP_SEVERITIES","timeZoneName","era","weekday","MERIDIEM_RE","COMMA_RE","MULTI_SPACE_RE","LTR_RE","UTC_RE","NativeFormatter","formatSettings","standardDateProps","extendedSettings","severity","name_1","buildFormattingFunc","format","formatRange","diffSeverity","ca","getMarkerYear","getMarkerMonth","getMarkerDay","computeMarkerDiffSeverity","calendarSystem","biggestUnitForPartial","full0","full1","partialFormattingFunc","options","biggestUnit","partialOptions","name_2","computePartialFormattingOptions","partial0","partial1","insertion","i0","found0","indexOf","before0","after0","i1","found1","before1","after1","before","after","findCommonInsertion","getLargestUnit","standardDatePropCnt","keys","formatTimeZoneOffset","timeZoneOffset","num","weekLabel","locale","display","parts","simpleNumberFormat","isRtl","reverse","join","formatWeekNumber","computeWeekNumber","sanitizeSettings","timeZone","zeroFormat","normalFormat","Intl","DateTimeFormat","codes","zeroProps","replace","tzoStr","replaced","injectTzoStr","toLocaleLowerCase","postProcess","buildNativeFormattingFunc","CmdFormatter","cmdStr","cmdFormatter","createVerboseFormattingArg","FuncFormatter","createFormatter","defaultSeparator","doIso","abs","mins","startInfo","expandZonedMarker","localeCodes","dateInfo","markerToArray","array","EventSourceApi","internalEventSource","remove","dispatch","type","refetch","sourceIds","defineProperty","get","publicId","enumerable","configurable","meta","url","EventApi","_calendar","_def","_instance","setProp","_b","DATE_PROPS","NON_DATE_PROPS","mutate","standardProps","UNSCOPED_EVENT_UI_PROPS","ui","backgroundColor","borderColor","startEditable","durationEditable","setExtendedProp","extendedProps","setStart","startInput","startDelta","granularity","maintainDuration","datesDelta","setEnd","endInput","endDelta","hasEnd","setDates","instanceRange","moveStart","deltaInput","delta","moveEnd","moveDates","setAllDay","opt","formatInput","formatter","forcedStartTzo","forcedEndTzo","forcedTzo","mutation","fromApi","state","eventSources","toDate","title","rendering","constraints","overlap","allows","textColor","classNames","sliceEventStore","eventUiBases","inverseBgByGroupId","inverseBgByDefId","defByGroupId","bgRanges","fgRanges","eventUis","compileEventUis","origRange","normalRange","slicedRange","isStart","isEnd","invertedRanges_1","invertedRange","invertedRanges_2","bg","fg","filterSegsViaEls","view","segs","isMirror","hasPublicHandlers","filter","seg","custom","publiclyTrigger","event","eventRange","segs_1","setElSeg","fcSeg","getElSeg","eventDefs","compileEventUi","uis","combineEventUis","applyMutationToEventDef","eventConfig","appliers","copy","appliers_1","applier","applyMutationToEventInstance","eventInstance","forceAllDay","clearEnd","getDefaultEventEnd","reduceEventStore","action","dateProfile","eventSource","fetchId","fetchRange","latestFetchId","subset","calEachTransform","sourceEachTransform","eventDataTransform","transformRawEvents","excludeEventsBySourceId","receiveRawEvents","expandRange","addEvent","activeRange","oldDateEnv","newDateEnv","canComputeOffset","rezoneDates","relevant","eventConfigBase","eventConfigs","eventDefMutationAppliers","applyMutationToEventStore","applyMutationToRelated","excludeInstances","removals","isNewPropsValid","newProps","businessHours","dateSelection","eventSelection","eventDrag","eventResize","isPropsValid","dateSpanMeta","filterConfig","interaction","subjectEventStore","mutatedEvents","subjectDefs","subjectInstances","subjectConfigs","isEvent","selectionConfig","otherEventStore","affectedEvents","otherDefs","otherInstances","otherConfigs","subjectInstanceId","subjectInstance","subjectRange","subjectConfig","subjectDef","allConstraintsPass","overlapFunc","otherInstanceId","otherInstance","calendarEventStore","subjectAllow","subjectDateSpan","origDef","origInstance","eventApi","buildDateSpanApi","isInteractionPropsValid","relevantEventStore","relevantDefs","relevantInstances","selection","selectionRange","relevantInstanceId","relevantInstance","selectionAllow","fullDateSpan","isDateSelectionPropsValid","businessHoursUnexpanded","constraints_1","anyRangesContainRange","constraintToRanges","constraint","eventStoreToRanges","outerRanges","outerRanges_1","htmlEscape","cssToStr","cssProps","statements","parseClassName","raw","isArray","split","editable","allow","color","processUnscopedUiProps","leftovers","normalizeConstraint","processScopedUiProps","prefix","rawScoped","rawUnscoped","wasFound","scopedKey","EMPTY_EVENT_UI","combineTwoEventUis","item0","item1","id","uid","allDayDefault","source","computeIsAllDayDefault","leftovers0","recurringRes","eventInput","localLeftovers","parsed","parse","allDayGuess","parseRecurring","parseEventDef","leftovers1","singleRes","startMeta","endMeta","pluckDateProps","startMarker","endMarker","createMarkerMeta","isTimeUnspecified","parseSingle","preLeftovers","pluckNonDateProps","eventDefParsers","newLeftovers","eventDefParser","freeze","DEF_DEFAULTS","startTime","endTime","daysOfWeek","parseBusinessHours","rawDefs","rawDef","refineInputs","memoizeRendering","renderFunc","unrenderFunc","dependencies","thisContext","prevArgs","dependents","unrender","dependents_1","dependencies_1","EMPTY_EVENT_STORE","Splitter","getKeysForEventDefs","_getKeysForEventDefs","splitDateSelection","_splitDateSpan","splitEventStore","_splitEventStore","splitIndividualUi","_splitIndividualUi","splitEventDrag","_splitInteraction","splitEventResize","eventUiBuilders","splitProps","_this","keyInfos","getKeyInfo","defKeys","dateSelections","individualUi","eventStores","eventDrags","eventResizes","info","buildEventUiForKey","keyInfo","buildEventUi","dateSpan","dateSpans","keys_1","getKeysForDateSpan","getKeysForEventDef","splitStores","_c","splitHashes","splitStates","affectedStores_1","mutatedKeysByDefId","mutatedStores_1","populate","origSeg","allUi","eventUiForKey","baseParts","stuff","buildGotoAnchorHtml","component","gotoOptions","innerHtml","forceOff","finalOptions","formatIso","omitTime","attrsToStr","JSON","stringify","getDayClasses","noThemeHighlight","todayStart","todayEnd","theme","classes","currentRange","getNow","getClass","EmitterMixin","_super","on","addToHash","_handlers","one","_oneHandlers","off","removeFromHash","trigger","triggerWith","hasHandlers","Mixin","mixInto","destClass","mixIntoObj","destObj","getOwnPropertyNames","mixOver","PositionCache","originEl","isHorizontal","isVertical","build","originClientRect","buildElHorizontals","buildElVerticals","originClientLeft","lefts","rights","originClientTop","tops","bottoms","leftToIndex","leftPosition","topToIndex","topPosition","getWidth","leftIndex","getHeight","topIndex","ScrollController","getMaxScrollTop","getScrollHeight","getClientHeight","getMaxScrollLeft","getScrollWidth","getClientWidth","canScrollVertically","canScrollHorizontally","canScrollUp","getScrollTop","canScrollDown","canScrollLeft","getScrollLeft","canScrollRight","ElementScrollController","scrollTop","scrollLeft","setScrollTop","setScrollLeft","scrollWidth","scrollHeight","ScrollComponent","WindowScrollController","scroll","applyOverflow","clear","setHeight","destroy","lockOverflow","getScrollbarWidths","Theme","calendarOptions","processIconOverride","iconOverrideOption","setIconOverride","iconOverrideHash","iconClassesCopy","buttonName","iconClasses","applyIconOverridePrefix","iconOverridePrefix","getIconClass","baseIconClass","getCustomButtonIconClass","customButtonProps","iconOverrideCustomButtonOption","guid","Component","isView","addEqualityFuncs","newFuncs","equalityFuncs","receiveProps","oldProps","comboProps","anyChanges","recycleProps","render","DateComponent","buildPositionCaches","queryHit","positionLeft","positionTop","elWidth","elHeight","isInteractionValid","validRange","isDateSelectionValid","publiclyTriggerAfterSizing","triggerRenderedSegs","isMirrors","loadingLevel","afterSizingTriggers","_eventsPositioned","triggerWillRemoveSegs","segs_2","segs_3","isValidSegDownEl","isPopover","isInPopover","isValidDateDownEl","segEl","fgSegSelector","classList","bgSegSelector","uid$1","createPlugin","deps","reducers","isDraggableTransformers","eventDragMutationMassagers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","views","viewPropsTransformers","externalDefTransforms","eventResizeJoinTransforms","viewContainerModifiers","eventDropTransformers","componentInteractions","calendarInteractions","themeClasses","eventSourceDefs","namedTimeZonedImpl","defaultView","elementDraggingImpl","optionChangeHandlers","PluginSystem","addedHash","plugin","dep","hooks0","hooks1","ArrayEventSourcePlugin","ignoreRange","parseMeta","events","fetch","arg","success","FuncEventSourcePlugin","failure","isResolved","wrappedSuccess","wrappedFailure","then","unpromisify","bind","startStr","endStr","requestJson","method","params","successCallback","failureCallback","encodeParams","injectQueryStringParams","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","responseText","err","onerror","send","encodeURIComponent","JsonFeedEventSourcePlugin","extraParams","startParam","endParam","timeZoneParam","requestParams","customRequestParams","buildRequestParams","errorMessage","message","SimpleRecurrencePlugin","startRecur","endRecur","anyValid","clippedFramingRange","dowHash","dayMarker","instanceStarts","instanceStart","expandRanges","DefaultOptionChangeHandlers","deepEqual","handleEventSources","plugins","inputs","addPluginInputs","unfoundSources","newInputs","inputs_1","inputFound","_raw","splice","unfoundSources_1","unfoundSource","newInputs_1","newInput","addEventSource","globalDefaults","defaultRangeSeparator","titleRangeSeparator","forceEventDuration","columnHeader","aspectRatio","header","center","weekends","weekNumbers","weekNumberCalculation","scrollTime","minTime","maxTime","showNonCurrentDates","lazyFetching","locales","timeGridEventMinHeight","themeSystem","dragRevertDuration","dragScroll","allDayMaintainDuration","unselectAuto","dropAccept","eventOrder","eventLimit","eventLimitClick","dayPopoverFormat","handleWindowResize","windowResizeDelay","longPressDelay","eventDragMinDistance","rtlDefaults","buttonIcons","prev","next","prevYear","nextYear","complexOptions","INTERNAL_PLUGINS","RAW_EN_LOCALE","code","dir","buttonText","today","list","allDayText","eventLimitText","noEventsMessage","parseRawLocales","explicitRawLocales","defaultCode","globalArray","globalObject","allRawLocales","rawLocaleMap","en","allRawLocales_1","rawLocale","buildLocale","inputSingular","available","codeArg","simpleId","queryRawLocale","parseLocale","queryLocale","merged","NumberFormat","OptionsManager","overrides","dynamicOverrides","compute","updates","isDynamic","overrideHash","removals_1","localeDefaults","dirDefaults","calendarSystemClassMap","theClass","GregorianCalendarSystem","arrayToMarker","arr","ISO_RE","DateEnv","settings","isNamedTimeZone","namedTimeZoneImpl","createCalendarSystem","weekDow","weekDoy","firstDay","weekNumberFunc","createNowMarker","timestampToMarker","getYear","addYears","addMonths","greatestWholeUnit","diffWholeWeeks","diffHours","diffMinutes","diffSeconds","countDurationsBetween","asRoughMonths","startOf","startOfYear","startOfMonth","startOfWeek","startOfHour","startOfMinute","startOfSecond","y","w","nextW","weekOfYear","dateOptions","offsetForMarker","isEndExclusive","extraOptions","omitTimeZoneOffset","stripZeroTime","toISOString","buildIsoString","timestampToArray","getTimezoneOffset","offsetForArray","SIMPLE_SOURCE_PROPS","uid$2","doesSourceNeedRange","sourceDefId","parseEventSource","parseEventSourceProps","isFetching","reduceEventSources","eventSourceHash","sources","sources_1","fetchDirtySources","addSources","fetchSourcesByIds","excludeStaticSources","sourceHash","receiveResponse","uid$3","isSourceDirty","prevSources","sourceIdHash","nextSources","fetchSource","sourceDef","calSuccessRes","sourceSuccessRes","calSuccess","error","callFailure","console","warn","DateProfileGenerator","viewSpec","initHiddenDays","buildPrev","currentDateProfile","currentDate","prevDate","currentRangeUnit","dateIncrement","buildNext","nextDate","forceToValid","currentInfo","isRangeAllDay","renderRange","isValid","buildValidRange","trimHiddenDays","buildCurrentRangeInfo","buildRenderRange","adjustActiveRange","buildDateIncrement","getRangeOption","dayCount","durationUnit","buildRangeFromDuration","buildRangeFromDayCount","buildCustomVisibleRange","getFallbackDuration","class","usesMinMaxTime","dateIncrementInput","dateIncrementDuration","alignment","dateAlignment","computeRes","isHiddenDay","skipHiddenDays","customAlignment","runningCount","visibleRange","fallback","otherArgs","hiddenDays","isHiddenDayHash","Error","inc","isExclusive","viewType","currentViewType","reduceViewType","newDateProfile","dateProfileGenerators","dateMarker","generator","p0","p1","reduceDateProfile","nextState","reduceCurrentDate","reduceDateSelection","reduceSelectedEvent","reduceEventDrag","reduceEventResize","eventSourceLoadingLevel","computeLoadingLevel","reducerFunc","newDate","currentSelection","currentInstanceId","eventInstanceId","currentDrag","newDrag","currentResize","newResize","cnt","STANDARD_PROPS","parseDateSpan","defaultDuration","span","parseOpenDateSpan","fabricateEventRange","ensureViewDef","defaultConfigs","overrideConfigs","viewDef","defaultConfig","overrideConfig","queryProp","superType","findViewNameBySubclass","superDef","buildViewDef","viewSubclass","configs","superProto","getPrototypeOf","parseViewConfigs","parseViewConfig","VIEW_DEF_PROPS","buildViewSpecs","defaultInputs","optionsManager","compileViewDefs","durationInput","singleUnit","singleUnitOverrides","denom","queryButtonText","buttonTextMap","buttonTextKey","buttonTextOverride","buttonTextDefault","buildViewSpec","Toolbar","extraClassName","_renderLayout","renderLayout","unrenderLayout","_updateTitle","updateTitle","_updateActiveButton","updateActiveButton","_updateToday","updateToday","_updatePrev","updatePrev","_updateNext","updateNext","layout","activeButton","isTodayEnabled","isPrevEnabled","isNextEnabled","viewsWithButtons","renderSection","buttonStr","viewSpecs","sectionEl","calendarCustomButtons","customButtons","calendarButtonTextOverrides","calendarButtonText","buttonGroupStr","groupEl","groupChildren","isOnlyButtons","buttonClick","buttonIcon","buttonInnerHtml","buttonClasses","buttonEl","buttonAriaAttr","click","text","changeView","buttonGroupClassName","toggleButtonEnabled","titleEl","innerText","bool","disabled","CalendarComponent","_renderToolbars","renderToolbars","buildViewPropTransformers","contentEl","modifyViewContainer","toggleElClassNames","computeTitle","footer","dirClassName","themeClassName","freezeHeight","dateProfileGenerator","renderView","updateSize","thawHeight","headerLayout","footerLayout","now","todayInfo","prevInfo","nextInfo","toolbarProps","addScroll","queryScroll","viewProps","transformers_1","transformer","transform","isResize","isHeightAuto","computeHeightVars","viewHeight","updateNowIndicator","popScroll","heightInput","contentHeightInput","queryToolbarsHeight","parentEl","viewOptions","titleFormat","computeTitleFormat","theClasses","Interaction","interactionSettingsStore","EventClicking","handleSegClick","hasUrlContainer","querySelector","href","jsEvent","defaultPrevented","location","EventHovering","handleEventElRemove","currentSegEl","handleSegLeave","handleSegEnter","triggerEvent","removeHoverListeners","onMouseEnter","onMouseLeave","currentMatchedChild","realOnMouseLeave_1","listenToHoverBySelector","publicEvName","StandardTheme","widget","widgetHeader","widgetContent","buttonGroup","button","buttonActive","popoverHeader","popoverContent","headerRow","dayRow","listView","close","Calendar","buildDateEnv","buildTheme","buildEventUiSingleBase","_buildEventUiSingleBase","buildSelectionConfig","_buildSelectionConfig","buildEventUiBySource","equalityFunc","cachedRes","newRes","memoizeOutput","buildEventUiBases","interactionsStore","actionQueue","isReducing","needsRerender","needsFullRerender","isRendering","renderingPauseDepth","buildDelayedRerender","isViewUpdated","isDatesUpdated","isEventsUpdated","handleOptions","hydrate","calendarInteractionClass","pluginInputs","pluginDefs","pluginInputs_1","pluginInput","globalName","default","refinePluginDefs","pluginDefs_1","pluginDef","requestRerender","renderableEventStore","bindHandlers","executeRender","unbindHandlers","removeNavLinkListener","anchorEl","getAttribute","customAction","viewOpt","zoomTo","windowResizeProxy","windowResize","buildInitialState","rawSources","singleRawSource","rawSources_1","batchRendering","getInitialDate","oldState","shift","newState","needsFull","delayedRerender","tryRerender","renderComponent","savedScroll","eventUiSingleBase","eventUiBySource","applyScroll","releaseAfterSizingTriggers","setOption","mutateOptions","getOption","viewOpts","changeHandlers","normalUpdates","specialUpdates","isTimeZoneDirty","isSizeDirty","anyDifficultOptions","name_3","pluginHooks","rerenderDelay","availableRawLocales","dateProfileGeneratorClass","getAvailableLocaleCodes","rawOpts","eventEditable","optHandler","name_4","isValidViewType","dateOrRange","unselect","spec","getUnitViewSpec","viewTypes","defaultDateInput","gotoDate","zonedDateInput","incrementDate","formatDate","isHandlingWindowResize","registerInteractiveComponent","settingsInput","useEventCenter","parseInteractionSettings","interactions","interactionClass","unregisterInteractiveComponent","select","dateOrObj","endDate","triggerDateSelect","pev","triggerDateUnselect","origEvent","triggerDateClick","dayEl","buildDatePointApi","dateStr","sourceInput","sourceApi","getEventSourceById","getEventById","getEvents","eventApis","removeAllEvents","rerenderEvents","getEventSources","sourceApis","internalId","removeAllEventSources","refetchEvents","scrollToTime","timeInput","scrollToDuration","View","renderDatesMem","renderDatesWrap","unrenderDatesWrap","renderBusinessHoursMem","renderBusinessHours","unrenderBusinessHours","renderDateSelectionMem","renderDateSelectionWrap","unrenderDateSelectionWrap","renderEventsMem","renderEvents","unrenderEvents","renderEventSelectionMem","renderEventSelectionWrap","unrenderEventSelectionWrap","renderEventDragMem","renderEventDragWrap","unrenderEventDragWrap","renderEventResizeMem","renderEventResizeWrap","unrenderEventResizeWrap","eventOrderSpecs","token","specs","tokens","substring","parseFieldSpecs","initialize","isAuto","updateBaseSize","renderDates","startNowIndicator","stopNowIndicator","unrenderDates","renderDateSelection","unrenderDateSelection","sliceEvents","computeEventDraggable","eventUi","transformers","computeEventStartResizable","computeEventEndResizable","renderEventSelection","unrenderEventSelection","renderEventDrag","unrenderEventDrag","renderEventResize","unrenderEventResize","update","delay","getNowIndicatorUnit","initialNowDate","initialNowQueriedMs","nowIndicatorTimeoutID","nowIndicatorIntervalID","setInterval","unrenderNowIndicator","renderNowIndicator","isNowIndicatorRendered","clearTimeout","clearInterval","queuedScroll","applyQueuedScroll","queryDateScroll","computeDateScroll","applyDateScroll","FgEventRenderer","renderSegs","mirrorInfo","rangeUpdated","renderSegEls","attachSegs","_segs","detachSegs","displayEventTime","displayEventEnd","eventTimeFormat","computeEventTimeFormat","computeDisplayEventTime","computeDisplayEventEnd","renderSegHtml","getSegClasses","isDraggable","isResizable","isDragging","isResizing","getTimeText","displayEnd","_getTimeText","getSkinCss","sortEventSegs","objs","buildSegCompareObj","fieldSpecs","cmp","compareByFieldSpecs","c","_seg","computeSizes","force","computeSegSizes","assignSizes","assignSegSizes","hideByHash","visibility","showByHash","selectByInstanceId","unselectByInstanceId","FillRenderer","fillSegTag","dirtySizeFlags","containerElsByType","segsByType","getSegsByType","renderedSegs","containerEls","css","toLowerCase","ElementDragging","emitter","setMirrorIsVisible","setMirrorNeedsRevert","setAutoScrollEnabled","renderDateCell","datesRepDistinctDays","colCnt","colHeadFormat","colspan","otherAttrs","isDateValid","columnHeaderHtml","columnHeaderText","DayHeader","thead","dates","renderIntroHtml","computeFallbackHeaderFormat","dates_1","DaySeries","indices","dayIndex","sliceRange","firstIndex","getDateDayIndex","lastIndex","clippedFirstIndex","clippedLastIndex","ceil","dayOffset","DayTable","daySeries","breakOnWeeks","daysPerRow","rowCnt","cells","buildCells","headerDates","buildHeaderDates","rows","row","col","buildCell","seriesSeg","index","nextIndex","firstCol","lastCol","Slicer","sliceBusinessHours","_sliceBusinessHours","sliceDateSelection","_sliceDateSpan","_sliceEventStore","sliceEventDrag","_sliceInteraction","sliceEventResize","sliceProps","extraArgs","eventSegs","dateSelectionSegs","businessHourSegs","fgEventSegs","bgEventSegs","sliceNowDate","computeActiveRange","rangeRes","sliceEventRanges","affectedInstances","sourceSeg","eventRanges","eventRanges_1","sliceEventRange","isComponentAllDay","FullCalendar","elRef","createRef","ref","componentDidMount","current","componentDidUpdate","componentWillUnmount","getApi","keyList","hasProp","module","exports","equal","arrA","arrB","dateA","dateB","getTime","regexpA","RegExp","regexpB","toString","DayGridDateProfileGenerator","endOfWeek","monthMode","fixedWeekCount","Popover","isHidden","margin","documentMousedown","hide","show","autoHide","elDims","origin","offsetParent","clippingRect","SimpleDayGridEventRenderer","timeText","titleHtml","isResizableFromStart","isResizableFromEnd","skinCss","timeHtml","DayGridEventRenderer","dayGrid","rowStructs","renderSegRows","rowEls","rowNode","tbodyEl","removeSegPopover","rowStruct","pop","segRows","groupSegRows","renderSegRow","rowSegs","levelSegs","tr","td","segLevels","buildSegLevels","levelCnt","tbody","segMatrix","cellMatrix","loneCellMatrix","emptyCellsUntil","endCol","leftCol","rightCol","introHtml","renderProps","levels","isDaySegCollision","level","compareDaySegCols","otherSegs","otherSeg","DayGridMirrorRenderer","skeletonTopEl","skeletonTop","skeletonEl","DayGridFillRenderer","renderFillRow","trEl","startCol","getElementsByTagName","DayTile","eventRenderer","DayTileEventRenderer","renderFrame","_renderFrame","renderFgEvents","fgSegs","eventDragInstances","eventResizeInstances","segContainerEl","layer","dayTile","DayBgRow","renderHtml","cell","renderCellHtml","htmlAttrs","DAY_NUM_FORMAT","WEEK_NUM_FORMAT","DayGrid","bottomCoordPadding","isCellSizesDirty","fillRenderer","mirrorRenderer","renderCells","_renderCells","_unrenderCells","renderBgEvents","_renderEventDrag","_unrenderEventDrag","_renderEventResize","_unrenderEventResize","isRigid","segPopoverTile","updateSegPopoverTile","getCellRange","ownProps","renderDayRowHtml","cellEls","rowPositions","colPositions","getCellEl","bgRow","renderBgIntroHtml","getIsNumbersVisible","renderNumberTrHtml","getIsDayNumbersVisible","cellWeekNumbersVisible","colWeekNumbersVisible","intro","renderNumberIntroHtml","renderNumberCellsHtml","htmls","renderNumberCellHtml","weekCalcFirstDow","isDayNumberVisible","buildColPositions","buildRowPositions","positionToHit","relativeRect","segPopover","limitRows","levelLimit","rowLevelLimit","unlimitRow","computeRowLevelLimit","limitRow","rowBottom","trEls","limitedNodes","segsBelow","totalSegsBelow","colSegsBelow","segMoreNodes","moreTd","moreWrap","moreLink","moreNodes","getCellSegs","renderMoreLink","node","moreEls","limitedEls","limitedEl","hiddenSegs","getMoreLinkText","clickOption","_col","moreEl","currentTarget","allSegs","reslicedAllSegs","resliceDaySegs","reslicedHiddenSegs","showSegPopover","topEl","dayDate","dayRange","newSegs","startLevel","WEEK_NUM_FORMAT$1","DayGridView","renderHeadIntroHtml","weekNumberStyleAttr","renderDayGridNumberIntroHtml","weekStart","renderDayGridBgIntroHtml","renderDayGridIntroHtml","renderSkeletonHtml","scroller","dayGridContainerEl","dayGridEl","weekNumberWidth","hasRigidRows","scrollerHeight","headRowEl","computeScrollerHeight","setGridHeight","SimpleDayGrid","slicer","DayGridSlicer","dayTable","rawHit","DayGridView$1","_context","buildDayTable","simpleDayGrid","main","dayGridDay","dayGridWeek","dayGridMonth"],"mappings":"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","file":"static/js/26.3c3596fa.chunk.js","sourcesContent":["/*!\nFullCalendar Core Package v4.3.1\nDocs & License: https://fullcalendar.io/\n(c) 2019 Adam Shaw\n*/\n\n// Creating\n// ----------------------------------------------------------------------------------------------------------------\nvar elementPropHash = {\n    className: true,\n    colSpan: true,\n    rowSpan: true\n};\nvar containerTagHash = {\n    '<tr': 'tbody',\n    '<td': 'tr'\n};\nfunction createElement(tagName, attrs, content) {\n    var el = document.createElement(tagName);\n    if (attrs) {\n        for (var attrName in attrs) {\n            if (attrName === 'style') {\n                applyStyle(el, attrs[attrName]);\n            }\n            else if (elementPropHash[attrName]) {\n                el[attrName] = attrs[attrName];\n            }\n            else {\n                el.setAttribute(attrName, attrs[attrName]);\n            }\n        }\n    }\n    if (typeof content === 'string') {\n        el.innerHTML = content; // shortcut. no need to process HTML in any way\n    }\n    else if (content != null) {\n        appendToElement(el, content);\n    }\n    return el;\n}\nfunction htmlToElement(html) {\n    html = html.trim();\n    var container = document.createElement(computeContainerTag(html));\n    container.innerHTML = html;\n    return container.firstChild;\n}\nfunction htmlToElements(html) {\n    return Array.prototype.slice.call(htmlToNodeList(html));\n}\nfunction htmlToNodeList(html) {\n    html = html.trim();\n    var container = document.createElement(computeContainerTag(html));\n    container.innerHTML = html;\n    return container.childNodes;\n}\n// assumes html already trimmed and tag names are lowercase\nfunction computeContainerTag(html) {\n    return containerTagHash[html.substr(0, 3) // faster than using regex\n    ] || 'div';\n}\nfunction appendToElement(el, content) {\n    var childNodes = normalizeContent(content);\n    for (var i = 0; i < childNodes.length; i++) {\n        el.appendChild(childNodes[i]);\n    }\n}\nfunction prependToElement(parent, content) {\n    var newEls = normalizeContent(content);\n    var afterEl = parent.firstChild || null; // if no firstChild, will append to end, but that's okay, b/c there were no children\n    for (var i = 0; i < newEls.length; i++) {\n        parent.insertBefore(newEls[i], afterEl);\n    }\n}\nfunction insertAfterElement(refEl, content) {\n    var newEls = normalizeContent(content);\n    var afterEl = refEl.nextSibling || null;\n    for (var i = 0; i < newEls.length; i++) {\n        refEl.parentNode.insertBefore(newEls[i], afterEl);\n    }\n}\nfunction normalizeContent(content) {\n    var els;\n    if (typeof content === 'string') {\n        els = htmlToElements(content);\n    }\n    else if (content instanceof Node) {\n        els = [content];\n    }\n    else { // Node[] or NodeList\n        els = Array.prototype.slice.call(content);\n    }\n    return els;\n}\nfunction removeElement(el) {\n    if (el.parentNode) {\n        el.parentNode.removeChild(el);\n    }\n}\n// Querying\n// ----------------------------------------------------------------------------------------------------------------\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\nvar matchesMethod = Element.prototype.matches ||\n    Element.prototype.matchesSelector ||\n    Element.prototype.msMatchesSelector;\nvar closestMethod = Element.prototype.closest || function (selector) {\n    // polyfill\n    var el = this;\n    if (!document.documentElement.contains(el)) {\n        return null;\n    }\n    do {\n        if (elementMatches(el, selector)) {\n            return el;\n        }\n        el = el.parentElement || el.parentNode;\n    } while (el !== null && el.nodeType === 1);\n    return null;\n};\nfunction elementClosest(el, selector) {\n    return closestMethod.call(el, selector);\n}\nfunction elementMatches(el, selector) {\n    return matchesMethod.call(el, selector);\n}\n// accepts multiple subject els\n// returns a real array. good for methods like forEach\nfunction findElements(container, selector) {\n    var containers = container instanceof HTMLElement ? [container] : container;\n    var allMatches = [];\n    for (var i = 0; i < containers.length; i++) {\n        var matches = containers[i].querySelectorAll(selector);\n        for (var j = 0; j < matches.length; j++) {\n            allMatches.push(matches[j]);\n        }\n    }\n    return allMatches;\n}\n// accepts multiple subject els\n// only queries direct child elements\nfunction findChildren(parent, selector) {\n    var parents = parent instanceof HTMLElement ? [parent] : parent;\n    var allMatches = [];\n    for (var i = 0; i < parents.length; i++) {\n        var childNodes = parents[i].children; // only ever elements\n        for (var j = 0; j < childNodes.length; j++) {\n            var childNode = childNodes[j];\n            if (!selector || elementMatches(childNode, selector)) {\n                allMatches.push(childNode);\n            }\n        }\n    }\n    return allMatches;\n}\n// Attributes\n// ----------------------------------------------------------------------------------------------------------------\nfunction forceClassName(el, className, bool) {\n    if (bool) {\n        el.classList.add(className);\n    }\n    else {\n        el.classList.remove(className);\n    }\n}\n// Style\n// ----------------------------------------------------------------------------------------------------------------\nvar PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i;\nfunction applyStyle(el, props) {\n    for (var propName in props) {\n        applyStyleProp(el, propName, props[propName]);\n    }\n}\nfunction applyStyleProp(el, name, val) {\n    if (val == null) {\n        el.style[name] = '';\n    }\n    else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\n        el.style[name] = val + 'px';\n    }\n    else {\n        el.style[name] = val;\n    }\n}\n\nfunction pointInsideRect(point, rect) {\n    return point.left >= rect.left &&\n        point.left < rect.right &&\n        point.top >= rect.top &&\n        point.top < rect.bottom;\n}\n// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\nfunction intersectRects(rect1, rect2) {\n    var res = {\n        left: Math.max(rect1.left, rect2.left),\n        right: Math.min(rect1.right, rect2.right),\n        top: Math.max(rect1.top, rect2.top),\n        bottom: Math.min(rect1.bottom, rect2.bottom)\n    };\n    if (res.left < res.right && res.top < res.bottom) {\n        return res;\n    }\n    return false;\n}\nfunction translateRect(rect, deltaX, deltaY) {\n    return {\n        left: rect.left + deltaX,\n        right: rect.right + deltaX,\n        top: rect.top + deltaY,\n        bottom: rect.bottom + deltaY\n    };\n}\n// Returns a new point that will have been moved to reside within the given rectangle\nfunction constrainPoint(point, rect) {\n    return {\n        left: Math.min(Math.max(point.left, rect.left), rect.right),\n        top: Math.min(Math.max(point.top, rect.top), rect.bottom)\n    };\n}\n// Returns a point that is the center of the given rectangle\nfunction getRectCenter(rect) {\n    return {\n        left: (rect.left + rect.right) / 2,\n        top: (rect.top + rect.bottom) / 2\n    };\n}\n// Subtracts point2's coordinates from point1's coordinates, returning a delta\nfunction diffPoints(point1, point2) {\n    return {\n        left: point1.left - point2.left,\n        top: point1.top - point2.top\n    };\n}\n\n// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\nvar isRtlScrollbarOnLeft = null;\nfunction getIsRtlScrollbarOnLeft() {\n    if (isRtlScrollbarOnLeft === null) {\n        isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft();\n    }\n    return isRtlScrollbarOnLeft;\n}\nfunction computeIsRtlScrollbarOnLeft() {\n    var outerEl = createElement('div', {\n        style: {\n            position: 'absolute',\n            top: -1000,\n            left: 0,\n            border: 0,\n            padding: 0,\n            overflow: 'scroll',\n            direction: 'rtl'\n        }\n    }, '<div></div>');\n    document.body.appendChild(outerEl);\n    var innerEl = outerEl.firstChild;\n    var res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left;\n    removeElement(outerEl);\n    return res;\n}\n// The scrollbar width computations in computeEdges are sometimes flawed when it comes to\n// retina displays, rounding, and IE11. Massage them into a usable value.\nfunction sanitizeScrollbarWidth(width) {\n    width = Math.max(0, width); // no negatives\n    width = Math.round(width);\n    return width;\n}\n\nfunction computeEdges(el, getPadding) {\n    if (getPadding === void 0) { getPadding = false; }\n    var computedStyle = window.getComputedStyle(el);\n    var borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0;\n    var borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0;\n    var borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0;\n    var borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0;\n    // must use offset(Width|Height) because compatible with client(Width|Height)\n    var scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight);\n    var scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom);\n    var res = {\n        borderLeft: borderLeft,\n        borderRight: borderRight,\n        borderTop: borderTop,\n        borderBottom: borderBottom,\n        scrollbarBottom: scrollbarBottom,\n        scrollbarLeft: 0,\n        scrollbarRight: 0\n    };\n    if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') { // is the scrollbar on the left side?\n        res.scrollbarLeft = scrollbarLeftRight;\n    }\n    else {\n        res.scrollbarRight = scrollbarLeftRight;\n    }\n    if (getPadding) {\n        res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0;\n        res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0;\n        res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0;\n        res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0;\n    }\n    return res;\n}\nfunction computeInnerRect(el, goWithinPadding) {\n    if (goWithinPadding === void 0) { goWithinPadding = false; }\n    var outerRect = computeRect(el);\n    var edges = computeEdges(el, goWithinPadding);\n    var res = {\n        left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\n        right: outerRect.right - edges.borderRight - edges.scrollbarRight,\n        top: outerRect.top + edges.borderTop,\n        bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\n    };\n    if (goWithinPadding) {\n        res.left += edges.paddingLeft;\n        res.right -= edges.paddingRight;\n        res.top += edges.paddingTop;\n        res.bottom -= edges.paddingBottom;\n    }\n    return res;\n}\nfunction computeRect(el) {\n    var rect = el.getBoundingClientRect();\n    return {\n        left: rect.left + window.pageXOffset,\n        top: rect.top + window.pageYOffset,\n        right: rect.right + window.pageXOffset,\n        bottom: rect.bottom + window.pageYOffset\n    };\n}\nfunction computeViewportRect() {\n    return {\n        left: window.pageXOffset,\n        right: window.pageXOffset + document.documentElement.clientWidth,\n        top: window.pageYOffset,\n        bottom: window.pageYOffset + document.documentElement.clientHeight\n    };\n}\nfunction computeHeightAndMargins(el) {\n    return el.getBoundingClientRect().height + computeVMargins(el);\n}\nfunction computeVMargins(el) {\n    var computed = window.getComputedStyle(el);\n    return parseInt(computed.marginTop, 10) +\n        parseInt(computed.marginBottom, 10);\n}\n// does not return window\nfunction getClippingParents(el) {\n    var parents = [];\n    while (el instanceof HTMLElement) { // will stop when gets to document or null\n        var computedStyle = window.getComputedStyle(el);\n        if (computedStyle.position === 'fixed') {\n            break;\n        }\n        if ((/(auto|scroll)/).test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\n            parents.push(el);\n        }\n        el = el.parentNode;\n    }\n    return parents;\n}\nfunction computeClippingRect(el) {\n    return getClippingParents(el)\n        .map(function (el) {\n        return computeInnerRect(el);\n    })\n        .concat(computeViewportRect())\n        .reduce(function (rect0, rect1) {\n        return intersectRects(rect0, rect1) || rect1; // should always intersect\n    });\n}\n\n// Stops a mouse/touch event from doing it's native browser action\nfunction preventDefault(ev) {\n    ev.preventDefault();\n}\n// Event Delegation\n// ----------------------------------------------------------------------------------------------------------------\nfunction listenBySelector(container, eventType, selector, handler) {\n    function realHandler(ev) {\n        var matchedChild = elementClosest(ev.target, selector);\n        if (matchedChild) {\n            handler.call(matchedChild, ev, matchedChild);\n        }\n    }\n    container.addEventListener(eventType, realHandler);\n    return function () {\n        container.removeEventListener(eventType, realHandler);\n    };\n}\nfunction listenToHoverBySelector(container, selector, onMouseEnter, onMouseLeave) {\n    var currentMatchedChild;\n    return listenBySelector(container, 'mouseover', selector, function (ev, matchedChild) {\n        if (matchedChild !== currentMatchedChild) {\n            currentMatchedChild = matchedChild;\n            onMouseEnter(ev, matchedChild);\n            var realOnMouseLeave_1 = function (ev) {\n                currentMatchedChild = null;\n                onMouseLeave(ev, matchedChild);\n                matchedChild.removeEventListener('mouseleave', realOnMouseLeave_1);\n            };\n            // listen to the next mouseleave, and then unattach\n            matchedChild.addEventListener('mouseleave', realOnMouseLeave_1);\n        }\n    });\n}\n// Animation\n// ----------------------------------------------------------------------------------------------------------------\nvar transitionEventNames = [\n    'webkitTransitionEnd',\n    'otransitionend',\n    'oTransitionEnd',\n    'msTransitionEnd',\n    'transitionend'\n];\n// triggered only when the next single subsequent transition finishes\nfunction whenTransitionDone(el, callback) {\n    var realCallback = function (ev) {\n        callback(ev);\n        transitionEventNames.forEach(function (eventName) {\n            el.removeEventListener(eventName, realCallback);\n        });\n    };\n    transitionEventNames.forEach(function (eventName) {\n        el.addEventListener(eventName, realCallback); // cross-browser way to determine when the transition finishes\n    });\n}\n\nvar DAY_IDS = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n// Adding\nfunction addWeeks(m, n) {\n    var a = dateToUtcArray(m);\n    a[2] += n * 7;\n    return arrayToUtcDate(a);\n}\nfunction addDays(m, n) {\n    var a = dateToUtcArray(m);\n    a[2] += n;\n    return arrayToUtcDate(a);\n}\nfunction addMs(m, n) {\n    var a = dateToUtcArray(m);\n    a[6] += n;\n    return arrayToUtcDate(a);\n}\n// Diffing (all return floats)\nfunction diffWeeks(m0, m1) {\n    return diffDays(m0, m1) / 7;\n}\nfunction diffDays(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24);\n}\nfunction diffHours(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60);\n}\nfunction diffMinutes(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60);\n}\nfunction diffSeconds(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / 1000;\n}\nfunction diffDayAndTime(m0, m1) {\n    var m0day = startOfDay(m0);\n    var m1day = startOfDay(m1);\n    return {\n        years: 0,\n        months: 0,\n        days: Math.round(diffDays(m0day, m1day)),\n        milliseconds: (m1.valueOf() - m1day.valueOf()) - (m0.valueOf() - m0day.valueOf())\n    };\n}\n// Diffing Whole Units\nfunction diffWholeWeeks(m0, m1) {\n    var d = diffWholeDays(m0, m1);\n    if (d !== null && d % 7 === 0) {\n        return d / 7;\n    }\n    return null;\n}\nfunction diffWholeDays(m0, m1) {\n    if (timeAsMs(m0) === timeAsMs(m1)) {\n        return Math.round(diffDays(m0, m1));\n    }\n    return null;\n}\n// Start-Of\nfunction startOfDay(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate()\n    ]);\n}\nfunction startOfHour(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours()\n    ]);\n}\nfunction startOfMinute(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours(),\n        m.getUTCMinutes()\n    ]);\n}\nfunction startOfSecond(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours(),\n        m.getUTCMinutes(),\n        m.getUTCSeconds()\n    ]);\n}\n// Week Computation\nfunction weekOfYear(marker, dow, doy) {\n    var y = marker.getUTCFullYear();\n    var w = weekOfGivenYear(marker, y, dow, doy);\n    if (w < 1) {\n        return weekOfGivenYear(marker, y - 1, dow, doy);\n    }\n    var nextW = weekOfGivenYear(marker, y + 1, dow, doy);\n    if (nextW >= 1) {\n        return Math.min(w, nextW);\n    }\n    return w;\n}\nfunction weekOfGivenYear(marker, year, dow, doy) {\n    var firstWeekStart = arrayToUtcDate([year, 0, 1 + firstWeekOffset(year, dow, doy)]);\n    var dayStart = startOfDay(marker);\n    var days = Math.round(diffDays(firstWeekStart, dayStart));\n    return Math.floor(days / 7) + 1; // zero-indexed\n}\n// start-of-first-week - start-of-year\nfunction firstWeekOffset(year, dow, doy) {\n    // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n    var fwd = 7 + dow - doy;\n    // first-week day local weekday -- which local weekday is fwd\n    var fwdlw = (7 + arrayToUtcDate([year, 0, fwd]).getUTCDay() - dow) % 7;\n    return -fwdlw + fwd - 1;\n}\n// Array Conversion\nfunction dateToLocalArray(date) {\n    return [\n        date.getFullYear(),\n        date.getMonth(),\n        date.getDate(),\n        date.getHours(),\n        date.getMinutes(),\n        date.getSeconds(),\n        date.getMilliseconds()\n    ];\n}\nfunction arrayToLocalDate(a) {\n    return new Date(a[0], a[1] || 0, a[2] == null ? 1 : a[2], // day of month\n    a[3] || 0, a[4] || 0, a[5] || 0);\n}\nfunction dateToUtcArray(date) {\n    return [\n        date.getUTCFullYear(),\n        date.getUTCMonth(),\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds(),\n        date.getUTCMilliseconds()\n    ];\n}\nfunction arrayToUtcDate(a) {\n    // according to web standards (and Safari), a month index is required.\n    // massage if only given a year.\n    if (a.length === 1) {\n        a = a.concat([0]);\n    }\n    return new Date(Date.UTC.apply(Date, a));\n}\n// Other Utils\nfunction isValidDate(m) {\n    return !isNaN(m.valueOf());\n}\nfunction timeAsMs(m) {\n    return m.getUTCHours() * 1000 * 60 * 60 +\n        m.getUTCMinutes() * 1000 * 60 +\n        m.getUTCSeconds() * 1000 +\n        m.getUTCMilliseconds();\n}\n\nvar INTERNAL_UNITS = ['years', 'months', 'days', 'milliseconds'];\nvar PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/;\n// Parsing and Creation\nfunction createDuration(input, unit) {\n    var _a;\n    if (typeof input === 'string') {\n        return parseString(input);\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        return normalizeObject(input);\n    }\n    else if (typeof input === 'number') {\n        return normalizeObject((_a = {}, _a[unit || 'milliseconds'] = input, _a));\n    }\n    else {\n        return null;\n    }\n}\nfunction parseString(s) {\n    var m = PARSE_RE.exec(s);\n    if (m) {\n        var sign = m[1] ? -1 : 1;\n        return {\n            years: 0,\n            months: 0,\n            days: sign * (m[2] ? parseInt(m[2], 10) : 0),\n            milliseconds: sign * ((m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\n                (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\n                (m[5] ? parseInt(m[5], 10) : 0) * 1000 + // seconds\n                (m[6] ? parseInt(m[6], 10) : 0) // ms\n            )\n        };\n    }\n    return null;\n}\nfunction normalizeObject(obj) {\n    return {\n        years: obj.years || obj.year || 0,\n        months: obj.months || obj.month || 0,\n        days: (obj.days || obj.day || 0) +\n            getWeeksFromInput(obj) * 7,\n        milliseconds: (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\n            (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\n            (obj.seconds || obj.second || 0) * 1000 + // seconds\n            (obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\n    };\n}\nfunction getWeeksFromInput(obj) {\n    return obj.weeks || obj.week || 0;\n}\n// Equality\nfunction durationsEqual(d0, d1) {\n    return d0.years === d1.years &&\n        d0.months === d1.months &&\n        d0.days === d1.days &&\n        d0.milliseconds === d1.milliseconds;\n}\nfunction isSingleDay(dur) {\n    return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0;\n}\n// Simple Math\nfunction addDurations(d0, d1) {\n    return {\n        years: d0.years + d1.years,\n        months: d0.months + d1.months,\n        days: d0.days + d1.days,\n        milliseconds: d0.milliseconds + d1.milliseconds\n    };\n}\nfunction subtractDurations(d1, d0) {\n    return {\n        years: d1.years - d0.years,\n        months: d1.months - d0.months,\n        days: d1.days - d0.days,\n        milliseconds: d1.milliseconds - d0.milliseconds\n    };\n}\nfunction multiplyDuration(d, n) {\n    return {\n        years: d.years * n,\n        months: d.months * n,\n        days: d.days * n,\n        milliseconds: d.milliseconds * n\n    };\n}\n// Conversions\n// \"Rough\" because they are based on average-case Gregorian months/years\nfunction asRoughYears(dur) {\n    return asRoughDays(dur) / 365;\n}\nfunction asRoughMonths(dur) {\n    return asRoughDays(dur) / 30;\n}\nfunction asRoughDays(dur) {\n    return asRoughMs(dur) / 864e5;\n}\nfunction asRoughMinutes(dur) {\n    return asRoughMs(dur) / (1000 * 60);\n}\nfunction asRoughSeconds(dur) {\n    return asRoughMs(dur) / 1000;\n}\nfunction asRoughMs(dur) {\n    return dur.years * (365 * 864e5) +\n        dur.months * (30 * 864e5) +\n        dur.days * 864e5 +\n        dur.milliseconds;\n}\n// Advanced Math\nfunction wholeDivideDurations(numerator, denominator) {\n    var res = null;\n    for (var i = 0; i < INTERNAL_UNITS.length; i++) {\n        var unit = INTERNAL_UNITS[i];\n        if (denominator[unit]) {\n            var localRes = numerator[unit] / denominator[unit];\n            if (!isInt(localRes) || (res !== null && res !== localRes)) {\n                return null;\n            }\n            res = localRes;\n        }\n        else if (numerator[unit]) {\n            // needs to divide by something but can't!\n            return null;\n        }\n    }\n    return res;\n}\nfunction greatestDurationDenominator(dur, dontReturnWeeks) {\n    var ms = dur.milliseconds;\n    if (ms) {\n        if (ms % 1000 !== 0) {\n            return { unit: 'millisecond', value: ms };\n        }\n        if (ms % (1000 * 60) !== 0) {\n            return { unit: 'second', value: ms / 1000 };\n        }\n        if (ms % (1000 * 60 * 60) !== 0) {\n            return { unit: 'minute', value: ms / (1000 * 60) };\n        }\n        if (ms) {\n            return { unit: 'hour', value: ms / (1000 * 60 * 60) };\n        }\n    }\n    if (dur.days) {\n        if (!dontReturnWeeks && dur.days % 7 === 0) {\n            return { unit: 'week', value: dur.days / 7 };\n        }\n        return { unit: 'day', value: dur.days };\n    }\n    if (dur.months) {\n        return { unit: 'month', value: dur.months };\n    }\n    if (dur.years) {\n        return { unit: 'year', value: dur.years };\n    }\n    return { unit: 'millisecond', value: 0 };\n}\n\n/* FullCalendar-specific DOM Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\nfunction compensateScroll(rowEl, scrollbarWidths) {\n    if (scrollbarWidths.left) {\n        applyStyle(rowEl, {\n            borderLeftWidth: 1,\n            marginLeft: scrollbarWidths.left - 1\n        });\n    }\n    if (scrollbarWidths.right) {\n        applyStyle(rowEl, {\n            borderRightWidth: 1,\n            marginRight: scrollbarWidths.right - 1\n        });\n    }\n}\n// Undoes compensateScroll and restores all borders/margins\nfunction uncompensateScroll(rowEl) {\n    applyStyle(rowEl, {\n        marginLeft: '',\n        marginRight: '',\n        borderLeftWidth: '',\n        borderRightWidth: ''\n    });\n}\n// Make the mouse cursor express that an event is not allowed in the current area\nfunction disableCursor() {\n    document.body.classList.add('fc-not-allowed');\n}\n// Returns the mouse cursor to its original look\nfunction enableCursor() {\n    document.body.classList.remove('fc-not-allowed');\n}\n// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\n// reduces the available height.\nfunction distributeHeight(els, availableHeight, shouldRedistribute) {\n    // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\n    // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\n    var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element\n    var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*\n    var flexEls = []; // elements that are allowed to expand. array of DOM nodes\n    var flexOffsets = []; // amount of vertical space it takes up\n    var flexHeights = []; // actual css height\n    var usedHeight = 0;\n    undistributeHeight(els); // give all elements their natural height\n    // find elements that are below the recommended height (expandable).\n    // important to query for heights in a single first pass (to avoid reflow oscillation).\n    els.forEach(function (el, i) {\n        var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;\n        var naturalHeight = el.getBoundingClientRect().height;\n        var naturalOffset = naturalHeight + computeVMargins(el);\n        if (naturalOffset < minOffset) {\n            flexEls.push(el);\n            flexOffsets.push(naturalOffset);\n            flexHeights.push(naturalHeight);\n        }\n        else {\n            // this element stretches past recommended height (non-expandable). mark the space as occupied.\n            usedHeight += naturalOffset;\n        }\n    });\n    // readjust the recommended height to only consider the height available to non-maxed-out rows.\n    if (shouldRedistribute) {\n        availableHeight -= usedHeight;\n        minOffset1 = Math.floor(availableHeight / flexEls.length);\n        minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*\n    }\n    // assign heights to all expandable elements\n    flexEls.forEach(function (el, i) {\n        var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;\n        var naturalOffset = flexOffsets[i];\n        var naturalHeight = flexHeights[i];\n        var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding\n        if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things\n            el.style.height = newHeight + 'px';\n        }\n    });\n}\n// Undoes distrubuteHeight, restoring all els to their natural height\nfunction undistributeHeight(els) {\n    els.forEach(function (el) {\n        el.style.height = '';\n    });\n}\n// Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\n// cells to be that width.\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\nfunction matchCellWidths(els) {\n    var maxInnerWidth = 0;\n    els.forEach(function (el) {\n        var innerEl = el.firstChild; // hopefully an element\n        if (innerEl instanceof HTMLElement) {\n            var innerWidth_1 = innerEl.getBoundingClientRect().width;\n            if (innerWidth_1 > maxInnerWidth) {\n                maxInnerWidth = innerWidth_1;\n            }\n        }\n    });\n    maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance\n    els.forEach(function (el) {\n        el.style.width = maxInnerWidth + 'px';\n    });\n    return maxInnerWidth;\n}\n// Given one element that resides inside another,\n// Subtracts the height of the inner element from the outer element.\nfunction subtractInnerElHeight(outerEl, innerEl) {\n    // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\n    var reflowStyleProps = {\n        position: 'relative',\n        left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\n    };\n    applyStyle(outerEl, reflowStyleProps);\n    applyStyle(innerEl, reflowStyleProps);\n    var diff = // grab the dimensions\n     outerEl.getBoundingClientRect().height -\n        innerEl.getBoundingClientRect().height;\n    // undo hack\n    var resetStyleProps = { position: '', left: '' };\n    applyStyle(outerEl, resetStyleProps);\n    applyStyle(innerEl, resetStyleProps);\n    return diff;\n}\n/* Selection\n----------------------------------------------------------------------------------------------------------------------*/\nfunction preventSelection(el) {\n    el.classList.add('fc-unselectable');\n    el.addEventListener('selectstart', preventDefault);\n}\nfunction allowSelection(el) {\n    el.classList.remove('fc-unselectable');\n    el.removeEventListener('selectstart', preventDefault);\n}\n/* Context Menu\n----------------------------------------------------------------------------------------------------------------------*/\nfunction preventContextMenu(el) {\n    el.addEventListener('contextmenu', preventDefault);\n}\nfunction allowContextMenu(el) {\n    el.removeEventListener('contextmenu', preventDefault);\n}\n/* Object Ordering by Field\n----------------------------------------------------------------------------------------------------------------------*/\nfunction parseFieldSpecs(input) {\n    var specs = [];\n    var tokens = [];\n    var i;\n    var token;\n    if (typeof input === 'string') {\n        tokens = input.split(/\\s*,\\s*/);\n    }\n    else if (typeof input === 'function') {\n        tokens = [input];\n    }\n    else if (Array.isArray(input)) {\n        tokens = input;\n    }\n    for (i = 0; i < tokens.length; i++) {\n        token = tokens[i];\n        if (typeof token === 'string') {\n            specs.push(token.charAt(0) === '-' ?\n                { field: token.substring(1), order: -1 } :\n                { field: token, order: 1 });\n        }\n        else if (typeof token === 'function') {\n            specs.push({ func: token });\n        }\n    }\n    return specs;\n}\nfunction compareByFieldSpecs(obj0, obj1, fieldSpecs) {\n    var i;\n    var cmp;\n    for (i = 0; i < fieldSpecs.length; i++) {\n        cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i]);\n        if (cmp) {\n            return cmp;\n        }\n    }\n    return 0;\n}\nfunction compareByFieldSpec(obj0, obj1, fieldSpec) {\n    if (fieldSpec.func) {\n        return fieldSpec.func(obj0, obj1);\n    }\n    return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field])\n        * (fieldSpec.order || 1);\n}\nfunction flexibleCompare(a, b) {\n    if (!a && !b) {\n        return 0;\n    }\n    if (b == null) {\n        return -1;\n    }\n    if (a == null) {\n        return 1;\n    }\n    if (typeof a === 'string' || typeof b === 'string') {\n        return String(a).localeCompare(String(b));\n    }\n    return a - b;\n}\n/* String Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction capitaliseFirstLetter(str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction padStart(val, len) {\n    var s = String(val);\n    return '000'.substr(0, len - s.length) + s;\n}\n/* Number Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction compareNumbers(a, b) {\n    return a - b;\n}\nfunction isInt(n) {\n    return n % 1 === 0;\n}\n/* Weird Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction applyAll(functions, thisObj, args) {\n    if (typeof functions === 'function') { // supplied a single function\n        functions = [functions];\n    }\n    if (functions) {\n        var i = void 0;\n        var ret = void 0;\n        for (i = 0; i < functions.length; i++) {\n            ret = functions[i].apply(thisObj, args) || ret;\n        }\n        return ret;\n    }\n}\nfunction firstDefined() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    for (var i = 0; i < args.length; i++) {\n        if (args[i] !== undefined) {\n            return args[i];\n        }\n    }\n}\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\nfunction debounce(func, wait) {\n    var timeout;\n    var args;\n    var context;\n    var timestamp;\n    var result;\n    var later = function () {\n        var last = new Date().valueOf() - timestamp;\n        if (last < wait) {\n            timeout = setTimeout(later, wait - last);\n        }\n        else {\n            timeout = null;\n            result = func.apply(context, args);\n            context = args = null;\n        }\n    };\n    return function () {\n        context = this;\n        args = arguments;\n        timestamp = new Date().valueOf();\n        if (!timeout) {\n            timeout = setTimeout(later, wait);\n        }\n        return result;\n    };\n}\n// Number and Boolean are only types that defaults or not computed for\n// TODO: write more comments\nfunction refineProps(rawProps, processors, defaults, leftoverProps) {\n    if (defaults === void 0) { defaults = {}; }\n    var refined = {};\n    for (var key in processors) {\n        var processor = processors[key];\n        if (rawProps[key] !== undefined) {\n            // found\n            if (processor === Function) {\n                refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null;\n            }\n            else if (processor) { // a refining function?\n                refined[key] = processor(rawProps[key]);\n            }\n            else {\n                refined[key] = rawProps[key];\n            }\n        }\n        else if (defaults[key] !== undefined) {\n            // there's an explicit default\n            refined[key] = defaults[key];\n        }\n        else {\n            // must compute a default\n            if (processor === String) {\n                refined[key] = ''; // empty string is default for String\n            }\n            else if (!processor || processor === Number || processor === Boolean || processor === Function) {\n                refined[key] = null; // assign null for other non-custom processor funcs\n            }\n            else {\n                refined[key] = processor(null); // run the custom processor func\n            }\n        }\n    }\n    if (leftoverProps) {\n        for (var key in rawProps) {\n            if (processors[key] === undefined) {\n                leftoverProps[key] = rawProps[key];\n            }\n        }\n    }\n    return refined;\n}\n/* Date stuff that doesn't belong in datelib core\n----------------------------------------------------------------------------------------------------------------------*/\n// given a timed range, computes an all-day range that has the same exact duration,\n// but whose start time is aligned with the start of the day.\nfunction computeAlignedDayRange(timedRange) {\n    var dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1;\n    var start = startOfDay(timedRange.start);\n    var end = addDays(start, dayCnt);\n    return { start: start, end: end };\n}\n// given a timed range, computes an all-day range based on how for the end date bleeds into the next day\n// TODO: give nextDayThreshold a default arg\nfunction computeVisibleDayRange(timedRange, nextDayThreshold) {\n    if (nextDayThreshold === void 0) { nextDayThreshold = createDuration(0); }\n    var startDay = null;\n    var endDay = null;\n    if (timedRange.end) {\n        endDay = startOfDay(timedRange.end);\n        var endTimeMS = timedRange.end.valueOf() - endDay.valueOf(); // # of milliseconds into `endDay`\n        // If the end time is actually inclusively part of the next day and is equal to or\n        // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\n        // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\n        if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\n            endDay = addDays(endDay, 1);\n        }\n    }\n    if (timedRange.start) {\n        startDay = startOfDay(timedRange.start); // the beginning of the day the range starts\n        // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\n        if (endDay && endDay <= startDay) {\n            endDay = addDays(startDay, 1);\n        }\n    }\n    return { start: startDay, end: endDay };\n}\n// spans from one day into another?\nfunction isMultiDayRange(range) {\n    var visibleRange = computeVisibleDayRange(range);\n    return diffDays(visibleRange.start, visibleRange.end) > 1;\n}\nfunction diffDates(date0, date1, dateEnv, largeUnit) {\n    if (largeUnit === 'year') {\n        return createDuration(dateEnv.diffWholeYears(date0, date1), 'year');\n    }\n    else if (largeUnit === 'month') {\n        return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month');\n    }\n    else {\n        return diffDayAndTime(date0, date1); // returns a duration\n    }\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction parseRecurring(eventInput, allDayDefault, dateEnv, recurringTypes, leftovers) {\n    for (var i = 0; i < recurringTypes.length; i++) {\n        var localLeftovers = {};\n        var parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv);\n        if (parsed) {\n            var allDay = localLeftovers.allDay;\n            delete localLeftovers.allDay; // remove from leftovers\n            if (allDay == null) {\n                allDay = allDayDefault;\n                if (allDay == null) {\n                    allDay = parsed.allDayGuess;\n                    if (allDay == null) {\n                        allDay = false;\n                    }\n                }\n            }\n            __assign(leftovers, localLeftovers);\n            return {\n                allDay: allDay,\n                duration: parsed.duration,\n                typeData: parsed.typeData,\n                typeId: i\n            };\n        }\n    }\n    return null;\n}\n/*\nEvent MUST have a recurringDef\n*/\nfunction expandRecurringRanges(eventDef, duration, framingRange, dateEnv, recurringTypes) {\n    var typeDef = recurringTypes[eventDef.recurringDef.typeId];\n    var markers = typeDef.expand(eventDef.recurringDef.typeData, {\n        start: dateEnv.subtract(framingRange.start, duration),\n        end: framingRange.end\n    }, dateEnv);\n    // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\n    if (eventDef.allDay) {\n        markers = markers.map(startOfDay);\n    }\n    return markers;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n// Merges an array of objects into a single object.\n// The second argument allows for an array of property names who's object values will be merged together.\nfunction mergeProps(propObjs, complexProps) {\n    var dest = {};\n    var i;\n    var name;\n    var complexObjs;\n    var j;\n    var val;\n    var props;\n    if (complexProps) {\n        for (i = 0; i < complexProps.length; i++) {\n            name = complexProps[i];\n            complexObjs = [];\n            // collect the trailing object values, stopping when a non-object is discovered\n            for (j = propObjs.length - 1; j >= 0; j--) {\n                val = propObjs[j][name];\n                if (typeof val === 'object' && val) { // non-null object\n                    complexObjs.unshift(val);\n                }\n                else if (val !== undefined) {\n                    dest[name] = val; // if there were no objects, this value will be used\n                    break;\n                }\n            }\n            // if the trailing values were objects, use the merged value\n            if (complexObjs.length) {\n                dest[name] = mergeProps(complexObjs);\n            }\n        }\n    }\n    // copy values into the destination, going from last to first\n    for (i = propObjs.length - 1; i >= 0; i--) {\n        props = propObjs[i];\n        for (name in props) {\n            if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign\n                dest[name] = props[name];\n            }\n        }\n    }\n    return dest;\n}\nfunction filterHash(hash, func) {\n    var filtered = {};\n    for (var key in hash) {\n        if (func(hash[key], key)) {\n            filtered[key] = hash[key];\n        }\n    }\n    return filtered;\n}\nfunction mapHash(hash, func) {\n    var newHash = {};\n    for (var key in hash) {\n        newHash[key] = func(hash[key], key);\n    }\n    return newHash;\n}\nfunction arrayToHash(a) {\n    var hash = {};\n    for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\n        var item = a_1[_i];\n        hash[item] = true;\n    }\n    return hash;\n}\nfunction hashValuesToArray(obj) {\n    var a = [];\n    for (var key in obj) {\n        a.push(obj[key]);\n    }\n    return a;\n}\nfunction isPropsEqual(obj0, obj1) {\n    for (var key in obj0) {\n        if (hasOwnProperty.call(obj0, key)) {\n            if (!(key in obj1)) {\n                return false;\n            }\n        }\n    }\n    for (var key in obj1) {\n        if (hasOwnProperty.call(obj1, key)) {\n            if (obj0[key] !== obj1[key]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nfunction parseEvents(rawEvents, sourceId, calendar, allowOpenRange) {\n    var eventStore = createEmptyEventStore();\n    for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n        var rawEvent = rawEvents_1[_i];\n        var tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange);\n        if (tuple) {\n            eventTupleToStore(tuple, eventStore);\n        }\n    }\n    return eventStore;\n}\nfunction eventTupleToStore(tuple, eventStore) {\n    if (eventStore === void 0) { eventStore = createEmptyEventStore(); }\n    eventStore.defs[tuple.def.defId] = tuple.def;\n    if (tuple.instance) {\n        eventStore.instances[tuple.instance.instanceId] = tuple.instance;\n    }\n    return eventStore;\n}\nfunction expandRecurring(eventStore, framingRange, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var defs = eventStore.defs, instances = eventStore.instances;\n    // remove existing recurring instances\n    instances = filterHash(instances, function (instance) {\n        return !defs[instance.defId].recurringDef;\n    });\n    for (var defId in defs) {\n        var def = defs[defId];\n        if (def.recurringDef) {\n            var duration = def.recurringDef.duration;\n            if (!duration) {\n                duration = def.allDay ?\n                    calendar.defaultAllDayEventDuration :\n                    calendar.defaultTimedEventDuration;\n            }\n            var starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes);\n            for (var _i = 0, starts_1 = starts; _i < starts_1.length; _i++) {\n                var start = starts_1[_i];\n                var instance = createEventInstance(defId, {\n                    start: start,\n                    end: dateEnv.add(start, duration)\n                });\n                instances[instance.instanceId] = instance;\n            }\n        }\n    }\n    return { defs: defs, instances: instances };\n}\n// retrieves events that have the same groupId as the instance specified by `instanceId`\n// or they are the same as the instance.\n// why might instanceId not be in the store? an event from another calendar?\nfunction getRelevantEvents(eventStore, instanceId) {\n    var instance = eventStore.instances[instanceId];\n    if (instance) {\n        var def_1 = eventStore.defs[instance.defId];\n        // get events/instances with same group\n        var newStore = filterEventStoreDefs(eventStore, function (lookDef) {\n            return isEventDefsGrouped(def_1, lookDef);\n        });\n        // add the original\n        // TODO: wish we could use eventTupleToStore or something like it\n        newStore.defs[def_1.defId] = def_1;\n        newStore.instances[instance.instanceId] = instance;\n        return newStore;\n    }\n    return createEmptyEventStore();\n}\nfunction isEventDefsGrouped(def0, def1) {\n    return Boolean(def0.groupId && def0.groupId === def1.groupId);\n}\nfunction transformRawEvents(rawEvents, eventSource, calendar) {\n    var calEachTransform = calendar.opt('eventDataTransform');\n    var sourceEachTransform = eventSource ? eventSource.eventDataTransform : null;\n    if (sourceEachTransform) {\n        rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform);\n    }\n    if (calEachTransform) {\n        rawEvents = transformEachRawEvent(rawEvents, calEachTransform);\n    }\n    return rawEvents;\n}\nfunction transformEachRawEvent(rawEvents, func) {\n    var refinedEvents;\n    if (!func) {\n        refinedEvents = rawEvents;\n    }\n    else {\n        refinedEvents = [];\n        for (var _i = 0, rawEvents_2 = rawEvents; _i < rawEvents_2.length; _i++) {\n            var rawEvent = rawEvents_2[_i];\n            var refinedEvent = func(rawEvent);\n            if (refinedEvent) {\n                refinedEvents.push(refinedEvent);\n            }\n            else if (refinedEvent == null) {\n                refinedEvents.push(rawEvent);\n            } // if a different falsy value, do nothing\n        }\n    }\n    return refinedEvents;\n}\nfunction createEmptyEventStore() {\n    return { defs: {}, instances: {} };\n}\nfunction mergeEventStores(store0, store1) {\n    return {\n        defs: __assign({}, store0.defs, store1.defs),\n        instances: __assign({}, store0.instances, store1.instances)\n    };\n}\nfunction filterEventStoreDefs(eventStore, filterFunc) {\n    var defs = filterHash(eventStore.defs, filterFunc);\n    var instances = filterHash(eventStore.instances, function (instance) {\n        return defs[instance.defId]; // still exists?\n    });\n    return { defs: defs, instances: instances };\n}\n\nfunction parseRange(input, dateEnv) {\n    var start = null;\n    var end = null;\n    if (input.start) {\n        start = dateEnv.createMarker(input.start);\n    }\n    if (input.end) {\n        end = dateEnv.createMarker(input.end);\n    }\n    if (!start && !end) {\n        return null;\n    }\n    if (start && end && end < start) {\n        return null;\n    }\n    return { start: start, end: end };\n}\n// SIDE-EFFECT: will mutate ranges.\n// Will return a new array result.\nfunction invertRanges(ranges, constraintRange) {\n    var invertedRanges = [];\n    var start = constraintRange.start; // the end of the previous range. the start of the new range\n    var i;\n    var dateRange;\n    // ranges need to be in order. required for our date-walking algorithm\n    ranges.sort(compareRanges);\n    for (i = 0; i < ranges.length; i++) {\n        dateRange = ranges[i];\n        // add the span of time before the event (if there is any)\n        if (dateRange.start > start) { // compare millisecond time (skip any ambig logic)\n            invertedRanges.push({ start: start, end: dateRange.start });\n        }\n        if (dateRange.end > start) {\n            start = dateRange.end;\n        }\n    }\n    // add the span of time after the last event (if there is any)\n    if (start < constraintRange.end) { // compare millisecond time (skip any ambig logic)\n        invertedRanges.push({ start: start, end: constraintRange.end });\n    }\n    return invertedRanges;\n}\nfunction compareRanges(range0, range1) {\n    return range0.start.valueOf() - range1.start.valueOf(); // earlier ranges go first\n}\nfunction intersectRanges(range0, range1) {\n    var start = range0.start;\n    var end = range0.end;\n    var newRange = null;\n    if (range1.start !== null) {\n        if (start === null) {\n            start = range1.start;\n        }\n        else {\n            start = new Date(Math.max(start.valueOf(), range1.start.valueOf()));\n        }\n    }\n    if (range1.end != null) {\n        if (end === null) {\n            end = range1.end;\n        }\n        else {\n            end = new Date(Math.min(end.valueOf(), range1.end.valueOf()));\n        }\n    }\n    if (start === null || end === null || start < end) {\n        newRange = { start: start, end: end };\n    }\n    return newRange;\n}\nfunction rangesEqual(range0, range1) {\n    return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) &&\n        (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf());\n}\nfunction rangesIntersect(range0, range1) {\n    return (range0.end === null || range1.start === null || range0.end > range1.start) &&\n        (range0.start === null || range1.end === null || range0.start < range1.end);\n}\nfunction rangeContainsRange(outerRange, innerRange) {\n    return (outerRange.start === null || (innerRange.start !== null && innerRange.start >= outerRange.start)) &&\n        (outerRange.end === null || (innerRange.end !== null && innerRange.end <= outerRange.end));\n}\nfunction rangeContainsMarker(range, date) {\n    return (range.start === null || date >= range.start) &&\n        (range.end === null || date < range.end);\n}\n// If the given date is not within the given range, move it inside.\n// (If it's past the end, make it one millisecond before the end).\nfunction constrainMarkerToRange(date, range) {\n    if (range.start != null && date < range.start) {\n        return range.start;\n    }\n    if (range.end != null && date >= range.end) {\n        return new Date(range.end.valueOf() - 1);\n    }\n    return date;\n}\n\nfunction removeExact(array, exactVal) {\n    var removeCnt = 0;\n    var i = 0;\n    while (i < array.length) {\n        if (array[i] === exactVal) {\n            array.splice(i, 1);\n            removeCnt++;\n        }\n        else {\n            i++;\n        }\n    }\n    return removeCnt;\n}\nfunction isArraysEqual(a0, a1) {\n    var len = a0.length;\n    var i;\n    if (len !== a1.length) { // not array? or not same length?\n        return false;\n    }\n    for (i = 0; i < len; i++) {\n        if (a0[i] !== a1[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoize(workerFunc) {\n    var args;\n    var res;\n    return function () {\n        if (!args || !isArraysEqual(args, arguments)) {\n            args = arguments;\n            res = workerFunc.apply(this, arguments);\n        }\n        return res;\n    };\n}\n/*\nalways executes the workerFunc, but if the result is equal to the previous result,\nreturn the previous result instead.\n*/\nfunction memoizeOutput(workerFunc, equalityFunc) {\n    var cachedRes = null;\n    return function () {\n        var newRes = workerFunc.apply(this, arguments);\n        if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\n            cachedRes = newRes;\n        }\n        return cachedRes;\n    };\n}\n\nvar EXTENDED_SETTINGS_AND_SEVERITIES = {\n    week: 3,\n    separator: 0,\n    omitZeroMinute: 0,\n    meridiem: 0,\n    omitCommas: 0\n};\nvar STANDARD_DATE_PROP_SEVERITIES = {\n    timeZoneName: 7,\n    era: 6,\n    year: 5,\n    month: 4,\n    day: 2,\n    weekday: 2,\n    hour: 1,\n    minute: 1,\n    second: 1\n};\nvar MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i; // eats up leading spaces too\nvar COMMA_RE = /,/g; // we need re for globalness\nvar MULTI_SPACE_RE = /\\s+/g;\nvar LTR_RE = /\\u200e/g; // control character\nvar UTC_RE = /UTC|GMT/;\nvar NativeFormatter = /** @class */ (function () {\n    function NativeFormatter(formatSettings) {\n        var standardDateProps = {};\n        var extendedSettings = {};\n        var severity = 0;\n        for (var name_1 in formatSettings) {\n            if (name_1 in EXTENDED_SETTINGS_AND_SEVERITIES) {\n                extendedSettings[name_1] = formatSettings[name_1];\n                severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1], severity);\n            }\n            else {\n                standardDateProps[name_1] = formatSettings[name_1];\n                if (name_1 in STANDARD_DATE_PROP_SEVERITIES) {\n                    severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1], severity);\n                }\n            }\n        }\n        this.standardDateProps = standardDateProps;\n        this.extendedSettings = extendedSettings;\n        this.severity = severity;\n        this.buildFormattingFunc = memoize(buildFormattingFunc);\n    }\n    NativeFormatter.prototype.format = function (date, context) {\n        return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date);\n    };\n    NativeFormatter.prototype.formatRange = function (start, end, context) {\n        var _a = this, standardDateProps = _a.standardDateProps, extendedSettings = _a.extendedSettings;\n        var diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem);\n        if (!diffSeverity) {\n            return this.format(start, context);\n        }\n        var biggestUnitForPartial = diffSeverity;\n        if (biggestUnitForPartial > 1 && // the two dates are different in a way that's larger scale than time\n            (standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') &&\n            (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') &&\n            (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')) {\n            biggestUnitForPartial = 1; // make it look like the dates are only different in terms of time\n        }\n        var full0 = this.format(start, context);\n        var full1 = this.format(end, context);\n        if (full0 === full1) {\n            return full0;\n        }\n        var partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial);\n        var partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context);\n        var partial0 = partialFormattingFunc(start);\n        var partial1 = partialFormattingFunc(end);\n        var insertion = findCommonInsertion(full0, partial0, full1, partial1);\n        var separator = extendedSettings.separator || '';\n        if (insertion) {\n            return insertion.before + partial0 + separator + partial1 + insertion.after;\n        }\n        return full0 + separator + full1;\n    };\n    NativeFormatter.prototype.getLargestUnit = function () {\n        switch (this.severity) {\n            case 7:\n            case 6:\n            case 5:\n                return 'year';\n            case 4:\n                return 'month';\n            case 3:\n                return 'week';\n            default:\n                return 'day';\n        }\n    };\n    return NativeFormatter;\n}());\nfunction buildFormattingFunc(standardDateProps, extendedSettings, context) {\n    var standardDatePropCnt = Object.keys(standardDateProps).length;\n    if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\n        return function (date) {\n            return formatTimeZoneOffset(date.timeZoneOffset);\n        };\n    }\n    if (standardDatePropCnt === 0 && extendedSettings.week) {\n        return function (date) {\n            return formatWeekNumber(context.computeWeekNumber(date.marker), context.weekLabel, context.locale, extendedSettings.week);\n        };\n    }\n    return buildNativeFormattingFunc(standardDateProps, extendedSettings, context);\n}\nfunction buildNativeFormattingFunc(standardDateProps, extendedSettings, context) {\n    standardDateProps = __assign({}, standardDateProps); // copy\n    extendedSettings = __assign({}, extendedSettings); // copy\n    sanitizeSettings(standardDateProps, extendedSettings);\n    standardDateProps.timeZone = 'UTC'; // we leverage the only guaranteed timeZone for our UTC markers\n    var normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps);\n    var zeroFormat; // needed?\n    if (extendedSettings.omitZeroMinute) {\n        var zeroProps = __assign({}, standardDateProps);\n        delete zeroProps.minute; // seconds and ms were already considered in sanitizeSettings\n        zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps);\n    }\n    return function (date) {\n        var marker = date.marker;\n        var format;\n        if (zeroFormat && !marker.getUTCMinutes()) {\n            format = zeroFormat;\n        }\n        else {\n            format = normalFormat;\n        }\n        var s = format.format(marker);\n        return postProcess(s, date, standardDateProps, extendedSettings, context);\n    };\n}\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\n    // deal with a browser inconsistency where formatting the timezone\n    // requires that the hour/minute be present.\n    if (standardDateProps.timeZoneName) {\n        if (!standardDateProps.hour) {\n            standardDateProps.hour = '2-digit';\n        }\n        if (!standardDateProps.minute) {\n            standardDateProps.minute = '2-digit';\n        }\n    }\n    // only support short timezone names\n    if (standardDateProps.timeZoneName === 'long') {\n        standardDateProps.timeZoneName = 'short';\n    }\n    // if requesting to display seconds, MUST display minutes\n    if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\n        delete extendedSettings.omitZeroMinute;\n    }\n}\nfunction postProcess(s, date, standardDateProps, extendedSettings, context) {\n    s = s.replace(LTR_RE, ''); // remove left-to-right control chars. do first. good for other regexes\n    if (standardDateProps.timeZoneName === 'short') {\n        s = injectTzoStr(s, (context.timeZone === 'UTC' || date.timeZoneOffset == null) ?\n            'UTC' : // important to normalize for IE, which does \"GMT\"\n            formatTimeZoneOffset(date.timeZoneOffset));\n    }\n    if (extendedSettings.omitCommas) {\n        s = s.replace(COMMA_RE, '').trim();\n    }\n    if (extendedSettings.omitZeroMinute) {\n        s = s.replace(':00', ''); // zeroFormat doesn't always achieve this\n    }\n    // ^ do anything that might create adjacent spaces before this point,\n    // because MERIDIEM_RE likes to eat up loading spaces\n    if (extendedSettings.meridiem === false) {\n        s = s.replace(MERIDIEM_RE, '').trim();\n    }\n    else if (extendedSettings.meridiem === 'narrow') { // a/p\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\n            return m1.toLocaleLowerCase();\n        });\n    }\n    else if (extendedSettings.meridiem === 'short') { // am/pm\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\n            return m1.toLocaleLowerCase() + 'm';\n        });\n    }\n    else if (extendedSettings.meridiem === 'lowercase') { // other meridiem transformers already converted to lowercase\n        s = s.replace(MERIDIEM_RE, function (m0) {\n            return m0.toLocaleLowerCase();\n        });\n    }\n    s = s.replace(MULTI_SPACE_RE, ' ');\n    s = s.trim();\n    return s;\n}\nfunction injectTzoStr(s, tzoStr) {\n    var replaced = false;\n    s = s.replace(UTC_RE, function () {\n        replaced = true;\n        return tzoStr;\n    });\n    // IE11 doesn't include UTC/GMT in the original string, so append to end\n    if (!replaced) {\n        s += ' ' + tzoStr;\n    }\n    return s;\n}\nfunction formatWeekNumber(num, weekLabel, locale, display) {\n    var parts = [];\n    if (display === 'narrow') {\n        parts.push(weekLabel);\n    }\n    else if (display === 'short') {\n        parts.push(weekLabel, ' ');\n    }\n    // otherwise, considered 'numeric'\n    parts.push(locale.simpleNumberFormat.format(num));\n    if (locale.options.isRtl) { // TODO: use control characters instead?\n        parts.reverse();\n    }\n    return parts.join('');\n}\n// Range Formatting Utils\n// 0 = exactly the same\n// 1 = different by time\n// and bigger\nfunction computeMarkerDiffSeverity(d0, d1, ca) {\n    if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\n        return 5;\n    }\n    if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\n        return 4;\n    }\n    if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\n        return 2;\n    }\n    if (timeAsMs(d0) !== timeAsMs(d1)) {\n        return 1;\n    }\n    return 0;\n}\nfunction computePartialFormattingOptions(options, biggestUnit) {\n    var partialOptions = {};\n    for (var name_2 in options) {\n        if (!(name_2 in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\n            STANDARD_DATE_PROP_SEVERITIES[name_2] <= biggestUnit) {\n            partialOptions[name_2] = options[name_2];\n        }\n    }\n    return partialOptions;\n}\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\n    var i0 = 0;\n    while (i0 < full0.length) {\n        var found0 = full0.indexOf(partial0, i0);\n        if (found0 === -1) {\n            break;\n        }\n        var before0 = full0.substr(0, found0);\n        i0 = found0 + partial0.length;\n        var after0 = full0.substr(i0);\n        var i1 = 0;\n        while (i1 < full1.length) {\n            var found1 = full1.indexOf(partial1, i1);\n            if (found1 === -1) {\n                break;\n            }\n            var before1 = full1.substr(0, found1);\n            i1 = found1 + partial1.length;\n            var after1 = full1.substr(i1);\n            if (before0 === before1 && after0 === after1) {\n                return {\n                    before: before0,\n                    after: after0\n                };\n            }\n        }\n    }\n    return null;\n}\n\n/*\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\n*/\n/*\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\nIt receives this at the time of formatting, as a setting.\n*/\nvar CmdFormatter = /** @class */ (function () {\n    function CmdFormatter(cmdStr, separator) {\n        this.cmdStr = cmdStr;\n        this.separator = separator;\n    }\n    CmdFormatter.prototype.format = function (date, context) {\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator));\n    };\n    CmdFormatter.prototype.formatRange = function (start, end, context) {\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator));\n    };\n    return CmdFormatter;\n}());\n\nvar FuncFormatter = /** @class */ (function () {\n    function FuncFormatter(func) {\n        this.func = func;\n    }\n    FuncFormatter.prototype.format = function (date, context) {\n        return this.func(createVerboseFormattingArg(date, null, context));\n    };\n    FuncFormatter.prototype.formatRange = function (start, end, context) {\n        return this.func(createVerboseFormattingArg(start, end, context));\n    };\n    return FuncFormatter;\n}());\n\n// Formatter Object Creation\nfunction createFormatter(input, defaultSeparator) {\n    if (typeof input === 'object' && input) { // non-null object\n        if (typeof defaultSeparator === 'string') {\n            input = __assign({ separator: defaultSeparator }, input);\n        }\n        return new NativeFormatter(input);\n    }\n    else if (typeof input === 'string') {\n        return new CmdFormatter(input, defaultSeparator);\n    }\n    else if (typeof input === 'function') {\n        return new FuncFormatter(input);\n    }\n}\n// String Utils\n// timeZoneOffset is in minutes\nfunction buildIsoString(marker, timeZoneOffset, stripZeroTime) {\n    if (stripZeroTime === void 0) { stripZeroTime = false; }\n    var s = marker.toISOString();\n    s = s.replace('.000', '');\n    if (stripZeroTime) {\n        s = s.replace('T00:00:00Z', '');\n    }\n    if (s.length > 10) { // time part wasn't stripped, can add timezone info\n        if (timeZoneOffset == null) {\n            s = s.replace('Z', '');\n        }\n        else if (timeZoneOffset !== 0) {\n            s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true));\n        }\n        // otherwise, its UTC-0 and we want to keep the Z\n    }\n    return s;\n}\nfunction formatIsoTimeString(marker) {\n    return padStart(marker.getUTCHours(), 2) + ':' +\n        padStart(marker.getUTCMinutes(), 2) + ':' +\n        padStart(marker.getUTCSeconds(), 2);\n}\nfunction formatTimeZoneOffset(minutes, doIso) {\n    if (doIso === void 0) { doIso = false; }\n    var sign = minutes < 0 ? '-' : '+';\n    var abs = Math.abs(minutes);\n    var hours = Math.floor(abs / 60);\n    var mins = Math.round(abs % 60);\n    if (doIso) {\n        return sign + padStart(hours, 2) + ':' + padStart(mins, 2);\n    }\n    else {\n        return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '');\n    }\n}\n// Arg Utils\nfunction createVerboseFormattingArg(start, end, context, separator) {\n    var startInfo = expandZonedMarker(start, context.calendarSystem);\n    var endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null;\n    return {\n        date: startInfo,\n        start: startInfo,\n        end: endInfo,\n        timeZone: context.timeZone,\n        localeCodes: context.locale.codes,\n        separator: separator\n    };\n}\nfunction expandZonedMarker(dateInfo, calendarSystem) {\n    var a = calendarSystem.markerToArray(dateInfo.marker);\n    return {\n        marker: dateInfo.marker,\n        timeZoneOffset: dateInfo.timeZoneOffset,\n        array: a,\n        year: a[0],\n        month: a[1],\n        day: a[2],\n        hour: a[3],\n        minute: a[4],\n        second: a[5],\n        millisecond: a[6]\n    };\n}\n\nvar EventSourceApi = /** @class */ (function () {\n    function EventSourceApi(calendar, internalEventSource) {\n        this.calendar = calendar;\n        this.internalEventSource = internalEventSource;\n    }\n    EventSourceApi.prototype.remove = function () {\n        this.calendar.dispatch({\n            type: 'REMOVE_EVENT_SOURCE',\n            sourceId: this.internalEventSource.sourceId\n        });\n    };\n    EventSourceApi.prototype.refetch = function () {\n        this.calendar.dispatch({\n            type: 'FETCH_EVENT_SOURCES',\n            sourceIds: [this.internalEventSource.sourceId]\n        });\n    };\n    Object.defineProperty(EventSourceApi.prototype, \"id\", {\n        get: function () {\n            return this.internalEventSource.publicId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventSourceApi.prototype, \"url\", {\n        // only relevant to json-feed event sources\n        get: function () {\n            return this.internalEventSource.meta.url;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return EventSourceApi;\n}());\n\nvar EventApi = /** @class */ (function () {\n    function EventApi(calendar, def, instance) {\n        this._calendar = calendar;\n        this._def = def;\n        this._instance = instance || null;\n    }\n    /*\n    TODO: make event struct more responsible for this\n    */\n    EventApi.prototype.setProp = function (name, val) {\n        var _a, _b;\n        if (name in DATE_PROPS) ;\n        else if (name in NON_DATE_PROPS) {\n            if (typeof NON_DATE_PROPS[name] === 'function') {\n                val = NON_DATE_PROPS[name](val);\n            }\n            this.mutate({\n                standardProps: (_a = {}, _a[name] = val, _a)\n            });\n        }\n        else if (name in UNSCOPED_EVENT_UI_PROPS) {\n            var ui = void 0;\n            if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\n                val = UNSCOPED_EVENT_UI_PROPS[name](val);\n            }\n            if (name === 'color') {\n                ui = { backgroundColor: val, borderColor: val };\n            }\n            else if (name === 'editable') {\n                ui = { startEditable: val, durationEditable: val };\n            }\n            else {\n                ui = (_b = {}, _b[name] = val, _b);\n            }\n            this.mutate({\n                standardProps: { ui: ui }\n            });\n        }\n    };\n    EventApi.prototype.setExtendedProp = function (name, val) {\n        var _a;\n        this.mutate({\n            extendedProps: (_a = {}, _a[name] = val, _a)\n        });\n    };\n    EventApi.prototype.setStart = function (startInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var start = dateEnv.createMarker(startInput);\n        if (start && this._instance) { // TODO: warning if parsed bad\n            var instanceRange = this._instance.range;\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity); // what if parsed bad!?\n            if (options.maintainDuration) {\n                this.mutate({ datesDelta: startDelta });\n            }\n            else {\n                this.mutate({ startDelta: startDelta });\n            }\n        }\n    };\n    EventApi.prototype.setEnd = function (endInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var end;\n        if (endInput != null) {\n            end = dateEnv.createMarker(endInput);\n            if (!end) {\n                return; // TODO: warning if parsed bad\n            }\n        }\n        if (this._instance) {\n            if (end) {\n                var endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity);\n                this.mutate({ endDelta: endDelta });\n            }\n            else {\n                this.mutate({ standardProps: { hasEnd: false } });\n            }\n        }\n    };\n    EventApi.prototype.setDates = function (startInput, endInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var standardProps = { allDay: options.allDay };\n        var start = dateEnv.createMarker(startInput);\n        var end;\n        if (!start) {\n            return; // TODO: warning if parsed bad\n        }\n        if (endInput != null) {\n            end = dateEnv.createMarker(endInput);\n            if (!end) { // TODO: warning if parsed bad\n                return;\n            }\n        }\n        if (this._instance) {\n            var instanceRange = this._instance.range;\n            // when computing the diff for an event being converted to all-day,\n            // compute diff off of the all-day values the way event-mutation does.\n            if (options.allDay === true) {\n                instanceRange = computeAlignedDayRange(instanceRange);\n            }\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity);\n            if (end) {\n                var endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity);\n                if (durationsEqual(startDelta, endDelta)) {\n                    this.mutate({ datesDelta: startDelta, standardProps: standardProps });\n                }\n                else {\n                    this.mutate({ startDelta: startDelta, endDelta: endDelta, standardProps: standardProps });\n                }\n            }\n            else { // means \"clear the end\"\n                standardProps.hasEnd = false;\n                this.mutate({ datesDelta: startDelta, standardProps: standardProps });\n            }\n        }\n    };\n    EventApi.prototype.moveStart = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ startDelta: delta });\n        }\n    };\n    EventApi.prototype.moveEnd = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ endDelta: delta });\n        }\n    };\n    EventApi.prototype.moveDates = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ datesDelta: delta });\n        }\n    };\n    EventApi.prototype.setAllDay = function (allDay, options) {\n        if (options === void 0) { options = {}; }\n        var standardProps = { allDay: allDay };\n        var maintainDuration = options.maintainDuration;\n        if (maintainDuration == null) {\n            maintainDuration = this._calendar.opt('allDayMaintainDuration');\n        }\n        if (this._def.allDay !== allDay) {\n            standardProps.hasEnd = maintainDuration;\n        }\n        this.mutate({ standardProps: standardProps });\n    };\n    EventApi.prototype.formatRange = function (formatInput) {\n        var dateEnv = this._calendar.dateEnv;\n        var instance = this._instance;\n        var formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'));\n        if (this._def.hasEnd) {\n            return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\n                forcedStartTzo: instance.forcedStartTzo,\n                forcedEndTzo: instance.forcedEndTzo\n            });\n        }\n        else {\n            return dateEnv.format(instance.range.start, formatter, {\n                forcedTzo: instance.forcedStartTzo\n            });\n        }\n    };\n    EventApi.prototype.mutate = function (mutation) {\n        var def = this._def;\n        var instance = this._instance;\n        if (instance) {\n            this._calendar.dispatch({\n                type: 'MUTATE_EVENTS',\n                instanceId: instance.instanceId,\n                mutation: mutation,\n                fromApi: true\n            });\n            var eventStore = this._calendar.state.eventStore;\n            this._def = eventStore.defs[def.defId];\n            this._instance = eventStore.instances[instance.instanceId];\n        }\n    };\n    EventApi.prototype.remove = function () {\n        this._calendar.dispatch({\n            type: 'REMOVE_EVENT_DEF',\n            defId: this._def.defId\n        });\n    };\n    Object.defineProperty(EventApi.prototype, \"source\", {\n        get: function () {\n            var sourceId = this._def.sourceId;\n            if (sourceId) {\n                return new EventSourceApi(this._calendar, this._calendar.state.eventSources[sourceId]);\n            }\n            return null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"start\", {\n        get: function () {\n            return this._instance ?\n                this._calendar.dateEnv.toDate(this._instance.range.start) :\n                null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"end\", {\n        get: function () {\n            return (this._instance && this._def.hasEnd) ?\n                this._calendar.dateEnv.toDate(this._instance.range.end) :\n                null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"id\", {\n        // computable props that all access the def\n        // TODO: find a TypeScript-compatible way to do this at scale\n        get: function () { return this._def.publicId; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"groupId\", {\n        get: function () { return this._def.groupId; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"allDay\", {\n        get: function () { return this._def.allDay; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"title\", {\n        get: function () { return this._def.title; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"url\", {\n        get: function () { return this._def.url; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"rendering\", {\n        get: function () { return this._def.rendering; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"startEditable\", {\n        get: function () { return this._def.ui.startEditable; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"durationEditable\", {\n        get: function () { return this._def.ui.durationEditable; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"constraint\", {\n        get: function () { return this._def.ui.constraints[0] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"overlap\", {\n        get: function () { return this._def.ui.overlap; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"allow\", {\n        get: function () { return this._def.ui.allows[0] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"backgroundColor\", {\n        get: function () { return this._def.ui.backgroundColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"borderColor\", {\n        get: function () { return this._def.ui.borderColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"textColor\", {\n        get: function () { return this._def.ui.textColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"classNames\", {\n        // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n        get: function () { return this._def.ui.classNames; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"extendedProps\", {\n        get: function () { return this._def.extendedProps; },\n        enumerable: true,\n        configurable: true\n    });\n    return EventApi;\n}());\n\n/*\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\n*/\nfunction sliceEventStore(eventStore, eventUiBases, framingRange, nextDayThreshold) {\n    var inverseBgByGroupId = {};\n    var inverseBgByDefId = {};\n    var defByGroupId = {};\n    var bgRanges = [];\n    var fgRanges = [];\n    var eventUis = compileEventUis(eventStore.defs, eventUiBases);\n    for (var defId in eventStore.defs) {\n        var def = eventStore.defs[defId];\n        if (def.rendering === 'inverse-background') {\n            if (def.groupId) {\n                inverseBgByGroupId[def.groupId] = [];\n                if (!defByGroupId[def.groupId]) {\n                    defByGroupId[def.groupId] = def;\n                }\n            }\n            else {\n                inverseBgByDefId[defId] = [];\n            }\n        }\n    }\n    for (var instanceId in eventStore.instances) {\n        var instance = eventStore.instances[instanceId];\n        var def = eventStore.defs[instance.defId];\n        var ui = eventUis[def.defId];\n        var origRange = instance.range;\n        var normalRange = (!def.allDay && nextDayThreshold) ?\n            computeVisibleDayRange(origRange, nextDayThreshold) :\n            origRange;\n        var slicedRange = intersectRanges(normalRange, framingRange);\n        if (slicedRange) {\n            if (def.rendering === 'inverse-background') {\n                if (def.groupId) {\n                    inverseBgByGroupId[def.groupId].push(slicedRange);\n                }\n                else {\n                    inverseBgByDefId[instance.defId].push(slicedRange);\n                }\n            }\n            else {\n                (def.rendering === 'background' ? bgRanges : fgRanges).push({\n                    def: def,\n                    ui: ui,\n                    instance: instance,\n                    range: slicedRange,\n                    isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\n                    isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\n                });\n            }\n        }\n    }\n    for (var groupId in inverseBgByGroupId) { // BY GROUP\n        var ranges = inverseBgByGroupId[groupId];\n        var invertedRanges = invertRanges(ranges, framingRange);\n        for (var _i = 0, invertedRanges_1 = invertedRanges; _i < invertedRanges_1.length; _i++) {\n            var invertedRange = invertedRanges_1[_i];\n            var def = defByGroupId[groupId];\n            var ui = eventUis[def.defId];\n            bgRanges.push({\n                def: def,\n                ui: ui,\n                instance: null,\n                range: invertedRange,\n                isStart: false,\n                isEnd: false\n            });\n        }\n    }\n    for (var defId in inverseBgByDefId) {\n        var ranges = inverseBgByDefId[defId];\n        var invertedRanges = invertRanges(ranges, framingRange);\n        for (var _a = 0, invertedRanges_2 = invertedRanges; _a < invertedRanges_2.length; _a++) {\n            var invertedRange = invertedRanges_2[_a];\n            bgRanges.push({\n                def: eventStore.defs[defId],\n                ui: eventUis[defId],\n                instance: null,\n                range: invertedRange,\n                isStart: false,\n                isEnd: false\n            });\n        }\n    }\n    return { bg: bgRanges, fg: fgRanges };\n}\nfunction hasBgRendering(def) {\n    return def.rendering === 'background' || def.rendering === 'inverse-background';\n}\nfunction filterSegsViaEls(view, segs, isMirror) {\n    if (view.hasPublicHandlers('eventRender')) {\n        segs = segs.filter(function (seg) {\n            var custom = view.publiclyTrigger('eventRender', [\n                {\n                    event: new EventApi(view.calendar, seg.eventRange.def, seg.eventRange.instance),\n                    isMirror: isMirror,\n                    isStart: seg.isStart,\n                    isEnd: seg.isEnd,\n                    // TODO: include seg.range once all components consistently generate it\n                    el: seg.el,\n                    view: view\n                }\n            ]);\n            if (custom === false) { // means don't render at all\n                return false;\n            }\n            else if (custom && custom !== true) {\n                seg.el = custom;\n            }\n            return true;\n        });\n    }\n    for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n        var seg = segs_1[_i];\n        setElSeg(seg.el, seg);\n    }\n    return segs;\n}\nfunction setElSeg(el, seg) {\n    el.fcSeg = seg;\n}\nfunction getElSeg(el) {\n    return el.fcSeg || null;\n}\n// event ui computation\nfunction compileEventUis(eventDefs, eventUiBases) {\n    return mapHash(eventDefs, function (eventDef) {\n        return compileEventUi(eventDef, eventUiBases);\n    });\n}\nfunction compileEventUi(eventDef, eventUiBases) {\n    var uis = [];\n    if (eventUiBases['']) {\n        uis.push(eventUiBases['']);\n    }\n    if (eventUiBases[eventDef.defId]) {\n        uis.push(eventUiBases[eventDef.defId]);\n    }\n    uis.push(eventDef.ui);\n    return combineEventUis(uis);\n}\n\n// applies the mutation to ALL defs/instances within the event store\nfunction applyMutationToEventStore(eventStore, eventConfigBase, mutation, calendar) {\n    var eventConfigs = compileEventUis(eventStore.defs, eventConfigBase);\n    var dest = createEmptyEventStore();\n    for (var defId in eventStore.defs) {\n        var def = eventStore.defs[defId];\n        dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar);\n    }\n    for (var instanceId in eventStore.instances) {\n        var instance = eventStore.instances[instanceId];\n        var def = dest.defs[instance.defId]; // important to grab the newly modified def\n        dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar);\n    }\n    return dest;\n}\nfunction applyMutationToEventDef(eventDef, eventConfig, mutation, appliers, calendar) {\n    var standardProps = mutation.standardProps || {};\n    // if hasEnd has not been specified, guess a good value based on deltas.\n    // if duration will change, there's no way the default duration will persist,\n    // and thus, we need to mark the event as having a real end\n    if (standardProps.hasEnd == null &&\n        eventConfig.durationEditable &&\n        (mutation.startDelta || mutation.endDelta)) {\n        standardProps.hasEnd = true; // TODO: is this mutation okay?\n    }\n    var copy = __assign({}, eventDef, standardProps, { ui: __assign({}, eventDef.ui, standardProps.ui) });\n    if (mutation.extendedProps) {\n        copy.extendedProps = __assign({}, copy.extendedProps, mutation.extendedProps);\n    }\n    for (var _i = 0, appliers_1 = appliers; _i < appliers_1.length; _i++) {\n        var applier = appliers_1[_i];\n        applier(copy, mutation, calendar);\n    }\n    if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\n        copy.hasEnd = true;\n    }\n    return copy;\n}\nfunction applyMutationToEventInstance(eventInstance, eventDef, // must first be modified by applyMutationToEventDef\neventConfig, mutation, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true;\n    var clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false;\n    var copy = __assign({}, eventInstance);\n    if (forceAllDay) {\n        copy.range = computeAlignedDayRange(copy.range);\n    }\n    if (mutation.datesDelta && eventConfig.startEditable) {\n        copy.range = {\n            start: dateEnv.add(copy.range.start, mutation.datesDelta),\n            end: dateEnv.add(copy.range.end, mutation.datesDelta)\n        };\n    }\n    if (mutation.startDelta && eventConfig.durationEditable) {\n        copy.range = {\n            start: dateEnv.add(copy.range.start, mutation.startDelta),\n            end: copy.range.end\n        };\n    }\n    if (mutation.endDelta && eventConfig.durationEditable) {\n        copy.range = {\n            start: copy.range.start,\n            end: dateEnv.add(copy.range.end, mutation.endDelta)\n        };\n    }\n    if (clearEnd) {\n        copy.range = {\n            start: copy.range.start,\n            end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n        };\n    }\n    // in case event was all-day but the supplied deltas were not\n    // better util for this?\n    if (eventDef.allDay) {\n        copy.range = {\n            start: startOfDay(copy.range.start),\n            end: startOfDay(copy.range.end)\n        };\n    }\n    // handle invalid durations\n    if (copy.range.end < copy.range.start) {\n        copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start);\n    }\n    return copy;\n}\n\nfunction reduceEventStore (eventStore, action, eventSources, dateProfile, calendar) {\n    switch (action.type) {\n        case 'RECEIVE_EVENTS': // raw\n            return receiveRawEvents(eventStore, eventSources[action.sourceId], action.fetchId, action.fetchRange, action.rawEvents, calendar);\n        case 'ADD_EVENTS': // already parsed, but not expanded\n            return addEvent(eventStore, action.eventStore, // new ones\n            dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'MERGE_EVENTS': // already parsed and expanded\n            return mergeEventStores(eventStore, action.eventStore);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            if (dateProfile) {\n                return expandRecurring(eventStore, dateProfile.activeRange, calendar);\n            }\n            else {\n                return eventStore;\n            }\n        case 'CHANGE_TIMEZONE':\n            return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv);\n        case 'MUTATE_EVENTS':\n            return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar);\n        case 'REMOVE_EVENT_INSTANCES':\n            return excludeInstances(eventStore, action.instances);\n        case 'REMOVE_EVENT_DEF':\n            return filterEventStoreDefs(eventStore, function (eventDef) {\n                return eventDef.defId !== action.defId;\n            });\n        case 'REMOVE_EVENT_SOURCE':\n            return excludeEventsBySourceId(eventStore, action.sourceId);\n        case 'REMOVE_ALL_EVENT_SOURCES':\n            return filterEventStoreDefs(eventStore, function (eventDef) {\n                return !eventDef.sourceId; // only keep events with no source id\n            });\n        case 'REMOVE_ALL_EVENTS':\n            return createEmptyEventStore();\n        case 'RESET_EVENTS':\n            return {\n                defs: eventStore.defs,\n                instances: eventStore.instances\n            };\n        default:\n            return eventStore;\n    }\n}\nfunction receiveRawEvents(eventStore, eventSource, fetchId, fetchRange, rawEvents, calendar) {\n    if (eventSource && // not already removed\n        fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\n    ) {\n        var subset = parseEvents(transformRawEvents(rawEvents, eventSource, calendar), eventSource.sourceId, calendar);\n        if (fetchRange) {\n            subset = expandRecurring(subset, fetchRange, calendar);\n        }\n        return mergeEventStores(excludeEventsBySourceId(eventStore, eventSource.sourceId), subset);\n    }\n    return eventStore;\n}\nfunction addEvent(eventStore, subset, expandRange, calendar) {\n    if (expandRange) {\n        subset = expandRecurring(subset, expandRange, calendar);\n    }\n    return mergeEventStores(eventStore, subset);\n}\nfunction rezoneDates(eventStore, oldDateEnv, newDateEnv) {\n    var defs = eventStore.defs;\n    var instances = mapHash(eventStore.instances, function (instance) {\n        var def = defs[instance.defId];\n        if (def.allDay || def.recurringDef) {\n            return instance; // isn't dependent on timezone\n        }\n        else {\n            return __assign({}, instance, { range: {\n                    start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\n                    end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\n                }, forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo, forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo });\n        }\n    });\n    return { defs: defs, instances: instances };\n}\nfunction applyMutationToRelated(eventStore, instanceId, mutation, fromApi, calendar) {\n    var relevant = getRelevantEvents(eventStore, instanceId);\n    var eventConfigBase = fromApi ?\n        { '': {\n                startEditable: true,\n                durationEditable: true,\n                constraints: [],\n                overlap: null,\n                allows: [],\n                backgroundColor: '',\n                borderColor: '',\n                textColor: '',\n                classNames: []\n            } } :\n        calendar.eventUiBases;\n    relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar);\n    return mergeEventStores(eventStore, relevant);\n}\nfunction excludeEventsBySourceId(eventStore, sourceId) {\n    return filterEventStoreDefs(eventStore, function (eventDef) {\n        return eventDef.sourceId !== sourceId;\n    });\n}\n// QUESTION: why not just return instances? do a general object-property-exclusion util\nfunction excludeInstances(eventStore, removals) {\n    return {\n        defs: eventStore.defs,\n        instances: filterHash(eventStore.instances, function (instance) {\n            return !removals[instance.instanceId];\n        })\n    };\n}\n\n// high-level segmenting-aware tester functions\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isInteractionValid(interaction, calendar) {\n    return isNewPropsValid({ eventDrag: interaction }, calendar); // HACK: the eventDrag props is used for ALL interactions\n}\nfunction isDateSelectionValid(dateSelection, calendar) {\n    return isNewPropsValid({ dateSelection: dateSelection }, calendar);\n}\nfunction isNewPropsValid(newProps, calendar) {\n    var view = calendar.view;\n    var props = __assign({ businessHours: view ? view.props.businessHours : createEmptyEventStore(), dateSelection: '', eventStore: calendar.state.eventStore, eventUiBases: calendar.eventUiBases, eventSelection: '', eventDrag: null, eventResize: null }, newProps);\n    return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar);\n}\nfunction isPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    if (dateSpanMeta === void 0) { dateSpanMeta = {}; }\n    if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n        return false;\n    }\n    if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n        return false;\n    }\n    return true;\n}\n// Moving Event Validation\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    var interaction = state.eventDrag; // HACK: the eventDrag props is used for ALL interactions\n    var subjectEventStore = interaction.mutatedEvents;\n    var subjectDefs = subjectEventStore.defs;\n    var subjectInstances = subjectEventStore.instances;\n    var subjectConfigs = compileEventUis(subjectDefs, interaction.isEvent ?\n        state.eventUiBases :\n        { '': calendar.selectionConfig } // if not a real event, validate as a selection\n    );\n    if (filterConfig) {\n        subjectConfigs = mapHash(subjectConfigs, filterConfig);\n    }\n    var otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances); // exclude the subject events. TODO: exclude defs too?\n    var otherDefs = otherEventStore.defs;\n    var otherInstances = otherEventStore.instances;\n    var otherConfigs = compileEventUis(otherDefs, state.eventUiBases);\n    for (var subjectInstanceId in subjectInstances) {\n        var subjectInstance = subjectInstances[subjectInstanceId];\n        var subjectRange = subjectInstance.range;\n        var subjectConfig = subjectConfigs[subjectInstance.defId];\n        var subjectDef = subjectDefs[subjectInstance.defId];\n        // constraint\n        if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\n            return false;\n        }\n        // overlap\n        var overlapFunc = calendar.opt('eventOverlap');\n        if (typeof overlapFunc !== 'function') {\n            overlapFunc = null;\n        }\n        for (var otherInstanceId in otherInstances) {\n            var otherInstance = otherInstances[otherInstanceId];\n            // intersect! evaluate\n            if (rangesIntersect(subjectRange, otherInstance.range)) {\n                var otherOverlap = otherConfigs[otherInstance.defId].overlap;\n                // consider the other event's overlap. only do this if the subject event is a \"real\" event\n                if (otherOverlap === false && interaction.isEvent) {\n                    return false;\n                }\n                if (subjectConfig.overlap === false) {\n                    return false;\n                }\n                if (overlapFunc && !overlapFunc(new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\n                new EventApi(calendar, subjectDef, subjectInstance) // moving event\n                )) {\n                    return false;\n                }\n            }\n        }\n        // allow (a function)\n        var calendarEventStore = calendar.state.eventStore; // need global-to-calendar, not local to component (splittable)state\n        for (var _i = 0, _a = subjectConfig.allows; _i < _a.length; _i++) {\n            var subjectAllow = _a[_i];\n            var subjectDateSpan = __assign({}, dateSpanMeta, { range: subjectInstance.range, allDay: subjectDef.allDay });\n            var origDef = calendarEventStore.defs[subjectDef.defId];\n            var origInstance = calendarEventStore.instances[subjectInstanceId];\n            var eventApi = void 0;\n            if (origDef) { // was previously in the calendar\n                eventApi = new EventApi(calendar, origDef, origInstance);\n            }\n            else { // was an external event\n                eventApi = new EventApi(calendar, subjectDef); // no instance, because had no dates\n            }\n            if (!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan), eventApi)) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n// Date Selection Validation\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    var relevantEventStore = state.eventStore;\n    var relevantDefs = relevantEventStore.defs;\n    var relevantInstances = relevantEventStore.instances;\n    var selection = state.dateSelection;\n    var selectionRange = selection.range;\n    var selectionConfig = calendar.selectionConfig;\n    if (filterConfig) {\n        selectionConfig = filterConfig(selectionConfig);\n    }\n    // constraint\n    if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\n        return false;\n    }\n    // overlap\n    var overlapFunc = calendar.opt('selectOverlap');\n    if (typeof overlapFunc !== 'function') {\n        overlapFunc = null;\n    }\n    for (var relevantInstanceId in relevantInstances) {\n        var relevantInstance = relevantInstances[relevantInstanceId];\n        // intersect! evaluate\n        if (rangesIntersect(selectionRange, relevantInstance.range)) {\n            if (selectionConfig.overlap === false) {\n                return false;\n            }\n            if (overlapFunc && !overlapFunc(new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance))) {\n                return false;\n            }\n        }\n    }\n    // allow (a function)\n    for (var _i = 0, _a = selectionConfig.allows; _i < _a.length; _i++) {\n        var selectionAllow = _a[_i];\n        var fullDateSpan = __assign({}, dateSpanMeta, selection);\n        if (!selectionAllow(calendar.buildDateSpanApi(fullDateSpan), null)) {\n            return false;\n        }\n    }\n    return true;\n}\n// Constraint Utils\n// ------------------------------------------------------------------------------------------------------------------------\nfunction allConstraintsPass(constraints, subjectRange, otherEventStore, businessHoursUnexpanded, calendar) {\n    for (var _i = 0, constraints_1 = constraints; _i < constraints_1.length; _i++) {\n        var constraint = constraints_1[_i];\n        if (!anyRangesContainRange(constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar), subjectRange)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction constraintToRanges(constraint, subjectRange, // for expanding a recurring constraint, or expanding business hours\notherEventStore, // for if constraint is an even group ID\nbusinessHoursUnexpanded, // for if constraint is 'businessHours'\ncalendar // for expanding businesshours\n) {\n    if (constraint === 'businessHours') {\n        return eventStoreToRanges(expandRecurring(businessHoursUnexpanded, subjectRange, calendar));\n    }\n    else if (typeof constraint === 'string') { // an group ID\n        return eventStoreToRanges(filterEventStoreDefs(otherEventStore, function (eventDef) {\n            return eventDef.groupId === constraint;\n        }));\n    }\n    else if (typeof constraint === 'object' && constraint) { // non-null object\n        return eventStoreToRanges(expandRecurring(constraint, subjectRange, calendar));\n    }\n    return []; // if it's false\n}\n// TODO: move to event-store file?\nfunction eventStoreToRanges(eventStore) {\n    var instances = eventStore.instances;\n    var ranges = [];\n    for (var instanceId in instances) {\n        ranges.push(instances[instanceId].range);\n    }\n    return ranges;\n}\n// TODO: move to geom file?\nfunction anyRangesContainRange(outerRanges, innerRange) {\n    for (var _i = 0, outerRanges_1 = outerRanges; _i < outerRanges_1.length; _i++) {\n        var outerRange = outerRanges_1[_i];\n        if (rangeContainsRange(outerRange, innerRange)) {\n            return true;\n        }\n    }\n    return false;\n}\n// Parsing\n// ------------------------------------------------------------------------------------------------------------------------\nfunction normalizeConstraint(input, calendar) {\n    if (Array.isArray(input)) {\n        return parseEvents(input, '', calendar, true); // allowOpenRange=true\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        return parseEvents([input], '', calendar, true); // allowOpenRange=true\n    }\n    else if (input != null) {\n        return String(input);\n    }\n    else {\n        return null;\n    }\n}\n\nfunction htmlEscape(s) {\n    return (s + '').replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/'/g, '&#039;')\n        .replace(/\"/g, '&quot;')\n        .replace(/\\n/g, '<br />');\n}\n// Given a hash of CSS properties, returns a string of CSS.\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\nfunction cssToStr(cssProps) {\n    var statements = [];\n    for (var name_1 in cssProps) {\n        var val = cssProps[name_1];\n        if (val != null && val !== '') {\n            statements.push(name_1 + ':' + val);\n        }\n    }\n    return statements.join(';');\n}\n// Given an object hash of HTML attribute names to values,\n// generates a string that can be injected between < > in HTML\nfunction attrsToStr(attrs) {\n    var parts = [];\n    for (var name_2 in attrs) {\n        var val = attrs[name_2];\n        if (val != null) {\n            parts.push(name_2 + '=\"' + htmlEscape(val) + '\"');\n        }\n    }\n    return parts.join(' ');\n}\nfunction parseClassName(raw) {\n    if (Array.isArray(raw)) {\n        return raw;\n    }\n    else if (typeof raw === 'string') {\n        return raw.split(/\\s+/);\n    }\n    else {\n        return [];\n    }\n}\n\nvar UNSCOPED_EVENT_UI_PROPS = {\n    editable: Boolean,\n    startEditable: Boolean,\n    durationEditable: Boolean,\n    constraint: null,\n    overlap: null,\n    allow: null,\n    className: parseClassName,\n    classNames: parseClassName,\n    color: String,\n    backgroundColor: String,\n    borderColor: String,\n    textColor: String\n};\nfunction processUnscopedUiProps(rawProps, calendar, leftovers) {\n    var props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers);\n    var constraint = normalizeConstraint(props.constraint, calendar);\n    return {\n        startEditable: props.startEditable != null ? props.startEditable : props.editable,\n        durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\n        constraints: constraint != null ? [constraint] : [],\n        overlap: props.overlap,\n        allows: props.allow != null ? [props.allow] : [],\n        backgroundColor: props.backgroundColor || props.color,\n        borderColor: props.borderColor || props.color,\n        textColor: props.textColor,\n        classNames: props.classNames.concat(props.className)\n    };\n}\nfunction processScopedUiProps(prefix, rawScoped, calendar, leftovers) {\n    var rawUnscoped = {};\n    var wasFound = {};\n    for (var key in UNSCOPED_EVENT_UI_PROPS) {\n        var scopedKey = prefix + capitaliseFirstLetter(key);\n        rawUnscoped[key] = rawScoped[scopedKey];\n        wasFound[scopedKey] = true;\n    }\n    if (prefix === 'event') {\n        rawUnscoped.editable = rawScoped.editable; // special case. there is no 'eventEditable', just 'editable'\n    }\n    if (leftovers) {\n        for (var key in rawScoped) {\n            if (!wasFound[key]) {\n                leftovers[key] = rawScoped[key];\n            }\n        }\n    }\n    return processUnscopedUiProps(rawUnscoped, calendar);\n}\nvar EMPTY_EVENT_UI = {\n    startEditable: null,\n    durationEditable: null,\n    constraints: [],\n    overlap: null,\n    allows: [],\n    backgroundColor: '',\n    borderColor: '',\n    textColor: '',\n    classNames: []\n};\n// prevent against problems with <2 args!\nfunction combineEventUis(uis) {\n    return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI);\n}\nfunction combineTwoEventUis(item0, item1) {\n    return {\n        startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\n        durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\n        constraints: item0.constraints.concat(item1.constraints),\n        overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\n        allows: item0.allows.concat(item1.allows),\n        backgroundColor: item1.backgroundColor || item0.backgroundColor,\n        borderColor: item1.borderColor || item0.borderColor,\n        textColor: item1.textColor || item0.textColor,\n        classNames: item0.classNames.concat(item1.classNames)\n    };\n}\n\nvar NON_DATE_PROPS = {\n    id: String,\n    groupId: String,\n    title: String,\n    url: String,\n    rendering: String,\n    extendedProps: null\n};\nvar DATE_PROPS = {\n    start: null,\n    date: null,\n    end: null,\n    allDay: null\n};\nvar uid = 0;\nfunction parseEvent(raw, sourceId, calendar, allowOpenRange) {\n    var allDayDefault = computeIsAllDayDefault(sourceId, calendar);\n    var leftovers0 = {};\n    var recurringRes = parseRecurring(raw, // raw, but with single-event stuff stripped out\n    allDayDefault, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes, leftovers0 // will populate with non-recurring props\n    );\n    if (recurringRes) {\n        var def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar);\n        def.recurringDef = {\n            typeId: recurringRes.typeId,\n            typeData: recurringRes.typeData,\n            duration: recurringRes.duration\n        };\n        return { def: def, instance: null };\n    }\n    else {\n        var leftovers1 = {};\n        var singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange);\n        if (singleRes) {\n            var def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar);\n            var instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo);\n            return { def: def, instance: instance };\n        }\n    }\n    return null;\n}\n/*\nWill NOT populate extendedProps with the leftover properties.\nWill NOT populate date-related props.\nThe EventNonDateInput has been normalized (id => publicId, etc).\n*/\nfunction parseEventDef(raw, sourceId, allDay, hasEnd, calendar) {\n    var leftovers = {};\n    var def = pluckNonDateProps(raw, calendar, leftovers);\n    def.defId = String(uid++);\n    def.sourceId = sourceId;\n    def.allDay = allDay;\n    def.hasEnd = hasEnd;\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.eventDefParsers; _i < _a.length; _i++) {\n        var eventDefParser = _a[_i];\n        var newLeftovers = {};\n        eventDefParser(def, leftovers, newLeftovers);\n        leftovers = newLeftovers;\n    }\n    def.extendedProps = __assign(leftovers, def.extendedProps || {});\n    // help out EventApi from having user modify props\n    Object.freeze(def.ui.classNames);\n    Object.freeze(def.extendedProps);\n    return def;\n}\nfunction createEventInstance(defId, range, forcedStartTzo, forcedEndTzo) {\n    return {\n        instanceId: String(uid++),\n        defId: defId,\n        range: range,\n        forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\n        forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\n    };\n}\nfunction parseSingle(raw, allDayDefault, calendar, leftovers, allowOpenRange) {\n    var props = pluckDateProps(raw, leftovers);\n    var allDay = props.allDay;\n    var startMeta;\n    var startMarker = null;\n    var hasEnd = false;\n    var endMeta;\n    var endMarker = null;\n    startMeta = calendar.dateEnv.createMarkerMeta(props.start);\n    if (startMeta) {\n        startMarker = startMeta.marker;\n    }\n    else if (!allowOpenRange) {\n        return null;\n    }\n    if (props.end != null) {\n        endMeta = calendar.dateEnv.createMarkerMeta(props.end);\n    }\n    if (allDay == null) {\n        if (allDayDefault != null) {\n            allDay = allDayDefault;\n        }\n        else {\n            // fall back to the date props LAST\n            allDay = (!startMeta || startMeta.isTimeUnspecified) &&\n                (!endMeta || endMeta.isTimeUnspecified);\n        }\n    }\n    if (allDay && startMarker) {\n        startMarker = startOfDay(startMarker);\n    }\n    if (endMeta) {\n        endMarker = endMeta.marker;\n        if (allDay) {\n            endMarker = startOfDay(endMarker);\n        }\n        if (startMarker && endMarker <= startMarker) {\n            endMarker = null;\n        }\n    }\n    if (endMarker) {\n        hasEnd = true;\n    }\n    else if (!allowOpenRange) {\n        hasEnd = calendar.opt('forceEventDuration') || false;\n        endMarker = calendar.dateEnv.add(startMarker, allDay ?\n            calendar.defaultAllDayEventDuration :\n            calendar.defaultTimedEventDuration);\n    }\n    return {\n        allDay: allDay,\n        hasEnd: hasEnd,\n        range: { start: startMarker, end: endMarker },\n        forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\n        forcedEndTzo: endMeta ? endMeta.forcedTzo : null\n    };\n}\nfunction pluckDateProps(raw, leftovers) {\n    var props = refineProps(raw, DATE_PROPS, {}, leftovers);\n    props.start = (props.start !== null) ? props.start : props.date;\n    delete props.date;\n    return props;\n}\nfunction pluckNonDateProps(raw, calendar, leftovers) {\n    var preLeftovers = {};\n    var props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers);\n    var ui = processUnscopedUiProps(preLeftovers, calendar, leftovers);\n    props.publicId = props.id;\n    delete props.id;\n    props.ui = ui;\n    return props;\n}\nfunction computeIsAllDayDefault(sourceId, calendar) {\n    var res = null;\n    if (sourceId) {\n        var source = calendar.state.eventSources[sourceId];\n        res = source.allDayDefault;\n    }\n    if (res == null) {\n        res = calendar.opt('allDayDefault');\n    }\n    return res;\n}\n\nvar DEF_DEFAULTS = {\n    startTime: '09:00',\n    endTime: '17:00',\n    daysOfWeek: [1, 2, 3, 4, 5],\n    rendering: 'inverse-background',\n    classNames: 'fc-nonbusiness',\n    groupId: '_businessHours' // so multiple defs get grouped\n};\n/*\nTODO: pass around as EventDefHash!!!\n*/\nfunction parseBusinessHours(input, calendar) {\n    return parseEvents(refineInputs(input), '', calendar);\n}\nfunction refineInputs(input) {\n    var rawDefs;\n    if (input === true) {\n        rawDefs = [{}]; // will get DEF_DEFAULTS verbatim\n    }\n    else if (Array.isArray(input)) {\n        // if specifying an array, every sub-definition NEEDS a day-of-week\n        rawDefs = input.filter(function (rawDef) {\n            return rawDef.daysOfWeek;\n        });\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        rawDefs = [input];\n    }\n    else { // is probably false\n        rawDefs = [];\n    }\n    rawDefs = rawDefs.map(function (rawDef) {\n        return __assign({}, DEF_DEFAULTS, rawDef);\n    });\n    return rawDefs;\n}\n\nfunction memoizeRendering(renderFunc, unrenderFunc, dependencies) {\n    if (dependencies === void 0) { dependencies = []; }\n    var dependents = [];\n    var thisContext;\n    var prevArgs;\n    function unrender() {\n        if (prevArgs) {\n            for (var _i = 0, dependents_1 = dependents; _i < dependents_1.length; _i++) {\n                var dependent = dependents_1[_i];\n                dependent.unrender();\n            }\n            if (unrenderFunc) {\n                unrenderFunc.apply(thisContext, prevArgs);\n            }\n            prevArgs = null;\n        }\n    }\n    function res() {\n        if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\n            unrender();\n            thisContext = this;\n            prevArgs = arguments;\n            renderFunc.apply(this, arguments);\n        }\n    }\n    res.dependents = dependents;\n    res.unrender = unrender;\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\n        var dependency = dependencies_1[_i];\n        dependency.dependents.push(res);\n    }\n    return res;\n}\n\nvar EMPTY_EVENT_STORE = createEmptyEventStore(); // for purecomponents. TODO: keep elsewhere\nvar Splitter = /** @class */ (function () {\n    function Splitter() {\n        this.getKeysForEventDefs = memoize(this._getKeysForEventDefs);\n        this.splitDateSelection = memoize(this._splitDateSpan);\n        this.splitEventStore = memoize(this._splitEventStore);\n        this.splitIndividualUi = memoize(this._splitIndividualUi);\n        this.splitEventDrag = memoize(this._splitInteraction);\n        this.splitEventResize = memoize(this._splitInteraction);\n        this.eventUiBuilders = {}; // TODO: typescript protection\n    }\n    Splitter.prototype.splitProps = function (props) {\n        var _this = this;\n        var keyInfos = this.getKeyInfo(props);\n        var defKeys = this.getKeysForEventDefs(props.eventStore);\n        var dateSelections = this.splitDateSelection(props.dateSelection);\n        var individualUi = this.splitIndividualUi(props.eventUiBases, defKeys); // the individual *bases*\n        var eventStores = this.splitEventStore(props.eventStore, defKeys);\n        var eventDrags = this.splitEventDrag(props.eventDrag);\n        var eventResizes = this.splitEventResize(props.eventResize);\n        var splitProps = {};\n        this.eventUiBuilders = mapHash(keyInfos, function (info, key) {\n            return _this.eventUiBuilders[key] || memoize(buildEventUiForKey);\n        });\n        for (var key in keyInfos) {\n            var keyInfo = keyInfos[key];\n            var eventStore = eventStores[key] || EMPTY_EVENT_STORE;\n            var buildEventUi = this.eventUiBuilders[key];\n            splitProps[key] = {\n                businessHours: keyInfo.businessHours || props.businessHours,\n                dateSelection: dateSelections[key] || null,\n                eventStore: eventStore,\n                eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\n                eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\n                eventDrag: eventDrags[key] || null,\n                eventResize: eventResizes[key] || null\n            };\n        }\n        return splitProps;\n    };\n    Splitter.prototype._splitDateSpan = function (dateSpan) {\n        var dateSpans = {};\n        if (dateSpan) {\n            var keys = this.getKeysForDateSpan(dateSpan);\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var key = keys_1[_i];\n                dateSpans[key] = dateSpan;\n            }\n        }\n        return dateSpans;\n    };\n    Splitter.prototype._getKeysForEventDefs = function (eventStore) {\n        var _this = this;\n        return mapHash(eventStore.defs, function (eventDef) {\n            return _this.getKeysForEventDef(eventDef);\n        });\n    };\n    Splitter.prototype._splitEventStore = function (eventStore, defKeys) {\n        var defs = eventStore.defs, instances = eventStore.instances;\n        var splitStores = {};\n        for (var defId in defs) {\n            for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n                var key = _a[_i];\n                if (!splitStores[key]) {\n                    splitStores[key] = createEmptyEventStore();\n                }\n                splitStores[key].defs[defId] = defs[defId];\n            }\n        }\n        for (var instanceId in instances) {\n            var instance = instances[instanceId];\n            for (var _b = 0, _c = defKeys[instance.defId]; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (splitStores[key]) { // must have already been created\n                    splitStores[key].instances[instanceId] = instance;\n                }\n            }\n        }\n        return splitStores;\n    };\n    Splitter.prototype._splitIndividualUi = function (eventUiBases, defKeys) {\n        var splitHashes = {};\n        for (var defId in eventUiBases) {\n            if (defId) { // not the '' key\n                for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n                    var key = _a[_i];\n                    if (!splitHashes[key]) {\n                        splitHashes[key] = {};\n                    }\n                    splitHashes[key][defId] = eventUiBases[defId];\n                }\n            }\n        }\n        return splitHashes;\n    };\n    Splitter.prototype._splitInteraction = function (interaction) {\n        var splitStates = {};\n        if (interaction) {\n            var affectedStores_1 = this._splitEventStore(interaction.affectedEvents, this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\n            );\n            // can't rely on defKeys because event data is mutated\n            var mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents);\n            var mutatedStores_1 = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId);\n            var populate = function (key) {\n                if (!splitStates[key]) {\n                    splitStates[key] = {\n                        affectedEvents: affectedStores_1[key] || EMPTY_EVENT_STORE,\n                        mutatedEvents: mutatedStores_1[key] || EMPTY_EVENT_STORE,\n                        isEvent: interaction.isEvent,\n                        origSeg: interaction.origSeg\n                    };\n                }\n            };\n            for (var key in affectedStores_1) {\n                populate(key);\n            }\n            for (var key in mutatedStores_1) {\n                populate(key);\n            }\n        }\n        return splitStates;\n    };\n    return Splitter;\n}());\nfunction buildEventUiForKey(allUi, eventUiForKey, individualUi) {\n    var baseParts = [];\n    if (allUi) {\n        baseParts.push(allUi);\n    }\n    if (eventUiForKey) {\n        baseParts.push(eventUiForKey);\n    }\n    var stuff = {\n        '': combineEventUis(baseParts)\n    };\n    if (individualUi) {\n        __assign(stuff, individualUi);\n    }\n    return stuff;\n}\n\n// Generates HTML for an anchor to another view into the calendar.\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\n// `gotoOptions` can either be a DateMarker, or an object with the form:\n// { date, type, forceOff }\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\nfunction buildGotoAnchorHtml(component, gotoOptions, attrs, innerHtml) {\n    var dateEnv = component.dateEnv;\n    var date;\n    var type;\n    var forceOff;\n    var finalOptions;\n    if (gotoOptions instanceof Date) {\n        date = gotoOptions; // a single date-like input\n    }\n    else {\n        date = gotoOptions.date;\n        type = gotoOptions.type;\n        forceOff = gotoOptions.forceOff;\n    }\n    finalOptions = {\n        date: dateEnv.formatIso(date, { omitTime: true }),\n        type: type || 'day'\n    };\n    if (typeof attrs === 'string') {\n        innerHtml = attrs;\n        attrs = null;\n    }\n    attrs = attrs ? ' ' + attrsToStr(attrs) : ''; // will have a leading space\n    innerHtml = innerHtml || '';\n    if (!forceOff && component.opt('navLinks')) {\n        return '<a' + attrs +\n            ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' +\n            innerHtml +\n            '</a>';\n    }\n    else {\n        return '<span' + attrs + '>' +\n            innerHtml +\n            '</span>';\n    }\n}\nfunction getAllDayHtml(component) {\n    return component.opt('allDayHtml') || htmlEscape(component.opt('allDayText'));\n}\n// Computes HTML classNames for a single-day element\nfunction getDayClasses(date, dateProfile, context, noThemeHighlight) {\n    var calendar = context.calendar, view = context.view, theme = context.theme, dateEnv = context.dateEnv;\n    var classes = [];\n    var todayStart;\n    var todayEnd;\n    if (!rangeContainsMarker(dateProfile.activeRange, date)) {\n        classes.push('fc-disabled-day');\n    }\n    else {\n        classes.push('fc-' + DAY_IDS[date.getUTCDay()]);\n        if (view.opt('monthMode') &&\n            dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)) {\n            classes.push('fc-other-month');\n        }\n        todayStart = startOfDay(calendar.getNow());\n        todayEnd = addDays(todayStart, 1);\n        if (date < todayStart) {\n            classes.push('fc-past');\n        }\n        else if (date >= todayEnd) {\n            classes.push('fc-future');\n        }\n        else {\n            classes.push('fc-today');\n            if (noThemeHighlight !== true) {\n                classes.push(theme.getClass('today'));\n            }\n        }\n    }\n    return classes;\n}\n\n// given a function that resolves a result asynchronously.\n// the function can either call passed-in success and failure callbacks,\n// or it can return a promise.\n// if you need to pass additional params to func, bind them first.\nfunction unpromisify(func, success, failure) {\n    // guard against success/failure callbacks being called more than once\n    // and guard against a promise AND callback being used together.\n    var isResolved = false;\n    var wrappedSuccess = function () {\n        if (!isResolved) {\n            isResolved = true;\n            success.apply(this, arguments);\n        }\n    };\n    var wrappedFailure = function () {\n        if (!isResolved) {\n            isResolved = true;\n            if (failure) {\n                failure.apply(this, arguments);\n            }\n        }\n    };\n    var res = func(wrappedSuccess, wrappedFailure);\n    if (res && typeof res.then === 'function') {\n        res.then(wrappedSuccess, wrappedFailure);\n    }\n}\n\nvar Mixin = /** @class */ (function () {\n    function Mixin() {\n    }\n    // mix into a CLASS\n    Mixin.mixInto = function (destClass) {\n        this.mixIntoObj(destClass.prototype);\n    };\n    // mix into ANY object\n    Mixin.mixIntoObj = function (destObj) {\n        var _this = this;\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n            if (!destObj[name]) { // if destination doesn't already define it\n                destObj[name] = _this.prototype[name];\n            }\n        });\n    };\n    /*\n    will override existing methods\n    TODO: remove! not used anymore\n    */\n    Mixin.mixOver = function (destClass) {\n        var _this = this;\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n            destClass.prototype[name] = _this.prototype[name];\n        });\n    };\n    return Mixin;\n}());\n\n/*\nUSAGE:\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\nin class:\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\nafter class:\n  EmitterMixin.mixInto(TheClass)\n*/\nvar EmitterMixin = /** @class */ (function (_super) {\n    __extends(EmitterMixin, _super);\n    function EmitterMixin() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EmitterMixin.prototype.on = function (type, handler) {\n        addToHash(this._handlers || (this._handlers = {}), type, handler);\n        return this; // for chaining\n    };\n    // todo: add comments\n    EmitterMixin.prototype.one = function (type, handler) {\n        addToHash(this._oneHandlers || (this._oneHandlers = {}), type, handler);\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.off = function (type, handler) {\n        if (this._handlers) {\n            removeFromHash(this._handlers, type, handler);\n        }\n        if (this._oneHandlers) {\n            removeFromHash(this._oneHandlers, type, handler);\n        }\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.trigger = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        this.triggerWith(type, this, args);\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.triggerWith = function (type, context, args) {\n        if (this._handlers) {\n            applyAll(this._handlers[type], context, args);\n        }\n        if (this._oneHandlers) {\n            applyAll(this._oneHandlers[type], context, args);\n            delete this._oneHandlers[type]; // will never fire again\n        }\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.hasHandlers = function (type) {\n        return (this._handlers && this._handlers[type] && this._handlers[type].length) ||\n            (this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length);\n    };\n    return EmitterMixin;\n}(Mixin));\nfunction addToHash(hash, type, handler) {\n    (hash[type] || (hash[type] = []))\n        .push(handler);\n}\nfunction removeFromHash(hash, type, handler) {\n    if (handler) {\n        if (hash[type]) {\n            hash[type] = hash[type].filter(function (func) {\n                return func !== handler;\n            });\n        }\n    }\n    else {\n        delete hash[type]; // remove all handler funcs for this type\n    }\n}\n\n/*\nRecords offset information for a set of elements, relative to an origin element.\nCan record the left/right OR the top/bottom OR both.\nProvides methods for querying the cache by position.\n*/\nvar PositionCache = /** @class */ (function () {\n    function PositionCache(originEl, els, isHorizontal, isVertical) {\n        this.originEl = originEl;\n        this.els = els;\n        this.isHorizontal = isHorizontal;\n        this.isVertical = isVertical;\n    }\n    // Queries the els for coordinates and stores them.\n    // Call this method before using and of the get* methods below.\n    PositionCache.prototype.build = function () {\n        var originEl = this.originEl;\n        var originClientRect = this.originClientRect =\n            originEl.getBoundingClientRect(); // relative to viewport top-left\n        if (this.isHorizontal) {\n            this.buildElHorizontals(originClientRect.left);\n        }\n        if (this.isVertical) {\n            this.buildElVerticals(originClientRect.top);\n        }\n    };\n    // Populates the left/right internal coordinate arrays\n    PositionCache.prototype.buildElHorizontals = function (originClientLeft) {\n        var lefts = [];\n        var rights = [];\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n            var el = _a[_i];\n            var rect = el.getBoundingClientRect();\n            lefts.push(rect.left - originClientLeft);\n            rights.push(rect.right - originClientLeft);\n        }\n        this.lefts = lefts;\n        this.rights = rights;\n    };\n    // Populates the top/bottom internal coordinate arrays\n    PositionCache.prototype.buildElVerticals = function (originClientTop) {\n        var tops = [];\n        var bottoms = [];\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n            var el = _a[_i];\n            var rect = el.getBoundingClientRect();\n            tops.push(rect.top - originClientTop);\n            bottoms.push(rect.bottom - originClientTop);\n        }\n        this.tops = tops;\n        this.bottoms = bottoms;\n    };\n    // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\n    // If no intersection is made, returns undefined.\n    PositionCache.prototype.leftToIndex = function (leftPosition) {\n        var lefts = this.lefts;\n        var rights = this.rights;\n        var len = lefts.length;\n        var i;\n        for (i = 0; i < len; i++) {\n            if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\n                return i;\n            }\n        }\n    };\n    // Given a top offset (from document top), returns the index of the el that it vertically intersects.\n    // If no intersection is made, returns undefined.\n    PositionCache.prototype.topToIndex = function (topPosition) {\n        var tops = this.tops;\n        var bottoms = this.bottoms;\n        var len = tops.length;\n        var i;\n        for (i = 0; i < len; i++) {\n            if (topPosition >= tops[i] && topPosition < bottoms[i]) {\n                return i;\n            }\n        }\n    };\n    // Gets the width of the element at the given index\n    PositionCache.prototype.getWidth = function (leftIndex) {\n        return this.rights[leftIndex] - this.lefts[leftIndex];\n    };\n    // Gets the height of the element at the given index\n    PositionCache.prototype.getHeight = function (topIndex) {\n        return this.bottoms[topIndex] - this.tops[topIndex];\n    };\n    return PositionCache;\n}());\n\n/*\nAn object for getting/setting scroll-related information for an element.\nInternally, this is done very differently for window versus DOM element,\nso this object serves as a common interface.\n*/\nvar ScrollController = /** @class */ (function () {\n    function ScrollController() {\n    }\n    ScrollController.prototype.getMaxScrollTop = function () {\n        return this.getScrollHeight() - this.getClientHeight();\n    };\n    ScrollController.prototype.getMaxScrollLeft = function () {\n        return this.getScrollWidth() - this.getClientWidth();\n    };\n    ScrollController.prototype.canScrollVertically = function () {\n        return this.getMaxScrollTop() > 0;\n    };\n    ScrollController.prototype.canScrollHorizontally = function () {\n        return this.getMaxScrollLeft() > 0;\n    };\n    ScrollController.prototype.canScrollUp = function () {\n        return this.getScrollTop() > 0;\n    };\n    ScrollController.prototype.canScrollDown = function () {\n        return this.getScrollTop() < this.getMaxScrollTop();\n    };\n    ScrollController.prototype.canScrollLeft = function () {\n        return this.getScrollLeft() > 0;\n    };\n    ScrollController.prototype.canScrollRight = function () {\n        return this.getScrollLeft() < this.getMaxScrollLeft();\n    };\n    return ScrollController;\n}());\nvar ElementScrollController = /** @class */ (function (_super) {\n    __extends(ElementScrollController, _super);\n    function ElementScrollController(el) {\n        var _this = _super.call(this) || this;\n        _this.el = el;\n        return _this;\n    }\n    ElementScrollController.prototype.getScrollTop = function () {\n        return this.el.scrollTop;\n    };\n    ElementScrollController.prototype.getScrollLeft = function () {\n        return this.el.scrollLeft;\n    };\n    ElementScrollController.prototype.setScrollTop = function (top) {\n        this.el.scrollTop = top;\n    };\n    ElementScrollController.prototype.setScrollLeft = function (left) {\n        this.el.scrollLeft = left;\n    };\n    ElementScrollController.prototype.getScrollWidth = function () {\n        return this.el.scrollWidth;\n    };\n    ElementScrollController.prototype.getScrollHeight = function () {\n        return this.el.scrollHeight;\n    };\n    ElementScrollController.prototype.getClientHeight = function () {\n        return this.el.clientHeight;\n    };\n    ElementScrollController.prototype.getClientWidth = function () {\n        return this.el.clientWidth;\n    };\n    return ElementScrollController;\n}(ScrollController));\nvar WindowScrollController = /** @class */ (function (_super) {\n    __extends(WindowScrollController, _super);\n    function WindowScrollController() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    WindowScrollController.prototype.getScrollTop = function () {\n        return window.pageYOffset;\n    };\n    WindowScrollController.prototype.getScrollLeft = function () {\n        return window.pageXOffset;\n    };\n    WindowScrollController.prototype.setScrollTop = function (n) {\n        window.scroll(window.pageXOffset, n);\n    };\n    WindowScrollController.prototype.setScrollLeft = function (n) {\n        window.scroll(n, window.pageYOffset);\n    };\n    WindowScrollController.prototype.getScrollWidth = function () {\n        return document.documentElement.scrollWidth;\n    };\n    WindowScrollController.prototype.getScrollHeight = function () {\n        return document.documentElement.scrollHeight;\n    };\n    WindowScrollController.prototype.getClientHeight = function () {\n        return document.documentElement.clientHeight;\n    };\n    WindowScrollController.prototype.getClientWidth = function () {\n        return document.documentElement.clientWidth;\n    };\n    return WindowScrollController;\n}(ScrollController));\n\n/*\nEmbodies a div that has potential scrollbars\n*/\nvar ScrollComponent = /** @class */ (function (_super) {\n    __extends(ScrollComponent, _super);\n    function ScrollComponent(overflowX, overflowY) {\n        var _this = _super.call(this, createElement('div', {\n            className: 'fc-scroller'\n        })) || this;\n        _this.overflowX = overflowX;\n        _this.overflowY = overflowY;\n        _this.applyOverflow();\n        return _this;\n    }\n    // sets to natural height, unlocks overflow\n    ScrollComponent.prototype.clear = function () {\n        this.setHeight('auto');\n        this.applyOverflow();\n    };\n    ScrollComponent.prototype.destroy = function () {\n        removeElement(this.el);\n    };\n    // Overflow\n    // -----------------------------------------------------------------------------------------------------------------\n    ScrollComponent.prototype.applyOverflow = function () {\n        applyStyle(this.el, {\n            overflowX: this.overflowX,\n            overflowY: this.overflowY\n        });\n    };\n    // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\n    // Useful for preserving scrollbar widths regardless of future resizes.\n    // Can pass in scrollbarWidths for optimization.\n    ScrollComponent.prototype.lockOverflow = function (scrollbarWidths) {\n        var overflowX = this.overflowX;\n        var overflowY = this.overflowY;\n        scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();\n        if (overflowX === 'auto') {\n            overflowX = (scrollbarWidths.bottom || // horizontal scrollbars?\n                this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\n            ) ? 'scroll' : 'hidden';\n        }\n        if (overflowY === 'auto') {\n            overflowY = (scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\n                this.canScrollVertically() // OR scrolling pane with massless scrollbars?\n            ) ? 'scroll' : 'hidden';\n        }\n        applyStyle(this.el, { overflowX: overflowX, overflowY: overflowY });\n    };\n    ScrollComponent.prototype.setHeight = function (height) {\n        applyStyleProp(this.el, 'height', height);\n    };\n    ScrollComponent.prototype.getScrollbarWidths = function () {\n        var edges = computeEdges(this.el);\n        return {\n            left: edges.scrollbarLeft,\n            right: edges.scrollbarRight,\n            bottom: edges.scrollbarBottom\n        };\n    };\n    return ScrollComponent;\n}(ElementScrollController));\n\nvar Theme = /** @class */ (function () {\n    function Theme(calendarOptions) {\n        this.calendarOptions = calendarOptions;\n        this.processIconOverride();\n    }\n    Theme.prototype.processIconOverride = function () {\n        if (this.iconOverrideOption) {\n            this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);\n        }\n    };\n    Theme.prototype.setIconOverride = function (iconOverrideHash) {\n        var iconClassesCopy;\n        var buttonName;\n        if (typeof iconOverrideHash === 'object' && iconOverrideHash) { // non-null object\n            iconClassesCopy = __assign({}, this.iconClasses);\n            for (buttonName in iconOverrideHash) {\n                iconClassesCopy[buttonName] = this.applyIconOverridePrefix(iconOverrideHash[buttonName]);\n            }\n            this.iconClasses = iconClassesCopy;\n        }\n        else if (iconOverrideHash === false) {\n            this.iconClasses = {};\n        }\n    };\n    Theme.prototype.applyIconOverridePrefix = function (className) {\n        var prefix = this.iconOverridePrefix;\n        if (prefix && className.indexOf(prefix) !== 0) { // if not already present\n            className = prefix + className;\n        }\n        return className;\n    };\n    Theme.prototype.getClass = function (key) {\n        return this.classes[key] || '';\n    };\n    Theme.prototype.getIconClass = function (buttonName) {\n        var className = this.iconClasses[buttonName];\n        if (className) {\n            return this.baseIconClass + ' ' + className;\n        }\n        return '';\n    };\n    Theme.prototype.getCustomButtonIconClass = function (customButtonProps) {\n        var className;\n        if (this.iconOverrideCustomButtonOption) {\n            className = customButtonProps[this.iconOverrideCustomButtonOption];\n            if (className) {\n                return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className);\n            }\n        }\n        return '';\n    };\n    return Theme;\n}());\nTheme.prototype.classes = {};\nTheme.prototype.iconClasses = {};\nTheme.prototype.baseIconClass = '';\nTheme.prototype.iconOverridePrefix = '';\n\nvar guid = 0;\nvar Component = /** @class */ (function () {\n    function Component(context, isView) {\n        // HACK to populate view at top of component instantiation call chain\n        if (isView) {\n            context.view = this;\n        }\n        this.uid = String(guid++);\n        this.context = context;\n        this.dateEnv = context.dateEnv;\n        this.theme = context.theme;\n        this.view = context.view;\n        this.calendar = context.calendar;\n        this.isRtl = this.opt('dir') === 'rtl';\n    }\n    Component.addEqualityFuncs = function (newFuncs) {\n        this.prototype.equalityFuncs = __assign({}, this.prototype.equalityFuncs, newFuncs);\n    };\n    Component.prototype.opt = function (name) {\n        return this.context.options[name];\n    };\n    Component.prototype.receiveProps = function (props) {\n        var _a = recycleProps(this.props || {}, props, this.equalityFuncs), anyChanges = _a.anyChanges, comboProps = _a.comboProps;\n        this.props = comboProps;\n        if (anyChanges) {\n            this.render(comboProps);\n        }\n    };\n    Component.prototype.render = function (props) {\n    };\n    // after destroy is called, this component won't ever be used again\n    Component.prototype.destroy = function () {\n    };\n    return Component;\n}());\nComponent.prototype.equalityFuncs = {};\n/*\nReuses old values when equal. If anything is unequal, returns newProps as-is.\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\n*/\nfunction recycleProps(oldProps, newProps, equalityFuncs) {\n    var comboProps = {}; // some old, some new\n    var anyChanges = false;\n    for (var key in newProps) {\n        if (key in oldProps && (oldProps[key] === newProps[key] ||\n            (equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key])))) {\n            // equal to old? use old prop\n            comboProps[key] = oldProps[key];\n        }\n        else {\n            comboProps[key] = newProps[key];\n            anyChanges = true;\n        }\n    }\n    for (var key in oldProps) {\n        if (!(key in newProps)) {\n            anyChanges = true;\n            break;\n        }\n    }\n    return { anyChanges: anyChanges, comboProps: comboProps };\n}\n\n/*\nPURPOSES:\n- hook up to fg, fill, and mirror renderers\n- interface for dragging and hits\n*/\nvar DateComponent = /** @class */ (function (_super) {\n    __extends(DateComponent, _super);\n    function DateComponent(context, el, isView) {\n        var _this = _super.call(this, context, isView) || this;\n        _this.el = el;\n        return _this;\n    }\n    DateComponent.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        removeElement(this.el);\n    };\n    // TODO: WHAT ABOUT (sourceSeg && sourceSeg.component.doesDragMirror)\n    //\n    // Event Drag-n-Drop Rendering (for both events and external elements)\n    // ---------------------------------------------------------------------------------------------------------------\n    /*\n    renderEventDragSegs(state: EventSegUiInteractionState) {\n      if (state) {\n        let { isEvent, segs, sourceSeg } = state\n  \n        if (this.eventRenderer) {\n          this.eventRenderer.hideByHash(state.affectedInstances)\n        }\n  \n        // if the user is dragging something that is considered an event with real event data,\n        // and this component likes to do drag mirrors OR the component where the seg came from\n        // likes to do drag mirrors, then render a drag mirror.\n        if (isEvent && (this.doesDragMirror || sourceSeg && sourceSeg.component.doesDragMirror)) {\n          if (this.mirrorRenderer) {\n            this.mirrorRenderer.renderSegs(segs, { isDragging: true, sourceSeg })\n          }\n        }\n  \n        // if it would be impossible to render a drag mirror OR this component likes to render\n        // highlights, then render a highlight.\n        if (!isEvent || this.doesDragHighlight) {\n          if (this.fillRenderer) {\n            this.fillRenderer.renderSegs('highlight', segs)\n          }\n        }\n      }\n    }\n    */\n    // Hit System\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.buildPositionCaches = function () {\n    };\n    DateComponent.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n        return null; // this should be abstract\n    };\n    // Validation\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.isInteractionValid = function (interaction) {\n        var calendar = this.calendar;\n        var dateProfile = this.props.dateProfile; // HACK\n        var instances = interaction.mutatedEvents.instances;\n        if (dateProfile) { // HACK for DayTile\n            for (var instanceId in instances) {\n                if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\n                    return false;\n                }\n            }\n        }\n        return isInteractionValid(interaction, calendar);\n    };\n    DateComponent.prototype.isDateSelectionValid = function (selection) {\n        var dateProfile = this.props.dateProfile; // HACK\n        if (dateProfile && // HACK for DayTile\n            !rangeContainsRange(dateProfile.validRange, selection.range)) {\n            return false;\n        }\n        return isDateSelectionValid(selection, this.calendar);\n    };\n    // Triggering\n    // -----------------------------------------------------------------------------------------------------------------\n    // TODO: move to Calendar\n    DateComponent.prototype.publiclyTrigger = function (name, args) {\n        var calendar = this.calendar;\n        return calendar.publiclyTrigger(name, args);\n    };\n    DateComponent.prototype.publiclyTriggerAfterSizing = function (name, args) {\n        var calendar = this.calendar;\n        return calendar.publiclyTriggerAfterSizing(name, args);\n    };\n    DateComponent.prototype.hasPublicHandlers = function (name) {\n        var calendar = this.calendar;\n        return calendar.hasPublicHandlers(name);\n    };\n    DateComponent.prototype.triggerRenderedSegs = function (segs, isMirrors) {\n        var calendar = this.calendar;\n        if (this.hasPublicHandlers('eventPositioned')) {\n            for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n                var seg = segs_1[_i];\n                this.publiclyTriggerAfterSizing('eventPositioned', [\n                    {\n                        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                        isMirror: isMirrors,\n                        isStart: seg.isStart,\n                        isEnd: seg.isEnd,\n                        el: seg.el,\n                        view: this // safe to cast because this method is only called on context.view\n                    }\n                ]);\n            }\n        }\n        if (!calendar.state.loadingLevel) { // avoid initial empty state while pending\n            calendar.afterSizingTriggers._eventsPositioned = [null]; // fire once\n        }\n    };\n    DateComponent.prototype.triggerWillRemoveSegs = function (segs, isMirrors) {\n        var calendar = this.calendar;\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n            var seg = segs_2[_i];\n            calendar.trigger('eventElRemove', seg.el);\n        }\n        if (this.hasPublicHandlers('eventDestroy')) {\n            for (var _a = 0, segs_3 = segs; _a < segs_3.length; _a++) {\n                var seg = segs_3[_a];\n                this.publiclyTrigger('eventDestroy', [\n                    {\n                        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                        isMirror: isMirrors,\n                        el: seg.el,\n                        view: this // safe to cast because this method is only called on context.view\n                    }\n                ]);\n            }\n        }\n    };\n    // Pointer Interaction Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.isValidSegDownEl = function (el) {\n        return !this.props.eventDrag && // HACK\n            !this.props.eventResize && // HACK\n            !elementClosest(el, '.fc-mirror') &&\n            (this.isPopover() || !this.isInPopover(el));\n        // ^above line ensures we don't detect a seg interaction within a nested component.\n        // it's a HACK because it only supports a popover as the nested component.\n    };\n    DateComponent.prototype.isValidDateDownEl = function (el) {\n        var segEl = elementClosest(el, this.fgSegSelector);\n        return (!segEl || segEl.classList.contains('fc-mirror')) &&\n            !elementClosest(el, '.fc-more') && // a \"more..\" link\n            !elementClosest(el, 'a[data-goto]') && // a clickable nav link\n            !this.isInPopover(el);\n    };\n    DateComponent.prototype.isPopover = function () {\n        return this.el.classList.contains('fc-popover');\n    };\n    DateComponent.prototype.isInPopover = function (el) {\n        return Boolean(elementClosest(el, '.fc-popover'));\n    };\n    return DateComponent;\n}(Component));\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *';\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)';\n\nvar uid$1 = 0;\nfunction createPlugin(input) {\n    return {\n        id: String(uid$1++),\n        deps: input.deps || [],\n        reducers: input.reducers || [],\n        eventDefParsers: input.eventDefParsers || [],\n        isDraggableTransformers: input.isDraggableTransformers || [],\n        eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n        eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n        dateSelectionTransformers: input.dateSelectionTransformers || [],\n        datePointTransforms: input.datePointTransforms || [],\n        dateSpanTransforms: input.dateSpanTransforms || [],\n        views: input.views || {},\n        viewPropsTransformers: input.viewPropsTransformers || [],\n        isPropsValid: input.isPropsValid || null,\n        externalDefTransforms: input.externalDefTransforms || [],\n        eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\n        viewContainerModifiers: input.viewContainerModifiers || [],\n        eventDropTransformers: input.eventDropTransformers || [],\n        componentInteractions: input.componentInteractions || [],\n        calendarInteractions: input.calendarInteractions || [],\n        themeClasses: input.themeClasses || {},\n        eventSourceDefs: input.eventSourceDefs || [],\n        cmdFormatter: input.cmdFormatter,\n        recurringTypes: input.recurringTypes || [],\n        namedTimeZonedImpl: input.namedTimeZonedImpl,\n        defaultView: input.defaultView || '',\n        elementDraggingImpl: input.elementDraggingImpl,\n        optionChangeHandlers: input.optionChangeHandlers || {}\n    };\n}\nvar PluginSystem = /** @class */ (function () {\n    function PluginSystem() {\n        this.hooks = {\n            reducers: [],\n            eventDefParsers: [],\n            isDraggableTransformers: [],\n            eventDragMutationMassagers: [],\n            eventDefMutationAppliers: [],\n            dateSelectionTransformers: [],\n            datePointTransforms: [],\n            dateSpanTransforms: [],\n            views: {},\n            viewPropsTransformers: [],\n            isPropsValid: null,\n            externalDefTransforms: [],\n            eventResizeJoinTransforms: [],\n            viewContainerModifiers: [],\n            eventDropTransformers: [],\n            componentInteractions: [],\n            calendarInteractions: [],\n            themeClasses: {},\n            eventSourceDefs: [],\n            cmdFormatter: null,\n            recurringTypes: [],\n            namedTimeZonedImpl: null,\n            defaultView: '',\n            elementDraggingImpl: null,\n            optionChangeHandlers: {}\n        };\n        this.addedHash = {};\n    }\n    PluginSystem.prototype.add = function (plugin) {\n        if (!this.addedHash[plugin.id]) {\n            this.addedHash[plugin.id] = true;\n            for (var _i = 0, _a = plugin.deps; _i < _a.length; _i++) {\n                var dep = _a[_i];\n                this.add(dep);\n            }\n            this.hooks = combineHooks(this.hooks, plugin);\n        }\n    };\n    return PluginSystem;\n}());\nfunction combineHooks(hooks0, hooks1) {\n    return {\n        reducers: hooks0.reducers.concat(hooks1.reducers),\n        eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\n        isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n        eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n        eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n        dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n        datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n        dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n        views: __assign({}, hooks0.views, hooks1.views),\n        viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n        isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n        externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n        eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\n        viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\n        eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n        calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n        componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n        themeClasses: __assign({}, hooks0.themeClasses, hooks1.themeClasses),\n        eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n        cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n        recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n        namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n        defaultView: hooks0.defaultView || hooks1.defaultView,\n        elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n        optionChangeHandlers: __assign({}, hooks0.optionChangeHandlers, hooks1.optionChangeHandlers)\n    };\n}\n\nvar eventSourceDef = {\n    ignoreRange: true,\n    parseMeta: function (raw) {\n        if (Array.isArray(raw)) { // short form\n            return raw;\n        }\n        else if (Array.isArray(raw.events)) {\n            return raw.events;\n        }\n        return null;\n    },\n    fetch: function (arg, success) {\n        success({\n            rawEvents: arg.eventSource.meta\n        });\n    }\n};\nvar ArrayEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef]\n});\n\nvar eventSourceDef$1 = {\n    parseMeta: function (raw) {\n        if (typeof raw === 'function') { // short form\n            return raw;\n        }\n        else if (typeof raw.events === 'function') {\n            return raw.events;\n        }\n        return null;\n    },\n    fetch: function (arg, success, failure) {\n        var dateEnv = arg.calendar.dateEnv;\n        var func = arg.eventSource.meta;\n        unpromisify(func.bind(null, {\n            start: dateEnv.toDate(arg.range.start),\n            end: dateEnv.toDate(arg.range.end),\n            startStr: dateEnv.formatIso(arg.range.start),\n            endStr: dateEnv.formatIso(arg.range.end),\n            timeZone: dateEnv.timeZone\n        }), function (rawEvents) {\n            success({ rawEvents: rawEvents }); // needs an object response\n        }, failure // send errorObj directly to failure callback\n        );\n    }\n};\nvar FuncEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef$1]\n});\n\nfunction requestJson(method, url, params, successCallback, failureCallback) {\n    method = method.toUpperCase();\n    var body = null;\n    if (method === 'GET') {\n        url = injectQueryStringParams(url, params);\n    }\n    else {\n        body = encodeParams(params);\n    }\n    var xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    if (method !== 'GET') {\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n    }\n    xhr.onload = function () {\n        if (xhr.status >= 200 && xhr.status < 400) {\n            try {\n                var res = JSON.parse(xhr.responseText);\n                successCallback(res, xhr);\n            }\n            catch (err) {\n                failureCallback('Failure parsing JSON', xhr);\n            }\n        }\n        else {\n            failureCallback('Request failed', xhr);\n        }\n    };\n    xhr.onerror = function () {\n        failureCallback('Request failed', xhr);\n    };\n    xhr.send(body);\n}\nfunction injectQueryStringParams(url, params) {\n    return url +\n        (url.indexOf('?') === -1 ? '?' : '&') +\n        encodeParams(params);\n}\nfunction encodeParams(params) {\n    var parts = [];\n    for (var key in params) {\n        parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));\n    }\n    return parts.join('&');\n}\n\nvar eventSourceDef$2 = {\n    parseMeta: function (raw) {\n        if (typeof raw === 'string') { // short form\n            raw = { url: raw };\n        }\n        else if (!raw || typeof raw !== 'object' || !raw.url) {\n            return null;\n        }\n        return {\n            url: raw.url,\n            method: (raw.method || 'GET').toUpperCase(),\n            extraParams: raw.extraParams,\n            startParam: raw.startParam,\n            endParam: raw.endParam,\n            timeZoneParam: raw.timeZoneParam\n        };\n    },\n    fetch: function (arg, success, failure) {\n        var meta = arg.eventSource.meta;\n        var requestParams = buildRequestParams(meta, arg.range, arg.calendar);\n        requestJson(meta.method, meta.url, requestParams, function (rawEvents, xhr) {\n            success({ rawEvents: rawEvents, xhr: xhr });\n        }, function (errorMessage, xhr) {\n            failure({ message: errorMessage, xhr: xhr });\n        });\n    }\n};\nvar JsonFeedEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef$2]\n});\nfunction buildRequestParams(meta, range, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var startParam;\n    var endParam;\n    var timeZoneParam;\n    var customRequestParams;\n    var params = {};\n    startParam = meta.startParam;\n    if (startParam == null) {\n        startParam = calendar.opt('startParam');\n    }\n    endParam = meta.endParam;\n    if (endParam == null) {\n        endParam = calendar.opt('endParam');\n    }\n    timeZoneParam = meta.timeZoneParam;\n    if (timeZoneParam == null) {\n        timeZoneParam = calendar.opt('timeZoneParam');\n    }\n    // retrieve any outbound GET/POST data from the options\n    if (typeof meta.extraParams === 'function') {\n        // supplied as a function that returns a key/value object\n        customRequestParams = meta.extraParams();\n    }\n    else {\n        // probably supplied as a straight key/value object\n        customRequestParams = meta.extraParams || {};\n    }\n    __assign(params, customRequestParams);\n    params[startParam] = dateEnv.formatIso(range.start);\n    params[endParam] = dateEnv.formatIso(range.end);\n    if (dateEnv.timeZone !== 'local') {\n        params[timeZoneParam] = dateEnv.timeZone;\n    }\n    return params;\n}\n\nvar recurring = {\n    parse: function (rawEvent, leftoverProps, dateEnv) {\n        var createMarker = dateEnv.createMarker.bind(dateEnv);\n        var processors = {\n            daysOfWeek: null,\n            startTime: createDuration,\n            endTime: createDuration,\n            startRecur: createMarker,\n            endRecur: createMarker\n        };\n        var props = refineProps(rawEvent, processors, {}, leftoverProps);\n        var anyValid = false;\n        for (var propName in props) {\n            if (props[propName] != null) {\n                anyValid = true;\n                break;\n            }\n        }\n        if (anyValid) {\n            var duration = null;\n            if ('duration' in leftoverProps) {\n                duration = createDuration(leftoverProps.duration);\n                delete leftoverProps.duration;\n            }\n            if (!duration && props.startTime && props.endTime) {\n                duration = subtractDurations(props.endTime, props.startTime);\n            }\n            return {\n                allDayGuess: Boolean(!props.startTime && !props.endTime),\n                duration: duration,\n                typeData: props // doesn't need endTime anymore but oh well\n            };\n        }\n        return null;\n    },\n    expand: function (typeData, framingRange, dateEnv) {\n        var clippedFramingRange = intersectRanges(framingRange, { start: typeData.startRecur, end: typeData.endRecur });\n        if (clippedFramingRange) {\n            return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n        }\n        else {\n            return [];\n        }\n    }\n};\nvar SimpleRecurrencePlugin = createPlugin({\n    recurringTypes: [recurring]\n});\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n    var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n    var dayMarker = startOfDay(framingRange.start);\n    var endMarker = framingRange.end;\n    var instanceStarts = [];\n    while (dayMarker < endMarker) {\n        var instanceStart \n        // if everyday, or this particular day-of-week\n        = void 0;\n        // if everyday, or this particular day-of-week\n        if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n            if (startTime) {\n                instanceStart = dateEnv.add(dayMarker, startTime);\n            }\n            else {\n                instanceStart = dayMarker;\n            }\n            instanceStarts.push(instanceStart);\n        }\n        dayMarker = addDays(dayMarker, 1);\n    }\n    return instanceStarts;\n}\n\nvar DefaultOptionChangeHandlers = createPlugin({\n    optionChangeHandlers: {\n        events: function (events, calendar, deepEqual) {\n            handleEventSources([events], calendar, deepEqual);\n        },\n        eventSources: handleEventSources,\n        plugins: handlePlugins\n    }\n});\nfunction handleEventSources(inputs, calendar, deepEqual) {\n    var unfoundSources = hashValuesToArray(calendar.state.eventSources);\n    var newInputs = [];\n    for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n        var input = inputs_1[_i];\n        var inputFound = false;\n        for (var i = 0; i < unfoundSources.length; i++) {\n            if (deepEqual(unfoundSources[i]._raw, input)) {\n                unfoundSources.splice(i, 1); // delete\n                inputFound = true;\n                break;\n            }\n        }\n        if (!inputFound) {\n            newInputs.push(input);\n        }\n    }\n    for (var _a = 0, unfoundSources_1 = unfoundSources; _a < unfoundSources_1.length; _a++) {\n        var unfoundSource = unfoundSources_1[_a];\n        calendar.dispatch({\n            type: 'REMOVE_EVENT_SOURCE',\n            sourceId: unfoundSource.sourceId\n        });\n    }\n    for (var _b = 0, newInputs_1 = newInputs; _b < newInputs_1.length; _b++) {\n        var newInput = newInputs_1[_b];\n        calendar.addEventSource(newInput);\n    }\n}\n// shortcoming: won't remove plugins\nfunction handlePlugins(inputs, calendar) {\n    calendar.addPluginInputs(inputs); // will gracefully handle duplicates\n}\n\nvar config = {}; // TODO: make these options\nvar globalDefaults = {\n    defaultRangeSeparator: ' - ',\n    titleRangeSeparator: ' \\u2013 ',\n    defaultTimedEventDuration: '01:00:00',\n    defaultAllDayEventDuration: { day: 1 },\n    forceEventDuration: false,\n    nextDayThreshold: '00:00:00',\n    // display\n    columnHeader: true,\n    defaultView: '',\n    aspectRatio: 1.35,\n    header: {\n        left: 'title',\n        center: '',\n        right: 'today prev,next'\n    },\n    weekends: true,\n    weekNumbers: false,\n    weekNumberCalculation: 'local',\n    editable: false,\n    // nowIndicator: false,\n    scrollTime: '06:00:00',\n    minTime: '00:00:00',\n    maxTime: '24:00:00',\n    showNonCurrentDates: true,\n    // event ajax\n    lazyFetching: true,\n    startParam: 'start',\n    endParam: 'end',\n    timeZoneParam: 'timeZone',\n    timeZone: 'local',\n    // allDayDefault: undefined,\n    // locale\n    locales: [],\n    locale: '',\n    // dir: will get this from the default locale\n    // buttonIcons: null,\n    // allows setting a min-height to the event segment to prevent short events overlapping each other\n    timeGridEventMinHeight: 0,\n    themeSystem: 'standard',\n    // eventResizableFromStart: false,\n    dragRevertDuration: 500,\n    dragScroll: true,\n    allDayMaintainDuration: false,\n    // selectable: false,\n    unselectAuto: true,\n    // selectMinDistance: 0,\n    dropAccept: '*',\n    eventOrder: 'start,-duration,allDay,title',\n    // ^ if start tie, longer events go before shorter. final tie-breaker is title text\n    // rerenderDelay: null,\n    eventLimit: false,\n    eventLimitClick: 'popover',\n    dayPopoverFormat: { month: 'long', day: 'numeric', year: 'numeric' },\n    handleWindowResize: true,\n    windowResizeDelay: 100,\n    longPressDelay: 1000,\n    eventDragMinDistance: 5 // only applies to mouse\n};\nvar rtlDefaults = {\n    header: {\n        left: 'next,prev today',\n        center: '',\n        right: 'title'\n    },\n    buttonIcons: {\n        // TODO: make RTL support the responibility of the theme\n        prev: 'fc-icon-chevron-right',\n        next: 'fc-icon-chevron-left',\n        prevYear: 'fc-icon-chevrons-right',\n        nextYear: 'fc-icon-chevrons-left'\n    }\n};\nvar complexOptions = [\n    'header',\n    'footer',\n    'buttonText',\n    'buttonIcons'\n];\n// Merges an array of option objects into a single object\nfunction mergeOptions(optionObjs) {\n    return mergeProps(optionObjs, complexOptions);\n}\n// TODO: move this stuff to a \"plugin\"-related file...\nvar INTERNAL_PLUGINS = [\n    ArrayEventSourcePlugin,\n    FuncEventSourcePlugin,\n    JsonFeedEventSourcePlugin,\n    SimpleRecurrencePlugin,\n    DefaultOptionChangeHandlers\n];\nfunction refinePluginDefs(pluginInputs) {\n    var plugins = [];\n    for (var _i = 0, pluginInputs_1 = pluginInputs; _i < pluginInputs_1.length; _i++) {\n        var pluginInput = pluginInputs_1[_i];\n        if (typeof pluginInput === 'string') {\n            var globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput);\n            if (!window[globalName]) {\n                console.warn('Plugin file not loaded for ' + pluginInput);\n            }\n            else {\n                plugins.push(window[globalName].default); // is an ES6 module\n            }\n        }\n        else {\n            plugins.push(pluginInput);\n        }\n    }\n    return INTERNAL_PLUGINS.concat(plugins);\n}\n\nvar RAW_EN_LOCALE = {\n    code: 'en',\n    week: {\n        dow: 0,\n        doy: 4 // 4 days need to be within the year to be considered the first week\n    },\n    dir: 'ltr',\n    buttonText: {\n        prev: 'prev',\n        next: 'next',\n        prevYear: 'prev year',\n        nextYear: 'next year',\n        year: 'year',\n        today: 'today',\n        month: 'month',\n        week: 'week',\n        day: 'day',\n        list: 'list'\n    },\n    weekLabel: 'W',\n    allDayText: 'all-day',\n    eventLimitText: 'more',\n    noEventsMessage: 'No events to display'\n};\nfunction parseRawLocales(explicitRawLocales) {\n    var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n    var globalArray = window['FullCalendarLocalesAll'] || []; // from locales-all.js\n    var globalObject = window['FullCalendarLocales'] || {}; // from locales/*.js. keys are meaningless\n    var allRawLocales = globalArray.concat(// globalArray is low prio\n    hashValuesToArray(globalObject), // medium prio\n    explicitRawLocales // highest prio\n    );\n    var rawLocaleMap = {\n        en: RAW_EN_LOCALE // necessary?\n    };\n    for (var _i = 0, allRawLocales_1 = allRawLocales; _i < allRawLocales_1.length; _i++) {\n        var rawLocale = allRawLocales_1[_i];\n        rawLocaleMap[rawLocale.code] = rawLocale;\n    }\n    return {\n        map: rawLocaleMap,\n        defaultCode: defaultCode\n    };\n}\nfunction buildLocale(inputSingular, available) {\n    if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n        return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n    }\n    else {\n        return queryLocale(inputSingular, available);\n    }\n}\nfunction queryLocale(codeArg, available) {\n    var codes = [].concat(codeArg || []); // will convert to array\n    var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n    return parseLocale(codeArg, codes, raw);\n}\nfunction queryRawLocale(codes, available) {\n    for (var i = 0; i < codes.length; i++) {\n        var parts = codes[i].toLocaleLowerCase().split('-');\n        for (var j = parts.length; j > 0; j--) {\n            var simpleId = parts.slice(0, j).join('-');\n            if (available[simpleId]) {\n                return available[simpleId];\n            }\n        }\n    }\n    return null;\n}\nfunction parseLocale(codeArg, codes, raw) {\n    var merged = mergeProps([RAW_EN_LOCALE, raw], ['buttonText']);\n    delete merged.code; // don't want this part of the options\n    var week = merged.week;\n    delete merged.week;\n    return {\n        codeArg: codeArg,\n        codes: codes,\n        week: week,\n        simpleNumberFormat: new Intl.NumberFormat(codeArg),\n        options: merged\n    };\n}\n\nvar OptionsManager = /** @class */ (function () {\n    function OptionsManager(overrides) {\n        this.overrides = __assign({}, overrides); // make a copy\n        this.dynamicOverrides = {};\n        this.compute();\n    }\n    OptionsManager.prototype.mutate = function (updates, removals, isDynamic) {\n        var overrideHash = isDynamic ? this.dynamicOverrides : this.overrides;\n        __assign(overrideHash, updates);\n        for (var _i = 0, removals_1 = removals; _i < removals_1.length; _i++) {\n            var propName = removals_1[_i];\n            delete overrideHash[propName];\n        }\n        this.compute();\n    };\n    // Computes the flattened options hash for the calendar and assigns to `this.options`.\n    // Assumes this.overrides and this.dynamicOverrides have already been initialized.\n    OptionsManager.prototype.compute = function () {\n        // TODO: not a very efficient system\n        var locales = firstDefined(// explicit locale option given?\n        this.dynamicOverrides.locales, this.overrides.locales, globalDefaults.locales);\n        var locale = firstDefined(// explicit locales option given?\n        this.dynamicOverrides.locale, this.overrides.locale, globalDefaults.locale);\n        var available = parseRawLocales(locales);\n        var localeDefaults = buildLocale(locale || available.defaultCode, available.map).options;\n        var dir = firstDefined(// based on options computed so far, is direction RTL?\n        this.dynamicOverrides.dir, this.overrides.dir, localeDefaults.dir);\n        var dirDefaults = dir === 'rtl' ? rtlDefaults : {};\n        this.dirDefaults = dirDefaults;\n        this.localeDefaults = localeDefaults;\n        this.computed = mergeOptions([\n            globalDefaults,\n            dirDefaults,\n            localeDefaults,\n            this.overrides,\n            this.dynamicOverrides\n        ]);\n    };\n    return OptionsManager;\n}());\n\nvar calendarSystemClassMap = {};\nfunction registerCalendarSystem(name, theClass) {\n    calendarSystemClassMap[name] = theClass;\n}\nfunction createCalendarSystem(name) {\n    return new calendarSystemClassMap[name]();\n}\nvar GregorianCalendarSystem = /** @class */ (function () {\n    function GregorianCalendarSystem() {\n    }\n    GregorianCalendarSystem.prototype.getMarkerYear = function (d) {\n        return d.getUTCFullYear();\n    };\n    GregorianCalendarSystem.prototype.getMarkerMonth = function (d) {\n        return d.getUTCMonth();\n    };\n    GregorianCalendarSystem.prototype.getMarkerDay = function (d) {\n        return d.getUTCDate();\n    };\n    GregorianCalendarSystem.prototype.arrayToMarker = function (arr) {\n        return arrayToUtcDate(arr);\n    };\n    GregorianCalendarSystem.prototype.markerToArray = function (marker) {\n        return dateToUtcArray(marker);\n    };\n    return GregorianCalendarSystem;\n}());\nregisterCalendarSystem('gregory', GregorianCalendarSystem);\n\nvar ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/;\nfunction parse(str) {\n    var m = ISO_RE.exec(str);\n    if (m) {\n        var marker = new Date(Date.UTC(Number(m[1]), m[3] ? Number(m[3]) - 1 : 0, Number(m[5] || 1), Number(m[7] || 0), Number(m[8] || 0), Number(m[10] || 0), m[12] ? Number('0.' + m[12]) * 1000 : 0));\n        if (isValidDate(marker)) {\n            var timeZoneOffset = null;\n            if (m[13]) {\n                timeZoneOffset = (m[15] === '-' ? -1 : 1) * (Number(m[16] || 0) * 60 +\n                    Number(m[18] || 0));\n            }\n            return {\n                marker: marker,\n                isTimeUnspecified: !m[6],\n                timeZoneOffset: timeZoneOffset\n            };\n        }\n    }\n    return null;\n}\n\nvar DateEnv = /** @class */ (function () {\n    function DateEnv(settings) {\n        var timeZone = this.timeZone = settings.timeZone;\n        var isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC';\n        if (settings.namedTimeZoneImpl && isNamedTimeZone) {\n            this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone);\n        }\n        this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl);\n        this.calendarSystem = createCalendarSystem(settings.calendarSystem);\n        this.locale = settings.locale;\n        this.weekDow = settings.locale.week.dow;\n        this.weekDoy = settings.locale.week.doy;\n        if (settings.weekNumberCalculation === 'ISO') {\n            this.weekDow = 1;\n            this.weekDoy = 4;\n        }\n        if (typeof settings.firstDay === 'number') {\n            this.weekDow = settings.firstDay;\n        }\n        if (typeof settings.weekNumberCalculation === 'function') {\n            this.weekNumberFunc = settings.weekNumberCalculation;\n        }\n        this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel;\n        this.cmdFormatter = settings.cmdFormatter;\n    }\n    // Creating / Parsing\n    DateEnv.prototype.createMarker = function (input) {\n        var meta = this.createMarkerMeta(input);\n        if (meta === null) {\n            return null;\n        }\n        return meta.marker;\n    };\n    DateEnv.prototype.createNowMarker = function () {\n        if (this.canComputeOffset) {\n            return this.timestampToMarker(new Date().valueOf());\n        }\n        else {\n            // if we can't compute the current date val for a timezone,\n            // better to give the current local date vals than UTC\n            return arrayToUtcDate(dateToLocalArray(new Date()));\n        }\n    };\n    DateEnv.prototype.createMarkerMeta = function (input) {\n        if (typeof input === 'string') {\n            return this.parse(input);\n        }\n        var marker = null;\n        if (typeof input === 'number') {\n            marker = this.timestampToMarker(input);\n        }\n        else if (input instanceof Date) {\n            input = input.valueOf();\n            if (!isNaN(input)) {\n                marker = this.timestampToMarker(input);\n            }\n        }\n        else if (Array.isArray(input)) {\n            marker = arrayToUtcDate(input);\n        }\n        if (marker === null || !isValidDate(marker)) {\n            return null;\n        }\n        return { marker: marker, isTimeUnspecified: false, forcedTzo: null };\n    };\n    DateEnv.prototype.parse = function (s) {\n        var parts = parse(s);\n        if (parts === null) {\n            return null;\n        }\n        var marker = parts.marker;\n        var forcedTzo = null;\n        if (parts.timeZoneOffset !== null) {\n            if (this.canComputeOffset) {\n                marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000);\n            }\n            else {\n                forcedTzo = parts.timeZoneOffset;\n            }\n        }\n        return { marker: marker, isTimeUnspecified: parts.isTimeUnspecified, forcedTzo: forcedTzo };\n    };\n    // Accessors\n    DateEnv.prototype.getYear = function (marker) {\n        return this.calendarSystem.getMarkerYear(marker);\n    };\n    DateEnv.prototype.getMonth = function (marker) {\n        return this.calendarSystem.getMarkerMonth(marker);\n    };\n    // Adding / Subtracting\n    DateEnv.prototype.add = function (marker, dur) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] += dur.years;\n        a[1] += dur.months;\n        a[2] += dur.days;\n        a[6] += dur.milliseconds;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.subtract = function (marker, dur) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] -= dur.years;\n        a[1] -= dur.months;\n        a[2] -= dur.days;\n        a[6] -= dur.milliseconds;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.addYears = function (marker, n) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] += n;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.addMonths = function (marker, n) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[1] += n;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    // Diffing Whole Units\n    DateEnv.prototype.diffWholeYears = function (m0, m1) {\n        var calendarSystem = this.calendarSystem;\n        if (timeAsMs(m0) === timeAsMs(m1) &&\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) &&\n            calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)) {\n            return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0);\n        }\n        return null;\n    };\n    DateEnv.prototype.diffWholeMonths = function (m0, m1) {\n        var calendarSystem = this.calendarSystem;\n        if (timeAsMs(m0) === timeAsMs(m1) &&\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)) {\n            return (calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0)) +\n                (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12;\n        }\n        return null;\n    };\n    // Range / Duration\n    DateEnv.prototype.greatestWholeUnit = function (m0, m1) {\n        var n = this.diffWholeYears(m0, m1);\n        if (n !== null) {\n            return { unit: 'year', value: n };\n        }\n        n = this.diffWholeMonths(m0, m1);\n        if (n !== null) {\n            return { unit: 'month', value: n };\n        }\n        n = diffWholeWeeks(m0, m1);\n        if (n !== null) {\n            return { unit: 'week', value: n };\n        }\n        n = diffWholeDays(m0, m1);\n        if (n !== null) {\n            return { unit: 'day', value: n };\n        }\n        n = diffHours(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'hour', value: n };\n        }\n        n = diffMinutes(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'minute', value: n };\n        }\n        n = diffSeconds(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'second', value: n };\n        }\n        return { unit: 'millisecond', value: m1.valueOf() - m0.valueOf() };\n    };\n    DateEnv.prototype.countDurationsBetween = function (m0, m1, d) {\n        // TODO: can use greatestWholeUnit\n        var diff;\n        if (d.years) {\n            diff = this.diffWholeYears(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughYears(d);\n            }\n        }\n        if (d.months) {\n            diff = this.diffWholeMonths(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughMonths(d);\n            }\n        }\n        if (d.days) {\n            diff = diffWholeDays(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughDays(d);\n            }\n        }\n        return (m1.valueOf() - m0.valueOf()) / asRoughMs(d);\n    };\n    // Start-Of\n    DateEnv.prototype.startOf = function (m, unit) {\n        if (unit === 'year') {\n            return this.startOfYear(m);\n        }\n        else if (unit === 'month') {\n            return this.startOfMonth(m);\n        }\n        else if (unit === 'week') {\n            return this.startOfWeek(m);\n        }\n        else if (unit === 'day') {\n            return startOfDay(m);\n        }\n        else if (unit === 'hour') {\n            return startOfHour(m);\n        }\n        else if (unit === 'minute') {\n            return startOfMinute(m);\n        }\n        else if (unit === 'second') {\n            return startOfSecond(m);\n        }\n    };\n    DateEnv.prototype.startOfYear = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m)\n        ]);\n    };\n    DateEnv.prototype.startOfMonth = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m),\n            this.calendarSystem.getMarkerMonth(m)\n        ]);\n    };\n    DateEnv.prototype.startOfWeek = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m),\n            this.calendarSystem.getMarkerMonth(m),\n            m.getUTCDate() - ((m.getUTCDay() - this.weekDow + 7) % 7)\n        ]);\n    };\n    // Week Number\n    DateEnv.prototype.computeWeekNumber = function (marker) {\n        if (this.weekNumberFunc) {\n            return this.weekNumberFunc(this.toDate(marker));\n        }\n        else {\n            return weekOfYear(marker, this.weekDow, this.weekDoy);\n        }\n    };\n    // TODO: choke on timeZoneName: long\n    DateEnv.prototype.format = function (marker, formatter, dateOptions) {\n        if (dateOptions === void 0) { dateOptions = {}; }\n        return formatter.format({\n            marker: marker,\n            timeZoneOffset: dateOptions.forcedTzo != null ?\n                dateOptions.forcedTzo :\n                this.offsetForMarker(marker)\n        }, this);\n    };\n    DateEnv.prototype.formatRange = function (start, end, formatter, dateOptions) {\n        if (dateOptions === void 0) { dateOptions = {}; }\n        if (dateOptions.isEndExclusive) {\n            end = addMs(end, -1);\n        }\n        return formatter.formatRange({\n            marker: start,\n            timeZoneOffset: dateOptions.forcedStartTzo != null ?\n                dateOptions.forcedStartTzo :\n                this.offsetForMarker(start)\n        }, {\n            marker: end,\n            timeZoneOffset: dateOptions.forcedEndTzo != null ?\n                dateOptions.forcedEndTzo :\n                this.offsetForMarker(end)\n        }, this);\n    };\n    DateEnv.prototype.formatIso = function (marker, extraOptions) {\n        if (extraOptions === void 0) { extraOptions = {}; }\n        var timeZoneOffset = null;\n        if (!extraOptions.omitTimeZoneOffset) {\n            if (extraOptions.forcedTzo != null) {\n                timeZoneOffset = extraOptions.forcedTzo;\n            }\n            else {\n                timeZoneOffset = this.offsetForMarker(marker);\n            }\n        }\n        return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime);\n    };\n    // TimeZone\n    DateEnv.prototype.timestampToMarker = function (ms) {\n        if (this.timeZone === 'local') {\n            return arrayToUtcDate(dateToLocalArray(new Date(ms)));\n        }\n        else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\n            return new Date(ms);\n        }\n        else {\n            return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));\n        }\n    };\n    DateEnv.prototype.offsetForMarker = function (m) {\n        if (this.timeZone === 'local') {\n            return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset(); // convert \"inverse\" offset to \"normal\" offset\n        }\n        else if (this.timeZone === 'UTC') {\n            return 0;\n        }\n        else if (this.namedTimeZoneImpl) {\n            return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));\n        }\n        return null;\n    };\n    // Conversion\n    DateEnv.prototype.toDate = function (m, forcedTzo) {\n        if (this.timeZone === 'local') {\n            return arrayToLocalDate(dateToUtcArray(m));\n        }\n        else if (this.timeZone === 'UTC') {\n            return new Date(m.valueOf()); // make sure it's a copy\n        }\n        else if (!this.namedTimeZoneImpl) {\n            return new Date(m.valueOf() - (forcedTzo || 0));\n        }\n        else {\n            return new Date(m.valueOf() -\n                this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\n            );\n        }\n    };\n    return DateEnv;\n}());\n\nvar SIMPLE_SOURCE_PROPS = {\n    id: String,\n    allDayDefault: Boolean,\n    eventDataTransform: Function,\n    success: Function,\n    failure: Function\n};\nvar uid$2 = 0;\nfunction doesSourceNeedRange(eventSource, calendar) {\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n    return !defs[eventSource.sourceDefId].ignoreRange;\n}\nfunction parseEventSource(raw, calendar) {\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n    for (var i = defs.length - 1; i >= 0; i--) { // later-added plugins take precedence\n        var def = defs[i];\n        var meta = def.parseMeta(raw);\n        if (meta) {\n            var res = parseEventSourceProps(typeof raw === 'object' ? raw : {}, meta, i, calendar);\n            res._raw = raw;\n            return res;\n        }\n    }\n    return null;\n}\nfunction parseEventSourceProps(raw, meta, sourceDefId, calendar) {\n    var leftovers0 = {};\n    var props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0);\n    var leftovers1 = {};\n    var ui = processUnscopedUiProps(leftovers0, calendar, leftovers1);\n    props.isFetching = false;\n    props.latestFetchId = '';\n    props.fetchRange = null;\n    props.publicId = String(raw.id || '');\n    props.sourceId = String(uid$2++);\n    props.sourceDefId = sourceDefId;\n    props.meta = meta;\n    props.ui = ui;\n    props.extendedProps = leftovers1;\n    return props;\n}\n\nfunction reduceEventSources (eventSources, action, dateProfile, calendar) {\n    switch (action.type) {\n        case 'ADD_EVENT_SOURCES': // already parsed\n            return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'REMOVE_EVENT_SOURCE':\n            return removeSource(eventSources, action.sourceId);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            if (dateProfile) {\n                return fetchDirtySources(eventSources, dateProfile.activeRange, calendar);\n            }\n            else {\n                return eventSources;\n            }\n        case 'FETCH_EVENT_SOURCES':\n        case 'CHANGE_TIMEZONE':\n            return fetchSourcesByIds(eventSources, action.sourceIds ?\n                arrayToHash(action.sourceIds) :\n                excludeStaticSources(eventSources, calendar), dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'RECEIVE_EVENTS':\n        case 'RECEIVE_EVENT_ERROR':\n            return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n        case 'REMOVE_ALL_EVENT_SOURCES':\n            return {};\n        default:\n            return eventSources;\n    }\n}\nvar uid$3 = 0;\nfunction addSources(eventSourceHash, sources, fetchRange, calendar) {\n    var hash = {};\n    for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\n        var source = sources_1[_i];\n        hash[source.sourceId] = source;\n    }\n    if (fetchRange) {\n        hash = fetchDirtySources(hash, fetchRange, calendar);\n    }\n    return __assign({}, eventSourceHash, hash);\n}\nfunction removeSource(eventSourceHash, sourceId) {\n    return filterHash(eventSourceHash, function (eventSource) {\n        return eventSource.sourceId !== sourceId;\n    });\n}\nfunction fetchDirtySources(sourceHash, fetchRange, calendar) {\n    return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\n        return isSourceDirty(eventSource, fetchRange, calendar);\n    }), fetchRange, calendar);\n}\nfunction isSourceDirty(eventSource, fetchRange, calendar) {\n    if (!doesSourceNeedRange(eventSource, calendar)) {\n        return !eventSource.latestFetchId;\n    }\n    else {\n        return !calendar.opt('lazyFetching') ||\n            !eventSource.fetchRange ||\n            fetchRange.start < eventSource.fetchRange.start ||\n            fetchRange.end > eventSource.fetchRange.end;\n    }\n}\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, calendar) {\n    var nextSources = {};\n    for (var sourceId in prevSources) {\n        var source = prevSources[sourceId];\n        if (sourceIdHash[sourceId]) {\n            nextSources[sourceId] = fetchSource(source, fetchRange, calendar);\n        }\n        else {\n            nextSources[sourceId] = source;\n        }\n    }\n    return nextSources;\n}\nfunction fetchSource(eventSource, fetchRange, calendar) {\n    var sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];\n    var fetchId = String(uid$3++);\n    sourceDef.fetch({\n        eventSource: eventSource,\n        calendar: calendar,\n        range: fetchRange\n    }, function (res) {\n        var rawEvents = res.rawEvents;\n        var calSuccess = calendar.opt('eventSourceSuccess');\n        var calSuccessRes;\n        var sourceSuccessRes;\n        if (eventSource.success) {\n            sourceSuccessRes = eventSource.success(rawEvents, res.xhr);\n        }\n        if (calSuccess) {\n            calSuccessRes = calSuccess(rawEvents, res.xhr);\n        }\n        rawEvents = sourceSuccessRes || calSuccessRes || rawEvents;\n        calendar.dispatch({\n            type: 'RECEIVE_EVENTS',\n            sourceId: eventSource.sourceId,\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            rawEvents: rawEvents\n        });\n    }, function (error) {\n        var callFailure = calendar.opt('eventSourceFailure');\n        console.warn(error.message, error);\n        if (eventSource.failure) {\n            eventSource.failure(error);\n        }\n        if (callFailure) {\n            callFailure(error);\n        }\n        calendar.dispatch({\n            type: 'RECEIVE_EVENT_ERROR',\n            sourceId: eventSource.sourceId,\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            error: error\n        });\n    });\n    return __assign({}, eventSource, { isFetching: true, latestFetchId: fetchId });\n}\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n    var _a;\n    var eventSource = sourceHash[sourceId];\n    if (eventSource && // not already removed\n        fetchId === eventSource.latestFetchId) {\n        return __assign({}, sourceHash, (_a = {}, _a[sourceId] = __assign({}, eventSource, { isFetching: false, fetchRange: fetchRange }), _a));\n    }\n    return sourceHash;\n}\nfunction excludeStaticSources(eventSources, calendar) {\n    return filterHash(eventSources, function (eventSource) {\n        return doesSourceNeedRange(eventSource, calendar);\n    });\n}\n\nvar DateProfileGenerator = /** @class */ (function () {\n    function DateProfileGenerator(viewSpec, calendar) {\n        this.viewSpec = viewSpec;\n        this.options = viewSpec.options;\n        this.dateEnv = calendar.dateEnv;\n        this.calendar = calendar;\n        this.initHiddenDays();\n    }\n    /* Date Range Computation\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\n    DateProfileGenerator.prototype.buildPrev = function (currentDateProfile, currentDate) {\n        var dateEnv = this.dateEnv;\n        var prevDate = dateEnv.subtract(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n        currentDateProfile.dateIncrement);\n        return this.build(prevDate, -1);\n    };\n    // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\n    DateProfileGenerator.prototype.buildNext = function (currentDateProfile, currentDate) {\n        var dateEnv = this.dateEnv;\n        var nextDate = dateEnv.add(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n        currentDateProfile.dateIncrement);\n        return this.build(nextDate, 1);\n    };\n    // Builds a structure holding dates/ranges for rendering around the given date.\n    // Optional direction param indicates whether the date is being incremented/decremented\n    // from its previous value. decremented = -1, incremented = 1 (default).\n    DateProfileGenerator.prototype.build = function (currentDate, direction, forceToValid) {\n        if (forceToValid === void 0) { forceToValid = false; }\n        var validRange;\n        var minTime = null;\n        var maxTime = null;\n        var currentInfo;\n        var isRangeAllDay;\n        var renderRange;\n        var activeRange;\n        var isValid;\n        validRange = this.buildValidRange();\n        validRange = this.trimHiddenDays(validRange);\n        if (forceToValid) {\n            currentDate = constrainMarkerToRange(currentDate, validRange);\n        }\n        currentInfo = this.buildCurrentRangeInfo(currentDate, direction);\n        isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit);\n        renderRange = this.buildRenderRange(this.trimHiddenDays(currentInfo.range), currentInfo.unit, isRangeAllDay);\n        renderRange = this.trimHiddenDays(renderRange);\n        activeRange = renderRange;\n        if (!this.options.showNonCurrentDates) {\n            activeRange = intersectRanges(activeRange, currentInfo.range);\n        }\n        minTime = createDuration(this.options.minTime);\n        maxTime = createDuration(this.options.maxTime);\n        activeRange = this.adjustActiveRange(activeRange, minTime, maxTime);\n        activeRange = intersectRanges(activeRange, validRange); // might return null\n        // it's invalid if the originally requested date is not contained,\n        // or if the range is completely outside of the valid range.\n        isValid = rangesIntersect(currentInfo.range, validRange);\n        return {\n            // constraint for where prev/next operations can go and where events can be dragged/resized to.\n            // an object with optional start and end properties.\n            validRange: validRange,\n            // range the view is formally responsible for.\n            // for example, a month view might have 1st-31st, excluding padded dates\n            currentRange: currentInfo.range,\n            // name of largest unit being displayed, like \"month\" or \"week\"\n            currentRangeUnit: currentInfo.unit,\n            isRangeAllDay: isRangeAllDay,\n            // dates that display events and accept drag-n-drop\n            // will be `null` if no dates accept events\n            activeRange: activeRange,\n            // date range with a rendered skeleton\n            // includes not-active days that need some sort of DOM\n            renderRange: renderRange,\n            // Duration object that denotes the first visible time of any given day\n            minTime: minTime,\n            // Duration object that denotes the exclusive visible end time of any given day\n            maxTime: maxTime,\n            isValid: isValid,\n            // how far the current date will move for a prev/next operation\n            dateIncrement: this.buildDateIncrement(currentInfo.duration)\n            // pass a fallback (might be null) ^\n        };\n    };\n    // Builds an object with optional start/end properties.\n    // Indicates the minimum/maximum dates to display.\n    // not responsible for trimming hidden days.\n    DateProfileGenerator.prototype.buildValidRange = function () {\n        return this.getRangeOption('validRange', this.calendar.getNow()) ||\n            { start: null, end: null }; // completely open-ended\n    };\n    // Builds a structure with info about the \"current\" range, the range that is\n    // highlighted as being the current month for example.\n    // See build() for a description of `direction`.\n    // Guaranteed to have `range` and `unit` properties. `duration` is optional.\n    DateProfileGenerator.prototype.buildCurrentRangeInfo = function (date, direction) {\n        var _a = this, viewSpec = _a.viewSpec, dateEnv = _a.dateEnv;\n        var duration = null;\n        var unit = null;\n        var range = null;\n        var dayCount;\n        if (viewSpec.duration) {\n            duration = viewSpec.duration;\n            unit = viewSpec.durationUnit;\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\n        }\n        else if ((dayCount = this.options.dayCount)) {\n            unit = 'day';\n            range = this.buildRangeFromDayCount(date, direction, dayCount);\n        }\n        else if ((range = this.buildCustomVisibleRange(date))) {\n            unit = dateEnv.greatestWholeUnit(range.start, range.end).unit;\n        }\n        else {\n            duration = this.getFallbackDuration();\n            unit = greatestDurationDenominator(duration).unit;\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\n        }\n        return { duration: duration, unit: unit, range: range };\n    };\n    DateProfileGenerator.prototype.getFallbackDuration = function () {\n        return createDuration({ day: 1 });\n    };\n    // Returns a new activeRange to have time values (un-ambiguate)\n    // minTime or maxTime causes the range to expand.\n    DateProfileGenerator.prototype.adjustActiveRange = function (range, minTime, maxTime) {\n        var dateEnv = this.dateEnv;\n        var start = range.start;\n        var end = range.end;\n        if (this.viewSpec.class.prototype.usesMinMaxTime) {\n            // expand active range if minTime is negative (why not when positive?)\n            if (asRoughDays(minTime) < 0) {\n                start = startOfDay(start); // necessary?\n                start = dateEnv.add(start, minTime);\n            }\n            // expand active range if maxTime is beyond one day (why not when positive?)\n            if (asRoughDays(maxTime) > 1) {\n                end = startOfDay(end); // necessary?\n                end = addDays(end, -1);\n                end = dateEnv.add(end, maxTime);\n            }\n        }\n        return { start: start, end: end };\n    };\n    // Builds the \"current\" range when it is specified as an explicit duration.\n    // `unit` is the already-computed greatestDurationDenominator unit of duration.\n    DateProfileGenerator.prototype.buildRangeFromDuration = function (date, direction, duration, unit) {\n        var dateEnv = this.dateEnv;\n        var alignment = this.options.dateAlignment;\n        var dateIncrementInput;\n        var dateIncrementDuration;\n        var start;\n        var end;\n        var res;\n        // compute what the alignment should be\n        if (!alignment) {\n            dateIncrementInput = this.options.dateIncrement;\n            if (dateIncrementInput) {\n                dateIncrementDuration = createDuration(dateIncrementInput);\n                // use the smaller of the two units\n                if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\n                    alignment = greatestDurationDenominator(dateIncrementDuration, !getWeeksFromInput(dateIncrementInput)).unit;\n                }\n                else {\n                    alignment = unit;\n                }\n            }\n            else {\n                alignment = unit;\n            }\n        }\n        // if the view displays a single day or smaller\n        if (asRoughDays(duration) <= 1) {\n            if (this.isHiddenDay(start)) {\n                start = this.skipHiddenDays(start, direction);\n                start = startOfDay(start);\n            }\n        }\n        function computeRes() {\n            start = dateEnv.startOf(date, alignment);\n            end = dateEnv.add(start, duration);\n            res = { start: start, end: end };\n        }\n        computeRes();\n        // if range is completely enveloped by hidden days, go past the hidden days\n        if (!this.trimHiddenDays(res)) {\n            date = this.skipHiddenDays(date, direction);\n            computeRes();\n        }\n        return res;\n    };\n    // Builds the \"current\" range when a dayCount is specified.\n    DateProfileGenerator.prototype.buildRangeFromDayCount = function (date, direction, dayCount) {\n        var dateEnv = this.dateEnv;\n        var customAlignment = this.options.dateAlignment;\n        var runningCount = 0;\n        var start = date;\n        var end;\n        if (customAlignment) {\n            start = dateEnv.startOf(start, customAlignment);\n        }\n        start = startOfDay(start);\n        start = this.skipHiddenDays(start, direction);\n        end = start;\n        do {\n            end = addDays(end, 1);\n            if (!this.isHiddenDay(end)) {\n                runningCount++;\n            }\n        } while (runningCount < dayCount);\n        return { start: start, end: end };\n    };\n    // Builds a normalized range object for the \"visible\" range,\n    // which is a way to define the currentRange and activeRange at the same time.\n    DateProfileGenerator.prototype.buildCustomVisibleRange = function (date) {\n        var dateEnv = this.dateEnv;\n        var visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date));\n        if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\n            return null;\n        }\n        return visibleRange;\n    };\n    // Computes the range that will represent the element/cells for *rendering*,\n    // but which may have voided days/times.\n    // not responsible for trimming hidden days.\n    DateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n        return currentRange;\n    };\n    // Compute the duration value that should be added/substracted to the current date\n    // when a prev/next operation happens.\n    DateProfileGenerator.prototype.buildDateIncrement = function (fallback) {\n        var dateIncrementInput = this.options.dateIncrement;\n        var customAlignment;\n        if (dateIncrementInput) {\n            return createDuration(dateIncrementInput);\n        }\n        else if ((customAlignment = this.options.dateAlignment)) {\n            return createDuration(1, customAlignment);\n        }\n        else if (fallback) {\n            return fallback;\n        }\n        else {\n            return createDuration({ days: 1 });\n        }\n    };\n    // Arguments after name will be forwarded to a hypothetical function value\n    // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\n    // Always clone your objects if you fear mutation.\n    DateProfileGenerator.prototype.getRangeOption = function (name) {\n        var otherArgs = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            otherArgs[_i - 1] = arguments[_i];\n        }\n        var val = this.options[name];\n        if (typeof val === 'function') {\n            val = val.apply(null, otherArgs);\n        }\n        if (val) {\n            val = parseRange(val, this.dateEnv);\n        }\n        if (val) {\n            val = computeVisibleDayRange(val);\n        }\n        return val;\n    };\n    /* Hidden Days\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Initializes internal variables related to calculating hidden days-of-week\n    DateProfileGenerator.prototype.initHiddenDays = function () {\n        var hiddenDays = this.options.hiddenDays || []; // array of day-of-week indices that are hidden\n        var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)\n        var dayCnt = 0;\n        var i;\n        if (this.options.weekends === false) {\n            hiddenDays.push(0, 6); // 0=sunday, 6=saturday\n        }\n        for (i = 0; i < 7; i++) {\n            if (!(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)) {\n                dayCnt++;\n            }\n        }\n        if (!dayCnt) {\n            throw new Error('invalid hiddenDays'); // all days were hidden? bad.\n        }\n        this.isHiddenDayHash = isHiddenDayHash;\n    };\n    // Remove days from the beginning and end of the range that are computed as hidden.\n    // If the whole range is trimmed off, returns null\n    DateProfileGenerator.prototype.trimHiddenDays = function (range) {\n        var start = range.start;\n        var end = range.end;\n        if (start) {\n            start = this.skipHiddenDays(start);\n        }\n        if (end) {\n            end = this.skipHiddenDays(end, -1, true);\n        }\n        if (start == null || end == null || start < end) {\n            return { start: start, end: end };\n        }\n        return null;\n    };\n    // Is the current day hidden?\n    // `day` is a day-of-week index (0-6), or a Date (used for UTC)\n    DateProfileGenerator.prototype.isHiddenDay = function (day) {\n        if (day instanceof Date) {\n            day = day.getUTCDay();\n        }\n        return this.isHiddenDayHash[day];\n    };\n    // Incrementing the current day until it is no longer a hidden day, returning a copy.\n    // DOES NOT CONSIDER validRange!\n    // If the initial value of `date` is not a hidden day, don't do anything.\n    // Pass `isExclusive` as `true` if you are dealing with an end date.\n    // `inc` defaults to `1` (increment one day forward each time)\n    DateProfileGenerator.prototype.skipHiddenDays = function (date, inc, isExclusive) {\n        if (inc === void 0) { inc = 1; }\n        if (isExclusive === void 0) { isExclusive = false; }\n        while (this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]) {\n            date = addDays(date, inc);\n        }\n        return date;\n    };\n    return DateProfileGenerator;\n}());\n// TODO: find a way to avoid comparing DateProfiles. it's tedious\nfunction isDateProfilesEqual(p0, p1) {\n    return rangesEqual(p0.validRange, p1.validRange) &&\n        rangesEqual(p0.activeRange, p1.activeRange) &&\n        rangesEqual(p0.renderRange, p1.renderRange) &&\n        durationsEqual(p0.minTime, p1.minTime) &&\n        durationsEqual(p0.maxTime, p1.maxTime);\n    /*\n    TODO: compare more?\n      currentRange: DateRange\n      currentRangeUnit: string\n      isRangeAllDay: boolean\n      isValid: boolean\n      dateIncrement: Duration\n    */\n}\n\nfunction reduce (state, action, calendar) {\n    var viewType = reduceViewType(state.viewType, action);\n    var dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar);\n    var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar);\n    var nextState = __assign({}, state, { viewType: viewType,\n        dateProfile: dateProfile, currentDate: reduceCurrentDate(state.currentDate, action, dateProfile), eventSources: eventSources, eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar), dateSelection: reduceDateSelection(state.dateSelection, action, calendar), eventSelection: reduceSelectedEvent(state.eventSelection, action), eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar), eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar), eventSourceLoadingLevel: computeLoadingLevel(eventSources), loadingLevel: computeLoadingLevel(eventSources) });\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.reducers; _i < _a.length; _i++) {\n        var reducerFunc = _a[_i];\n        nextState = reducerFunc(nextState, action, calendar);\n    }\n    // console.log(action.type, nextState)\n    return nextState;\n}\nfunction reduceViewType(currentViewType, action) {\n    switch (action.type) {\n        case 'SET_VIEW_TYPE':\n            return action.viewType;\n        default:\n            return currentViewType;\n    }\n}\nfunction reduceDateProfile(currentDateProfile, action, currentDate, viewType, calendar) {\n    var newDateProfile;\n    switch (action.type) {\n        case 'PREV':\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate);\n            break;\n        case 'NEXT':\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate);\n            break;\n        case 'SET_DATE':\n            if (!currentDateProfile.activeRange ||\n                !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)) {\n                newDateProfile = calendar.dateProfileGenerators[viewType].build(action.dateMarker, undefined, true // forceToValid\n                );\n            }\n            break;\n        case 'SET_VIEW_TYPE':\n            var generator = calendar.dateProfileGenerators[viewType];\n            if (!generator) {\n                throw new Error(viewType ?\n                    'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' :\n                    'No available FullCalendar view plugins.');\n            }\n            newDateProfile = generator.build(action.dateMarker || currentDate, undefined, true // forceToValid\n            );\n            break;\n    }\n    if (newDateProfile &&\n        newDateProfile.isValid &&\n        !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))) {\n        return newDateProfile;\n    }\n    else {\n        return currentDateProfile;\n    }\n}\nfunction reduceCurrentDate(currentDate, action, dateProfile) {\n    switch (action.type) {\n        case 'PREV':\n        case 'NEXT':\n            if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n                return dateProfile.currentRange.start;\n            }\n            else {\n                return currentDate;\n            }\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            var newDate = action.dateMarker || currentDate;\n            if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\n                return dateProfile.currentRange.start;\n            }\n            else {\n                return newDate;\n            }\n        default:\n            return currentDate;\n    }\n}\nfunction reduceDateSelection(currentSelection, action, calendar) {\n    switch (action.type) {\n        case 'SELECT_DATES':\n            return action.selection;\n        case 'UNSELECT_DATES':\n            return null;\n        default:\n            return currentSelection;\n    }\n}\nfunction reduceSelectedEvent(currentInstanceId, action) {\n    switch (action.type) {\n        case 'SELECT_EVENT':\n            return action.eventInstanceId;\n        case 'UNSELECT_EVENT':\n            return '';\n        default:\n            return currentInstanceId;\n    }\n}\nfunction reduceEventDrag(currentDrag, action, sources, calendar) {\n    switch (action.type) {\n        case 'SET_EVENT_DRAG':\n            var newDrag = action.state;\n            return {\n                affectedEvents: newDrag.affectedEvents,\n                mutatedEvents: newDrag.mutatedEvents,\n                isEvent: newDrag.isEvent,\n                origSeg: newDrag.origSeg\n            };\n        case 'UNSET_EVENT_DRAG':\n            return null;\n        default:\n            return currentDrag;\n    }\n}\nfunction reduceEventResize(currentResize, action, sources, calendar) {\n    switch (action.type) {\n        case 'SET_EVENT_RESIZE':\n            var newResize = action.state;\n            return {\n                affectedEvents: newResize.affectedEvents,\n                mutatedEvents: newResize.mutatedEvents,\n                isEvent: newResize.isEvent,\n                origSeg: newResize.origSeg\n            };\n        case 'UNSET_EVENT_RESIZE':\n            return null;\n        default:\n            return currentResize;\n    }\n}\nfunction computeLoadingLevel(eventSources) {\n    var cnt = 0;\n    for (var sourceId in eventSources) {\n        if (eventSources[sourceId].isFetching) {\n            cnt++;\n        }\n    }\n    return cnt;\n}\n\nvar STANDARD_PROPS = {\n    start: null,\n    end: null,\n    allDay: Boolean\n};\nfunction parseDateSpan(raw, dateEnv, defaultDuration) {\n    var span = parseOpenDateSpan(raw, dateEnv);\n    var range = span.range;\n    if (!range.start) {\n        return null;\n    }\n    if (!range.end) {\n        if (defaultDuration == null) {\n            return null;\n        }\n        else {\n            range.end = dateEnv.add(range.start, defaultDuration);\n        }\n    }\n    return span;\n}\n/*\nTODO: somehow combine with parseRange?\nWill return null if the start/end props were present but parsed invalidly.\n*/\nfunction parseOpenDateSpan(raw, dateEnv) {\n    var leftovers = {};\n    var standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers);\n    var startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null;\n    var endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null;\n    var allDay = standardProps.allDay;\n    if (allDay == null) {\n        allDay = (startMeta && startMeta.isTimeUnspecified) &&\n            (!endMeta || endMeta.isTimeUnspecified);\n    }\n    // use this leftover object as the selection object\n    leftovers.range = {\n        start: startMeta ? startMeta.marker : null,\n        end: endMeta ? endMeta.marker : null\n    };\n    leftovers.allDay = allDay;\n    return leftovers;\n}\nfunction isDateSpansEqual(span0, span1) {\n    return rangesEqual(span0.range, span1.range) &&\n        span0.allDay === span1.allDay &&\n        isSpanPropsEqual(span0, span1);\n}\n// the NON-DATE-RELATED props\nfunction isSpanPropsEqual(span0, span1) {\n    for (var propName in span1) {\n        if (propName !== 'range' && propName !== 'allDay') {\n            if (span0[propName] !== span1[propName]) {\n                return false;\n            }\n        }\n    }\n    // are there any props that span0 has that span1 DOESN'T have?\n    // both have range/allDay, so no need to special-case.\n    for (var propName in span0) {\n        if (!(propName in span1)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction buildDateSpanApi(span, dateEnv) {\n    return {\n        start: dateEnv.toDate(span.range.start),\n        end: dateEnv.toDate(span.range.end),\n        startStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n        endStr: dateEnv.formatIso(span.range.end, { omitTime: span.allDay }),\n        allDay: span.allDay\n    };\n}\nfunction buildDatePointApi(span, dateEnv) {\n    return {\n        date: dateEnv.toDate(span.range.start),\n        dateStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n        allDay: span.allDay\n    };\n}\nfunction fabricateEventRange(dateSpan, eventUiBases, calendar) {\n    var def = parseEventDef({ editable: false }, '', // sourceId\n    dateSpan.allDay, true, // hasEnd\n    calendar);\n    return {\n        def: def,\n        ui: compileEventUi(def, eventUiBases),\n        instance: createEventInstance(def.defId, dateSpan.range),\n        range: dateSpan.range,\n        isStart: true,\n        isEnd: true\n    };\n}\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n    var hash = {};\n    var viewType;\n    for (viewType in defaultConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    for (viewType in overrideConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    return hash;\n}\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    if (hash[viewType]) {\n        return hash[viewType];\n    }\n    var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    if (viewDef) {\n        hash[viewType] = viewDef;\n    }\n    return viewDef;\n}\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    var defaultConfig = defaultConfigs[viewType];\n    var overrideConfig = overrideConfigs[viewType];\n    var queryProp = function (name) {\n        return (defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\n            ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null);\n    };\n    var theClass = queryProp('class');\n    var superType = queryProp('superType');\n    if (!superType && theClass) {\n        superType =\n            findViewNameBySubclass(theClass, overrideConfigs) ||\n                findViewNameBySubclass(theClass, defaultConfigs);\n    }\n    var superDef = null;\n    if (superType) {\n        if (superType === viewType) {\n            throw new Error('Can\\'t have a custom view type that references itself');\n        }\n        superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n    }\n    if (!theClass && superDef) {\n        theClass = superDef.class;\n    }\n    if (!theClass) {\n        return null; // don't throw a warning, might be settings for a single-unit view\n    }\n    return {\n        type: viewType,\n        class: theClass,\n        defaults: __assign({}, (superDef ? superDef.defaults : {}), (defaultConfig ? defaultConfig.options : {})),\n        overrides: __assign({}, (superDef ? superDef.overrides : {}), (overrideConfig ? overrideConfig.options : {}))\n    };\n}\nfunction findViewNameBySubclass(viewSubclass, configs) {\n    var superProto = Object.getPrototypeOf(viewSubclass.prototype);\n    for (var viewType in configs) {\n        var parsed = configs[viewType];\n        // need DIRECT subclass, so instanceof won't do it\n        if (parsed.class && parsed.class.prototype === superProto) {\n            return viewType;\n        }\n    }\n    return '';\n}\n\nfunction parseViewConfigs(inputs) {\n    return mapHash(inputs, parseViewConfig);\n}\nvar VIEW_DEF_PROPS = {\n    type: String,\n    class: null\n};\nfunction parseViewConfig(input) {\n    if (typeof input === 'function') {\n        input = { class: input };\n    }\n    var options = {};\n    var props = refineProps(input, VIEW_DEF_PROPS, {}, options);\n    return {\n        superType: props.type,\n        class: props.class,\n        options: options\n    };\n}\n\nfunction buildViewSpecs(defaultInputs, optionsManager) {\n    var defaultConfigs = parseViewConfigs(defaultInputs);\n    var overrideConfigs = parseViewConfigs(optionsManager.overrides.views);\n    var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n    return mapHash(viewDefs, function (viewDef) {\n        return buildViewSpec(viewDef, overrideConfigs, optionsManager);\n    });\n}\nfunction buildViewSpec(viewDef, overrideConfigs, optionsManager) {\n    var durationInput = viewDef.overrides.duration ||\n        viewDef.defaults.duration ||\n        optionsManager.dynamicOverrides.duration ||\n        optionsManager.overrides.duration;\n    var duration = null;\n    var durationUnit = '';\n    var singleUnit = '';\n    var singleUnitOverrides = {};\n    if (durationInput) {\n        duration = createDuration(durationInput);\n        if (duration) { // valid?\n            var denom = greatestDurationDenominator(duration, !getWeeksFromInput(durationInput));\n            durationUnit = denom.unit;\n            if (denom.value === 1) {\n                singleUnit = durationUnit;\n                singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {};\n            }\n        }\n    }\n    var queryButtonText = function (options) {\n        var buttonTextMap = options.buttonText || {};\n        var buttonTextKey = viewDef.defaults.buttonTextKey;\n        if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n            return buttonTextMap[buttonTextKey];\n        }\n        if (buttonTextMap[viewDef.type] != null) {\n            return buttonTextMap[viewDef.type];\n        }\n        if (buttonTextMap[singleUnit] != null) {\n            return buttonTextMap[singleUnit];\n        }\n    };\n    return {\n        type: viewDef.type,\n        class: viewDef.class,\n        duration: duration,\n        durationUnit: durationUnit,\n        singleUnit: singleUnit,\n        options: __assign({}, globalDefaults, viewDef.defaults, optionsManager.dirDefaults, optionsManager.localeDefaults, optionsManager.overrides, singleUnitOverrides, viewDef.overrides, optionsManager.dynamicOverrides),\n        buttonTextOverride: queryButtonText(optionsManager.dynamicOverrides) ||\n            queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\n            viewDef.overrides.buttonText,\n        buttonTextDefault: queryButtonText(optionsManager.localeDefaults) ||\n            queryButtonText(optionsManager.dirDefaults) ||\n            viewDef.defaults.buttonText ||\n            queryButtonText(globalDefaults) ||\n            viewDef.type // fall back to given view name\n    };\n}\n\nvar Toolbar = /** @class */ (function (_super) {\n    __extends(Toolbar, _super);\n    function Toolbar(context, extraClassName) {\n        var _this = _super.call(this, context) || this;\n        _this._renderLayout = memoizeRendering(_this.renderLayout, _this.unrenderLayout);\n        _this._updateTitle = memoizeRendering(_this.updateTitle, null, [_this._renderLayout]);\n        _this._updateActiveButton = memoizeRendering(_this.updateActiveButton, null, [_this._renderLayout]);\n        _this._updateToday = memoizeRendering(_this.updateToday, null, [_this._renderLayout]);\n        _this._updatePrev = memoizeRendering(_this.updatePrev, null, [_this._renderLayout]);\n        _this._updateNext = memoizeRendering(_this.updateNext, null, [_this._renderLayout]);\n        _this.el = createElement('div', { className: 'fc-toolbar ' + extraClassName });\n        return _this;\n    }\n    Toolbar.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this._renderLayout.unrender(); // should unrender everything else\n        removeElement(this.el);\n    };\n    Toolbar.prototype.render = function (props) {\n        this._renderLayout(props.layout);\n        this._updateTitle(props.title);\n        this._updateActiveButton(props.activeButton);\n        this._updateToday(props.isTodayEnabled);\n        this._updatePrev(props.isPrevEnabled);\n        this._updateNext(props.isNextEnabled);\n    };\n    Toolbar.prototype.renderLayout = function (layout) {\n        var el = this.el;\n        this.viewsWithButtons = [];\n        appendToElement(el, this.renderSection('left', layout.left));\n        appendToElement(el, this.renderSection('center', layout.center));\n        appendToElement(el, this.renderSection('right', layout.right));\n    };\n    Toolbar.prototype.unrenderLayout = function () {\n        this.el.innerHTML = '';\n    };\n    Toolbar.prototype.renderSection = function (position, buttonStr) {\n        var _this = this;\n        var _a = this, theme = _a.theme, calendar = _a.calendar;\n        var optionsManager = calendar.optionsManager;\n        var viewSpecs = calendar.viewSpecs;\n        var sectionEl = createElement('div', { className: 'fc-' + position });\n        var calendarCustomButtons = optionsManager.computed.customButtons || {};\n        var calendarButtonTextOverrides = optionsManager.overrides.buttonText || {};\n        var calendarButtonText = optionsManager.computed.buttonText || {};\n        if (buttonStr) {\n            buttonStr.split(' ').forEach(function (buttonGroupStr, i) {\n                var groupChildren = [];\n                var isOnlyButtons = true;\n                var groupEl;\n                buttonGroupStr.split(',').forEach(function (buttonName, j) {\n                    var customButtonProps;\n                    var viewSpec;\n                    var buttonClick;\n                    var buttonIcon; // only one of these will be set\n                    var buttonText; // \"\n                    var buttonInnerHtml;\n                    var buttonClasses;\n                    var buttonEl;\n                    var buttonAriaAttr;\n                    if (buttonName === 'title') {\n                        groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')); // we always want it to take up height\n                        isOnlyButtons = false;\n                    }\n                    else {\n                        if ((customButtonProps = calendarCustomButtons[buttonName])) {\n                            buttonClick = function (ev) {\n                                if (customButtonProps.click) {\n                                    customButtonProps.click.call(buttonEl, ev);\n                                }\n                            };\n                            (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = customButtonProps.text);\n                        }\n                        else if ((viewSpec = viewSpecs[buttonName])) {\n                            _this.viewsWithButtons.push(buttonName);\n                            buttonClick = function () {\n                                calendar.changeView(buttonName);\n                            };\n                            (buttonText = viewSpec.buttonTextOverride) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = viewSpec.buttonTextDefault);\n                        }\n                        else if (calendar[buttonName]) { // a calendar method\n                            buttonClick = function () {\n                                calendar[buttonName]();\n                            };\n                            (buttonText = calendarButtonTextOverrides[buttonName]) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = calendarButtonText[buttonName]);\n                            //            ^ everything else is considered default\n                        }\n                        if (buttonClick) {\n                            buttonClasses = [\n                                'fc-' + buttonName + '-button',\n                                theme.getClass('button')\n                            ];\n                            if (buttonText) {\n                                buttonInnerHtml = htmlEscape(buttonText);\n                                buttonAriaAttr = '';\n                            }\n                            else if (buttonIcon) {\n                                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\";\n                                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"';\n                            }\n                            buttonEl = htmlToElement(// type=\"button\" so that it doesn't submit a form\n                            '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' +\n                                buttonAriaAttr +\n                                '>' + buttonInnerHtml + '</button>');\n                            buttonEl.addEventListener('click', buttonClick);\n                            groupChildren.push(buttonEl);\n                        }\n                    }\n                });\n                if (groupChildren.length > 1) {\n                    groupEl = document.createElement('div');\n                    var buttonGroupClassName = theme.getClass('buttonGroup');\n                    if (isOnlyButtons && buttonGroupClassName) {\n                        groupEl.classList.add(buttonGroupClassName);\n                    }\n                    appendToElement(groupEl, groupChildren);\n                    sectionEl.appendChild(groupEl);\n                }\n                else {\n                    appendToElement(sectionEl, groupChildren); // 1 or 0 children\n                }\n            });\n        }\n        return sectionEl;\n    };\n    Toolbar.prototype.updateToday = function (isTodayEnabled) {\n        this.toggleButtonEnabled('today', isTodayEnabled);\n    };\n    Toolbar.prototype.updatePrev = function (isPrevEnabled) {\n        this.toggleButtonEnabled('prev', isPrevEnabled);\n    };\n    Toolbar.prototype.updateNext = function (isNextEnabled) {\n        this.toggleButtonEnabled('next', isNextEnabled);\n    };\n    Toolbar.prototype.updateTitle = function (text) {\n        findElements(this.el, 'h2').forEach(function (titleEl) {\n            titleEl.innerText = text;\n        });\n    };\n    Toolbar.prototype.updateActiveButton = function (buttonName) {\n        var className = this.theme.getClass('buttonActive');\n        findElements(this.el, 'button').forEach(function (buttonEl) {\n            if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\n                buttonEl.classList.add(className);\n            }\n            else {\n                buttonEl.classList.remove(className);\n            }\n        });\n    };\n    Toolbar.prototype.toggleButtonEnabled = function (buttonName, bool) {\n        findElements(this.el, '.fc-' + buttonName + '-button').forEach(function (buttonEl) {\n            buttonEl.disabled = !bool;\n        });\n    };\n    return Toolbar;\n}(Component));\n\nvar CalendarComponent = /** @class */ (function (_super) {\n    __extends(CalendarComponent, _super);\n    function CalendarComponent(context, el) {\n        var _this = _super.call(this, context) || this;\n        _this._renderToolbars = memoizeRendering(_this.renderToolbars);\n        _this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n        _this.el = el;\n        prependToElement(el, _this.contentEl = createElement('div', { className: 'fc-view-container' }));\n        var calendar = _this.calendar;\n        for (var _i = 0, _a = calendar.pluginSystem.hooks.viewContainerModifiers; _i < _a.length; _i++) {\n            var modifyViewContainer = _a[_i];\n            modifyViewContainer(_this.contentEl, calendar);\n        }\n        _this.toggleElClassNames(true);\n        _this.computeTitle = memoize(computeTitle);\n        _this.parseBusinessHours = memoize(function (input) {\n            return parseBusinessHours(input, _this.calendar);\n        });\n        return _this;\n    }\n    CalendarComponent.prototype.destroy = function () {\n        if (this.header) {\n            this.header.destroy();\n        }\n        if (this.footer) {\n            this.footer.destroy();\n        }\n        if (this.view) {\n            this.view.destroy();\n        }\n        removeElement(this.contentEl);\n        this.toggleElClassNames(false);\n        _super.prototype.destroy.call(this);\n    };\n    CalendarComponent.prototype.toggleElClassNames = function (bool) {\n        var classList = this.el.classList;\n        var dirClassName = 'fc-' + this.opt('dir');\n        var themeClassName = this.theme.getClass('widget');\n        if (bool) {\n            classList.add('fc');\n            classList.add(dirClassName);\n            classList.add(themeClassName);\n        }\n        else {\n            classList.remove('fc');\n            classList.remove(dirClassName);\n            classList.remove(themeClassName);\n        }\n    };\n    CalendarComponent.prototype.render = function (props) {\n        this.freezeHeight();\n        var title = this.computeTitle(props.dateProfile, props.viewSpec.options);\n        this._renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, props.dateProfileGenerator, title);\n        this.renderView(props, title);\n        this.updateSize();\n        this.thawHeight();\n    };\n    CalendarComponent.prototype.renderToolbars = function (viewSpec, dateProfile, currentDate, dateProfileGenerator, title) {\n        var headerLayout = this.opt('header');\n        var footerLayout = this.opt('footer');\n        var now = this.calendar.getNow();\n        var todayInfo = dateProfileGenerator.build(now);\n        var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate);\n        var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate);\n        var toolbarProps = {\n            title: title,\n            activeButton: viewSpec.type,\n            isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n            isPrevEnabled: prevInfo.isValid,\n            isNextEnabled: nextInfo.isValid\n        };\n        if (headerLayout) {\n            if (!this.header) {\n                this.header = new Toolbar(this.context, 'fc-header-toolbar');\n                prependToElement(this.el, this.header.el);\n            }\n            this.header.receiveProps(__assign({ layout: headerLayout }, toolbarProps));\n        }\n        else if (this.header) {\n            this.header.destroy();\n            this.header = null;\n        }\n        if (footerLayout) {\n            if (!this.footer) {\n                this.footer = new Toolbar(this.context, 'fc-footer-toolbar');\n                appendToElement(this.el, this.footer.el);\n            }\n            this.footer.receiveProps(__assign({ layout: footerLayout }, toolbarProps));\n        }\n        else if (this.footer) {\n            this.footer.destroy();\n            this.footer = null;\n        }\n    };\n    CalendarComponent.prototype.renderView = function (props, title) {\n        var view = this.view;\n        var viewSpec = props.viewSpec, dateProfileGenerator = props.dateProfileGenerator;\n        if (!view || view.viewSpec !== viewSpec) {\n            if (view) {\n                view.destroy();\n            }\n            view = this.view = new viewSpec['class']({\n                calendar: this.calendar,\n                view: null,\n                dateEnv: this.dateEnv,\n                theme: this.theme,\n                options: viewSpec.options\n            }, viewSpec, dateProfileGenerator, this.contentEl);\n        }\n        else {\n            view.addScroll(view.queryScroll());\n        }\n        view.title = title; // for the API\n        var viewProps = {\n            dateProfile: props.dateProfile,\n            businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\n            eventStore: props.eventStore,\n            eventUiBases: props.eventUiBases,\n            dateSelection: props.dateSelection,\n            eventSelection: props.eventSelection,\n            eventDrag: props.eventDrag,\n            eventResize: props.eventResize\n        };\n        var transformers = this.buildViewPropTransformers(this.calendar.pluginSystem.hooks.viewPropsTransformers);\n        for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n            var transformer = transformers_1[_i];\n            __assign(viewProps, transformer.transform(viewProps, viewSpec, props, view));\n        }\n        view.receiveProps(viewProps);\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    CalendarComponent.prototype.updateSize = function (isResize) {\n        if (isResize === void 0) { isResize = false; }\n        var view = this.view;\n        if (isResize) {\n            view.addScroll(view.queryScroll());\n        }\n        if (isResize || this.isHeightAuto == null) {\n            this.computeHeightVars();\n        }\n        view.updateSize(isResize, this.viewHeight, this.isHeightAuto);\n        view.updateNowIndicator(); // we need to guarantee this will run after updateSize\n        view.popScroll(isResize);\n    };\n    CalendarComponent.prototype.computeHeightVars = function () {\n        var calendar = this.calendar; // yuck. need to handle dynamic options\n        var heightInput = calendar.opt('height');\n        var contentHeightInput = calendar.opt('contentHeight');\n        this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto';\n        if (typeof contentHeightInput === 'number') { // exists and not 'auto'\n            this.viewHeight = contentHeightInput;\n        }\n        else if (typeof contentHeightInput === 'function') { // exists and is a function\n            this.viewHeight = contentHeightInput();\n        }\n        else if (typeof heightInput === 'number') { // exists and not 'auto'\n            this.viewHeight = heightInput - this.queryToolbarsHeight();\n        }\n        else if (typeof heightInput === 'function') { // exists and is a function\n            this.viewHeight = heightInput() - this.queryToolbarsHeight();\n        }\n        else if (heightInput === 'parent') { // set to height of parent element\n            var parentEl = this.el.parentNode;\n            this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight();\n        }\n        else {\n            this.viewHeight = Math.round(this.contentEl.getBoundingClientRect().width /\n                Math.max(calendar.opt('aspectRatio'), .5));\n        }\n    };\n    CalendarComponent.prototype.queryToolbarsHeight = function () {\n        var height = 0;\n        if (this.header) {\n            height += computeHeightAndMargins(this.header.el);\n        }\n        if (this.footer) {\n            height += computeHeightAndMargins(this.footer.el);\n        }\n        return height;\n    };\n    // Height \"Freezing\"\n    // -----------------------------------------------------------------------------------------------------------------\n    CalendarComponent.prototype.freezeHeight = function () {\n        applyStyle(this.el, {\n            height: this.el.getBoundingClientRect().height,\n            overflow: 'hidden'\n        });\n    };\n    CalendarComponent.prototype.thawHeight = function () {\n        applyStyle(this.el, {\n            height: '',\n            overflow: ''\n        });\n    };\n    return CalendarComponent;\n}(Component));\n// Title and Date Formatting\n// -----------------------------------------------------------------------------------------------------------------\n// Computes what the title at the top of the calendar should be for this view\nfunction computeTitle(dateProfile, viewOptions) {\n    var range;\n    // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n    if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n        range = dateProfile.currentRange;\n    }\n    else { // for day units or smaller, use the actual day range\n        range = dateProfile.activeRange;\n    }\n    return this.dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || computeTitleFormat(dateProfile), viewOptions.titleRangeSeparator), { isEndExclusive: dateProfile.isRangeAllDay });\n}\n// Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\nfunction computeTitleFormat(dateProfile) {\n    var currentRangeUnit = dateProfile.currentRangeUnit;\n    if (currentRangeUnit === 'year') {\n        return { year: 'numeric' };\n    }\n    else if (currentRangeUnit === 'month') {\n        return { year: 'numeric', month: 'long' }; // like \"September 2014\"\n    }\n    else {\n        var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n        if (days !== null && days > 1) {\n            // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n            return { year: 'numeric', month: 'short', day: 'numeric' };\n        }\n        else {\n            // one day. longer, like \"September 9 2014\"\n            return { year: 'numeric', month: 'long', day: 'numeric' };\n        }\n    }\n}\n// Plugin\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildViewPropTransformers(theClasses) {\n    return theClasses.map(function (theClass) {\n        return new theClass();\n    });\n}\n\nvar Interaction = /** @class */ (function () {\n    function Interaction(settings) {\n        this.component = settings.component;\n    }\n    Interaction.prototype.destroy = function () {\n    };\n    return Interaction;\n}());\nfunction parseInteractionSettings(component, input) {\n    return {\n        component: component,\n        el: input.el,\n        useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\n    };\n}\nfunction interactionSettingsToStore(settings) {\n    var _a;\n    return _a = {},\n        _a[settings.component.uid] = settings,\n        _a;\n}\n// global state\nvar interactionSettingsStore = {};\n\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\nvar EventClicking = /** @class */ (function (_super) {\n    __extends(EventClicking, _super);\n    function EventClicking(settings) {\n        var _this = _super.call(this, settings) || this;\n        _this.handleSegClick = function (ev, segEl) {\n            var component = _this.component;\n            var seg = getElSeg(segEl);\n            if (seg && // might be the <div> surrounding the more link\n                component.isValidSegDownEl(ev.target)) {\n                // our way to simulate a link click for elements that can't be <a> tags\n                // grab before trigger fired in case trigger trashes DOM thru rerendering\n                var hasUrlContainer = elementClosest(ev.target, '.fc-has-url');\n                var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n                component.publiclyTrigger('eventClick', [\n                    {\n                        el: segEl,\n                        event: new EventApi(component.calendar, seg.eventRange.def, seg.eventRange.instance),\n                        jsEvent: ev,\n                        view: component.view\n                    }\n                ]);\n                if (url && !ev.defaultPrevented) {\n                    window.location.href = url;\n                }\n            }\n        };\n        var component = settings.component;\n        _this.destroy = listenBySelector(component.el, 'click', component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegClick);\n        return _this;\n    }\n    return EventClicking;\n}(Interaction));\n\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\nvar EventHovering = /** @class */ (function (_super) {\n    __extends(EventHovering, _super);\n    function EventHovering(settings) {\n        var _this = _super.call(this, settings) || this;\n        // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n        _this.handleEventElRemove = function (el) {\n            if (el === _this.currentSegEl) {\n                _this.handleSegLeave(null, _this.currentSegEl);\n            }\n        };\n        _this.handleSegEnter = function (ev, segEl) {\n            if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\n                segEl.classList.add('fc-allow-mouse-resize');\n                _this.currentSegEl = segEl;\n                _this.triggerEvent('eventMouseEnter', ev, segEl);\n            }\n        };\n        _this.handleSegLeave = function (ev, segEl) {\n            if (_this.currentSegEl) {\n                segEl.classList.remove('fc-allow-mouse-resize');\n                _this.currentSegEl = null;\n                _this.triggerEvent('eventMouseLeave', ev, segEl);\n            }\n        };\n        var component = settings.component;\n        _this.removeHoverListeners = listenToHoverBySelector(component.el, component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegEnter, _this.handleSegLeave);\n        component.calendar.on('eventElRemove', _this.handleEventElRemove);\n        return _this;\n    }\n    EventHovering.prototype.destroy = function () {\n        this.removeHoverListeners();\n        this.component.calendar.off('eventElRemove', this.handleEventElRemove);\n    };\n    EventHovering.prototype.triggerEvent = function (publicEvName, ev, segEl) {\n        var component = this.component;\n        var seg = getElSeg(segEl);\n        if (!ev || component.isValidSegDownEl(ev.target)) {\n            component.publiclyTrigger(publicEvName, [\n                {\n                    el: segEl,\n                    event: new EventApi(this.component.calendar, seg.eventRange.def, seg.eventRange.instance),\n                    jsEvent: ev,\n                    view: component.view\n                }\n            ]);\n        }\n    };\n    return EventHovering;\n}(Interaction));\n\nvar StandardTheme = /** @class */ (function (_super) {\n    __extends(StandardTheme, _super);\n    function StandardTheme() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return StandardTheme;\n}(Theme));\nStandardTheme.prototype.classes = {\n    widget: 'fc-unthemed',\n    widgetHeader: 'fc-widget-header',\n    widgetContent: 'fc-widget-content',\n    buttonGroup: 'fc-button-group',\n    button: 'fc-button fc-button-primary',\n    buttonActive: 'fc-button-active',\n    popoverHeader: 'fc-widget-header',\n    popoverContent: 'fc-widget-content',\n    // day grid\n    headerRow: 'fc-widget-header',\n    dayRow: 'fc-widget-content',\n    // list view\n    listView: 'fc-widget-content'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n    close: 'fc-icon-x',\n    prev: 'fc-icon-chevron-left',\n    next: 'fc-icon-chevron-right',\n    prevYear: 'fc-icon-chevrons-left',\n    nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons';\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nvar Calendar = /** @class */ (function () {\n    function Calendar(el, overrides) {\n        var _this = this;\n        this.parseRawLocales = memoize(parseRawLocales);\n        this.buildLocale = memoize(buildLocale);\n        this.buildDateEnv = memoize(buildDateEnv);\n        this.buildTheme = memoize(buildTheme);\n        this.buildEventUiSingleBase = memoize(this._buildEventUiSingleBase);\n        this.buildSelectionConfig = memoize(this._buildSelectionConfig);\n        this.buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual);\n        this.buildEventUiBases = memoize(buildEventUiBases);\n        this.interactionsStore = {};\n        this.actionQueue = [];\n        this.isReducing = false;\n        // isDisplaying: boolean = false // installed in DOM? accepting renders?\n        this.needsRerender = false; // needs a render?\n        this.needsFullRerender = false;\n        this.isRendering = false; // currently in the executeRender function?\n        this.renderingPauseDepth = 0;\n        this.buildDelayedRerender = memoize(buildDelayedRerender);\n        this.afterSizingTriggers = {};\n        this.isViewUpdated = false;\n        this.isDatesUpdated = false;\n        this.isEventsUpdated = false;\n        this.el = el;\n        this.optionsManager = new OptionsManager(overrides || {});\n        this.pluginSystem = new PluginSystem();\n        // only do once. don't do in handleOptions. because can't remove plugins\n        this.addPluginInputs(this.optionsManager.computed.plugins || []);\n        this.handleOptions(this.optionsManager.computed);\n        this.publiclyTrigger('_init'); // for tests\n        this.hydrate();\n        this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions\n            .map(function (calendarInteractionClass) {\n            return new calendarInteractionClass(_this);\n        });\n    }\n    Calendar.prototype.addPluginInputs = function (pluginInputs) {\n        var pluginDefs = refinePluginDefs(pluginInputs);\n        for (var _i = 0, pluginDefs_1 = pluginDefs; _i < pluginDefs_1.length; _i++) {\n            var pluginDef = pluginDefs_1[_i];\n            this.pluginSystem.add(pluginDef);\n        }\n    };\n    Object.defineProperty(Calendar.prototype, \"view\", {\n        // public API\n        get: function () {\n            return this.component ? this.component.view : null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Public API for rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.render = function () {\n        if (!this.component) {\n            this.renderableEventStore = createEmptyEventStore();\n            this.bindHandlers();\n            this.executeRender();\n        }\n        else {\n            this.requestRerender(true);\n        }\n    };\n    Calendar.prototype.destroy = function () {\n        if (this.component) {\n            this.unbindHandlers();\n            this.component.destroy(); // don't null-out. in case API needs access\n            this.component = null; // umm ???\n            for (var _i = 0, _a = this.calendarInteractions; _i < _a.length; _i++) {\n                var interaction = _a[_i];\n                interaction.destroy();\n            }\n            this.publiclyTrigger('_destroyed');\n        }\n    };\n    // Handlers\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.bindHandlers = function () {\n        var _this = this;\n        // event delegation for nav links\n        this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', function (ev, anchorEl) {\n            var gotoOptions = anchorEl.getAttribute('data-goto');\n            gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {};\n            var dateEnv = _this.dateEnv;\n            var dateMarker = dateEnv.createMarker(gotoOptions.date);\n            var viewType = gotoOptions.type;\n            // property like \"navLinkDayClick\". might be a string or a function\n            var customAction = _this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click');\n            if (typeof customAction === 'function') {\n                customAction(dateEnv.toDate(dateMarker), ev);\n            }\n            else {\n                if (typeof customAction === 'string') {\n                    viewType = customAction;\n                }\n                _this.zoomTo(dateMarker, viewType);\n            }\n        });\n        if (this.opt('handleWindowResize')) {\n            window.addEventListener('resize', this.windowResizeProxy = debounce(// prevents rapid calls\n            this.windowResize.bind(this), this.opt('windowResizeDelay')));\n        }\n    };\n    Calendar.prototype.unbindHandlers = function () {\n        this.removeNavLinkListener();\n        if (this.windowResizeProxy) {\n            window.removeEventListener('resize', this.windowResizeProxy);\n            this.windowResizeProxy = null;\n        }\n    };\n    // Dispatcher\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.hydrate = function () {\n        var _this = this;\n        this.state = this.buildInitialState();\n        var rawSources = this.opt('eventSources') || [];\n        var singleRawSource = this.opt('events');\n        var sources = []; // parsed\n        if (singleRawSource) {\n            rawSources.unshift(singleRawSource);\n        }\n        for (var _i = 0, rawSources_1 = rawSources; _i < rawSources_1.length; _i++) {\n            var rawSource = rawSources_1[_i];\n            var source = parseEventSource(rawSource, this);\n            if (source) {\n                sources.push(source);\n            }\n        }\n        this.batchRendering(function () {\n            _this.dispatch({ type: 'INIT' }); // pass in sources here?\n            _this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: sources });\n            _this.dispatch({\n                type: 'SET_VIEW_TYPE',\n                viewType: _this.opt('defaultView') || _this.pluginSystem.hooks.defaultView\n            });\n        });\n    };\n    Calendar.prototype.buildInitialState = function () {\n        return {\n            viewType: null,\n            loadingLevel: 0,\n            eventSourceLoadingLevel: 0,\n            currentDate: this.getInitialDate(),\n            dateProfile: null,\n            eventSources: {},\n            eventStore: createEmptyEventStore(),\n            dateSelection: null,\n            eventSelection: '',\n            eventDrag: null,\n            eventResize: null\n        };\n    };\n    Calendar.prototype.dispatch = function (action) {\n        this.actionQueue.push(action);\n        if (!this.isReducing) {\n            this.isReducing = true;\n            var oldState = this.state;\n            while (this.actionQueue.length) {\n                this.state = this.reduce(this.state, this.actionQueue.shift(), this);\n            }\n            var newState = this.state;\n            this.isReducing = false;\n            if (!oldState.loadingLevel && newState.loadingLevel) {\n                this.publiclyTrigger('loading', [true]);\n            }\n            else if (oldState.loadingLevel && !newState.loadingLevel) {\n                this.publiclyTrigger('loading', [false]);\n            }\n            var view = this.component && this.component.view;\n            if (oldState.eventStore !== newState.eventStore || this.needsFullRerender) {\n                if (oldState.eventStore) {\n                    this.isEventsUpdated = true;\n                }\n            }\n            if (oldState.dateProfile !== newState.dateProfile || this.needsFullRerender) {\n                if (oldState.dateProfile && view) { // why would view be null!?\n                    this.publiclyTrigger('datesDestroy', [\n                        {\n                            view: view,\n                            el: view.el\n                        }\n                    ]);\n                }\n                this.isDatesUpdated = true;\n            }\n            if (oldState.viewType !== newState.viewType || this.needsFullRerender) {\n                if (oldState.viewType && view) { // why would view be null!?\n                    this.publiclyTrigger('viewSkeletonDestroy', [\n                        {\n                            view: view,\n                            el: view.el\n                        }\n                    ]);\n                }\n                this.isViewUpdated = true;\n            }\n            this.requestRerender();\n        }\n    };\n    Calendar.prototype.reduce = function (state, action, calendar) {\n        return reduce(state, action, calendar);\n    };\n    // Render Queue\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.requestRerender = function (needsFull) {\n        if (needsFull === void 0) { needsFull = false; }\n        this.needsRerender = true;\n        this.needsFullRerender = this.needsFullRerender || needsFull;\n        this.delayedRerender(); // will call a debounced-version of tryRerender\n    };\n    Calendar.prototype.tryRerender = function () {\n        if (this.component && // must be accepting renders\n            this.needsRerender && // indicates that a rerender was requested\n            !this.renderingPauseDepth && // not paused\n            !this.isRendering // not currently in the render loop\n        ) {\n            this.executeRender();\n        }\n    };\n    Calendar.prototype.batchRendering = function (func) {\n        this.renderingPauseDepth++;\n        func();\n        this.renderingPauseDepth--;\n        if (this.needsRerender) {\n            this.requestRerender();\n        }\n    };\n    // Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.executeRender = function () {\n        var needsFullRerender = this.needsFullRerender; // save before clearing\n        // clear these BEFORE the render so that new values will accumulate during render\n        this.needsRerender = false;\n        this.needsFullRerender = false;\n        this.isRendering = true;\n        this.renderComponent(needsFullRerender);\n        this.isRendering = false;\n        // received a rerender request while rendering\n        if (this.needsRerender) {\n            this.delayedRerender();\n        }\n    };\n    /*\n    don't call this directly. use executeRender instead\n    */\n    Calendar.prototype.renderComponent = function (needsFull) {\n        var _a = this, state = _a.state, component = _a.component;\n        var viewType = state.viewType;\n        var viewSpec = this.viewSpecs[viewType];\n        var savedScroll = (needsFull && component) ? component.view.queryScroll() : null;\n        if (!viewSpec) {\n            throw new Error(\"View type \\\"\" + viewType + \"\\\" is not valid\");\n        }\n        // if event sources are still loading and progressive rendering hasn't been enabled,\n        // keep rendering the last fully loaded set of events\n        var renderableEventStore = this.renderableEventStore =\n            (state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering')) ?\n                this.renderableEventStore :\n                state.eventStore;\n        var eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options);\n        var eventUiBySource = this.buildEventUiBySource(state.eventSources);\n        var eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n        if (needsFull || !component) {\n            if (component) {\n                component.freezeHeight(); // next component will unfreeze it\n                component.destroy();\n            }\n            component = this.component = new CalendarComponent({\n                calendar: this,\n                view: null,\n                dateEnv: this.dateEnv,\n                theme: this.theme,\n                options: this.optionsManager.computed\n            }, this.el);\n            this.isViewUpdated = true;\n            this.isDatesUpdated = true;\n            this.isEventsUpdated = true;\n        }\n        component.receiveProps(__assign({}, state, { viewSpec: viewSpec, dateProfile: state.dateProfile, dateProfileGenerator: this.dateProfileGenerators[viewType], eventStore: renderableEventStore, eventUiBases: eventUiBases, dateSelection: state.dateSelection, eventSelection: state.eventSelection, eventDrag: state.eventDrag, eventResize: state.eventResize }));\n        if (savedScroll) {\n            component.view.applyScroll(savedScroll, false);\n        }\n        if (this.isViewUpdated) {\n            this.isViewUpdated = false;\n            this.publiclyTrigger('viewSkeletonRender', [\n                {\n                    view: component.view,\n                    el: component.view.el\n                }\n            ]);\n        }\n        if (this.isDatesUpdated) {\n            this.isDatesUpdated = false;\n            this.publiclyTrigger('datesRender', [\n                {\n                    view: component.view,\n                    el: component.view.el\n                }\n            ]);\n        }\n        if (this.isEventsUpdated) {\n            this.isEventsUpdated = false;\n        }\n        this.releaseAfterSizingTriggers();\n    };\n    // Options\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.setOption = function (name, val) {\n        var _a;\n        this.mutateOptions((_a = {}, _a[name] = val, _a), [], true);\n    };\n    Calendar.prototype.getOption = function (name) {\n        return this.optionsManager.computed[name];\n    };\n    Calendar.prototype.opt = function (name) {\n        return this.optionsManager.computed[name];\n    };\n    Calendar.prototype.viewOpt = function (name) {\n        return this.viewOpts()[name];\n    };\n    Calendar.prototype.viewOpts = function () {\n        return this.viewSpecs[this.state.viewType].options;\n    };\n    /*\n    handles option changes (like a diff)\n    */\n    Calendar.prototype.mutateOptions = function (updates, removals, isDynamic, deepEqual) {\n        var _this = this;\n        var changeHandlers = this.pluginSystem.hooks.optionChangeHandlers;\n        var normalUpdates = {};\n        var specialUpdates = {};\n        var oldDateEnv = this.dateEnv; // do this before handleOptions\n        var isTimeZoneDirty = false;\n        var isSizeDirty = false;\n        var anyDifficultOptions = Boolean(removals.length);\n        for (var name_1 in updates) {\n            if (changeHandlers[name_1]) {\n                specialUpdates[name_1] = updates[name_1];\n            }\n            else {\n                normalUpdates[name_1] = updates[name_1];\n            }\n        }\n        for (var name_2 in normalUpdates) {\n            if (/^(height|contentHeight|aspectRatio)$/.test(name_2)) {\n                isSizeDirty = true;\n            }\n            else if (/^(defaultDate|defaultView)$/.test(name_2)) ;\n            else {\n                anyDifficultOptions = true;\n                if (name_2 === 'timeZone') {\n                    isTimeZoneDirty = true;\n                }\n            }\n        }\n        this.optionsManager.mutate(normalUpdates, removals, isDynamic);\n        if (anyDifficultOptions) {\n            this.handleOptions(this.optionsManager.computed);\n            this.needsFullRerender = true;\n        }\n        this.batchRendering(function () {\n            if (anyDifficultOptions) {\n                if (isTimeZoneDirty) {\n                    _this.dispatch({\n                        type: 'CHANGE_TIMEZONE',\n                        oldDateEnv: oldDateEnv\n                    });\n                }\n                /* HACK\n                has the same effect as calling this.requestRerender(true)\n                but recomputes the state's dateProfile\n                */\n                _this.dispatch({\n                    type: 'SET_VIEW_TYPE',\n                    viewType: _this.state.viewType\n                });\n            }\n            else if (isSizeDirty) {\n                _this.updateSize();\n            }\n            // special updates\n            if (deepEqual) {\n                for (var name_3 in specialUpdates) {\n                    changeHandlers[name_3](specialUpdates[name_3], _this, deepEqual);\n                }\n            }\n        });\n    };\n    /*\n    rebuilds things based off of a complete set of refined options\n    */\n    Calendar.prototype.handleOptions = function (options) {\n        var _this = this;\n        var pluginHooks = this.pluginSystem.hooks;\n        this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration);\n        this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration);\n        this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay);\n        this.theme = this.buildTheme(options);\n        var available = this.parseRawLocales(options.locales);\n        this.availableRawLocales = available.map;\n        var locale = this.buildLocale(options.locale || available.defaultCode, available.map);\n        this.dateEnv = this.buildDateEnv(locale, options.timeZone, pluginHooks.namedTimeZonedImpl, options.firstDay, options.weekNumberCalculation, options.weekLabel, pluginHooks.cmdFormatter);\n        this.selectionConfig = this.buildSelectionConfig(options); // needs dateEnv. do after :(\n        // ineffecient to do every time?\n        this.viewSpecs = buildViewSpecs(pluginHooks.views, this.optionsManager);\n        // ineffecient to do every time?\n        this.dateProfileGenerators = mapHash(this.viewSpecs, function (viewSpec) {\n            return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, _this);\n        });\n    };\n    Calendar.prototype.getAvailableLocaleCodes = function () {\n        return Object.keys(this.availableRawLocales);\n    };\n    Calendar.prototype._buildSelectionConfig = function (rawOpts) {\n        return processScopedUiProps('select', rawOpts, this);\n    };\n    Calendar.prototype._buildEventUiSingleBase = function (rawOpts) {\n        if (rawOpts.editable) { // so 'editable' affected events\n            rawOpts = __assign({}, rawOpts, { eventEditable: true });\n        }\n        return processScopedUiProps('event', rawOpts, this);\n    };\n    // Trigger\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.hasPublicHandlers = function (name) {\n        return this.hasHandlers(name) ||\n            this.opt(name); // handler specified in options\n    };\n    Calendar.prototype.publiclyTrigger = function (name, args) {\n        var optHandler = this.opt(name);\n        this.triggerWith(name, this, args);\n        if (optHandler) {\n            return optHandler.apply(this, args);\n        }\n    };\n    Calendar.prototype.publiclyTriggerAfterSizing = function (name, args) {\n        var afterSizingTriggers = this.afterSizingTriggers;\n        (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args);\n    };\n    Calendar.prototype.releaseAfterSizingTriggers = function () {\n        var afterSizingTriggers = this.afterSizingTriggers;\n        for (var name_4 in afterSizingTriggers) {\n            for (var _i = 0, _a = afterSizingTriggers[name_4]; _i < _a.length; _i++) {\n                var args = _a[_i];\n                this.publiclyTrigger(name_4, args);\n            }\n        }\n        this.afterSizingTriggers = {};\n    };\n    // View\n    // -----------------------------------------------------------------------------------------------------------------\n    // Returns a boolean about whether the view is okay to instantiate at some point\n    Calendar.prototype.isValidViewType = function (viewType) {\n        return Boolean(this.viewSpecs[viewType]);\n    };\n    Calendar.prototype.changeView = function (viewType, dateOrRange) {\n        var dateMarker = null;\n        if (dateOrRange) {\n            if (dateOrRange.start && dateOrRange.end) { // a range\n                this.optionsManager.mutate({ visibleRange: dateOrRange }, []); // will not rerender\n                this.handleOptions(this.optionsManager.computed); // ...but yuck\n            }\n            else { // a date\n                dateMarker = this.dateEnv.createMarker(dateOrRange); // just like gotoDate\n            }\n        }\n        this.unselect();\n        this.dispatch({\n            type: 'SET_VIEW_TYPE',\n            viewType: viewType,\n            dateMarker: dateMarker\n        });\n    };\n    // Forces navigation to a view for the given date.\n    // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\n    // needs to change\n    Calendar.prototype.zoomTo = function (dateMarker, viewType) {\n        var spec;\n        viewType = viewType || 'day'; // day is default zoom\n        spec = this.viewSpecs[viewType] ||\n            this.getUnitViewSpec(viewType);\n        this.unselect();\n        if (spec) {\n            this.dispatch({\n                type: 'SET_VIEW_TYPE',\n                viewType: spec.type,\n                dateMarker: dateMarker\n            });\n        }\n        else {\n            this.dispatch({\n                type: 'SET_DATE',\n                dateMarker: dateMarker\n            });\n        }\n    };\n    // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\n    // Preference is given to views that have corresponding buttons.\n    Calendar.prototype.getUnitViewSpec = function (unit) {\n        var component = this.component;\n        var viewTypes = [];\n        var i;\n        var spec;\n        // put views that have buttons first. there will be duplicates, but oh\n        if (component.header) {\n            viewTypes.push.apply(viewTypes, component.header.viewsWithButtons);\n        }\n        if (component.footer) {\n            viewTypes.push.apply(viewTypes, component.footer.viewsWithButtons);\n        }\n        for (var viewType in this.viewSpecs) {\n            viewTypes.push(viewType);\n        }\n        for (i = 0; i < viewTypes.length; i++) {\n            spec = this.viewSpecs[viewTypes[i]];\n            if (spec) {\n                if (spec.singleUnit === unit) {\n                    return spec;\n                }\n            }\n        }\n    };\n    // Current Date\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.getInitialDate = function () {\n        var defaultDateInput = this.opt('defaultDate');\n        // compute the initial ambig-timezone date\n        if (defaultDateInput != null) {\n            return this.dateEnv.createMarker(defaultDateInput);\n        }\n        else {\n            return this.getNow(); // getNow already returns unzoned\n        }\n    };\n    Calendar.prototype.prev = function () {\n        this.unselect();\n        this.dispatch({ type: 'PREV' });\n    };\n    Calendar.prototype.next = function () {\n        this.unselect();\n        this.dispatch({ type: 'NEXT' });\n    };\n    Calendar.prototype.prevYear = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\n        });\n    };\n    Calendar.prototype.nextYear = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\n        });\n    };\n    Calendar.prototype.today = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.getNow()\n        });\n    };\n    Calendar.prototype.gotoDate = function (zonedDateInput) {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.createMarker(zonedDateInput)\n        });\n    };\n    Calendar.prototype.incrementDate = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // else, warn about invalid input?\n            this.unselect();\n            this.dispatch({\n                type: 'SET_DATE',\n                dateMarker: this.dateEnv.add(this.state.currentDate, delta)\n            });\n        }\n    };\n    // for external API\n    Calendar.prototype.getDate = function () {\n        return this.dateEnv.toDate(this.state.currentDate);\n    };\n    // Date Formatting Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.formatDate = function (d, formatter) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.format(dateEnv.createMarker(d), createFormatter(formatter));\n    };\n    // `settings` is for formatter AND isEndExclusive\n    Calendar.prototype.formatRange = function (d0, d1, settings) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.formatRange(dateEnv.createMarker(d0), dateEnv.createMarker(d1), createFormatter(settings, this.opt('defaultRangeSeparator')), settings);\n    };\n    Calendar.prototype.formatIso = function (d, omitTime) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.formatIso(dateEnv.createMarker(d), { omitTime: omitTime });\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.windowResize = function (ev) {\n        if (!this.isHandlingWindowResize &&\n            this.component && // why?\n            ev.target === window // not a jqui resize event\n        ) {\n            this.isHandlingWindowResize = true;\n            this.updateSize();\n            this.publiclyTrigger('windowResize', [this.view]);\n            this.isHandlingWindowResize = false;\n        }\n    };\n    Calendar.prototype.updateSize = function () {\n        if (this.component) { // when?\n            this.component.updateSize(true);\n        }\n    };\n    // Component Registration\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.registerInteractiveComponent = function (component, settingsInput) {\n        var settings = parseInteractionSettings(component, settingsInput);\n        var DEFAULT_INTERACTIONS = [\n            EventClicking,\n            EventHovering\n        ];\n        var interactionClasses = DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);\n        var interactions = interactionClasses.map(function (interactionClass) {\n            return new interactionClass(settings);\n        });\n        this.interactionsStore[component.uid] = interactions;\n        interactionSettingsStore[component.uid] = settings;\n    };\n    Calendar.prototype.unregisterInteractiveComponent = function (component) {\n        for (var _i = 0, _a = this.interactionsStore[component.uid]; _i < _a.length; _i++) {\n            var listener = _a[_i];\n            listener.destroy();\n        }\n        delete this.interactionsStore[component.uid];\n        delete interactionSettingsStore[component.uid];\n    };\n    // Date Selection / Event Selection / DayClick\n    // -----------------------------------------------------------------------------------------------------------------\n    // this public method receives start/end dates in any format, with any timezone\n    // NOTE: args were changed from v3\n    Calendar.prototype.select = function (dateOrObj, endDate) {\n        var selectionInput;\n        if (endDate == null) {\n            if (dateOrObj.start != null) {\n                selectionInput = dateOrObj;\n            }\n            else {\n                selectionInput = {\n                    start: dateOrObj,\n                    end: null\n                };\n            }\n        }\n        else {\n            selectionInput = {\n                start: dateOrObj,\n                end: endDate\n            };\n        }\n        var selection = parseDateSpan(selectionInput, this.dateEnv, createDuration({ days: 1 }) // TODO: cache this?\n        );\n        if (selection) { // throw parse error otherwise?\n            this.dispatch({ type: 'SELECT_DATES', selection: selection });\n            this.triggerDateSelect(selection);\n        }\n    };\n    // public method\n    Calendar.prototype.unselect = function (pev) {\n        if (this.state.dateSelection) {\n            this.dispatch({ type: 'UNSELECT_DATES' });\n            this.triggerDateUnselect(pev);\n        }\n    };\n    Calendar.prototype.triggerDateSelect = function (selection, pev) {\n        var arg = __assign({}, this.buildDateSpanApi(selection), { jsEvent: pev ? pev.origEvent : null, view: this.view });\n        this.publiclyTrigger('select', [arg]);\n    };\n    Calendar.prototype.triggerDateUnselect = function (pev) {\n        this.publiclyTrigger('unselect', [\n            {\n                jsEvent: pev ? pev.origEvent : null,\n                view: this.view\n            }\n        ]);\n    };\n    // TODO: receive pev?\n    Calendar.prototype.triggerDateClick = function (dateSpan, dayEl, view, ev) {\n        var arg = __assign({}, this.buildDatePointApi(dateSpan), { dayEl: dayEl, jsEvent: ev, // Is this always a mouse event? See #4655\n            view: view });\n        this.publiclyTrigger('dateClick', [arg]);\n    };\n    Calendar.prototype.buildDatePointApi = function (dateSpan) {\n        var props = {};\n        for (var _i = 0, _a = this.pluginSystem.hooks.datePointTransforms; _i < _a.length; _i++) {\n            var transform = _a[_i];\n            __assign(props, transform(dateSpan, this));\n        }\n        __assign(props, buildDatePointApi(dateSpan, this.dateEnv));\n        return props;\n    };\n    Calendar.prototype.buildDateSpanApi = function (dateSpan) {\n        var props = {};\n        for (var _i = 0, _a = this.pluginSystem.hooks.dateSpanTransforms; _i < _a.length; _i++) {\n            var transform = _a[_i];\n            __assign(props, transform(dateSpan, this));\n        }\n        __assign(props, buildDateSpanApi(dateSpan, this.dateEnv));\n        return props;\n    };\n    // Date Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\n    Calendar.prototype.getNow = function () {\n        var now = this.opt('now');\n        if (typeof now === 'function') {\n            now = now();\n        }\n        if (now == null) {\n            return this.dateEnv.createNowMarker();\n        }\n        return this.dateEnv.createMarker(now);\n    };\n    // Event-Date Utilities\n    // -----------------------------------------------------------------------------------------------------------------\n    // Given an event's allDay status and start date, return what its fallback end date should be.\n    // TODO: rename to computeDefaultEventEnd\n    Calendar.prototype.getDefaultEventEnd = function (allDay, marker) {\n        var end = marker;\n        if (allDay) {\n            end = startOfDay(end);\n            end = this.dateEnv.add(end, this.defaultAllDayEventDuration);\n        }\n        else {\n            end = this.dateEnv.add(end, this.defaultTimedEventDuration);\n        }\n        return end;\n    };\n    // Public Events API\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.addEvent = function (eventInput, sourceInput) {\n        if (eventInput instanceof EventApi) {\n            var def = eventInput._def;\n            var instance = eventInput._instance;\n            // not already present? don't want to add an old snapshot\n            if (!this.state.eventStore.defs[def.defId]) {\n                this.dispatch({\n                    type: 'ADD_EVENTS',\n                    eventStore: eventTupleToStore({ def: def, instance: instance }) // TODO: better util for two args?\n                });\n            }\n            return eventInput;\n        }\n        var sourceId;\n        if (sourceInput instanceof EventSourceApi) {\n            sourceId = sourceInput.internalEventSource.sourceId;\n        }\n        else if (sourceInput != null) {\n            var sourceApi = this.getEventSourceById(sourceInput); // TODO: use an internal function\n            if (!sourceApi) {\n                console.warn('Could not find an event source with ID \"' + sourceInput + '\"'); // TODO: test\n                return null;\n            }\n            else {\n                sourceId = sourceApi.internalEventSource.sourceId;\n            }\n        }\n        var tuple = parseEvent(eventInput, sourceId, this);\n        if (tuple) {\n            this.dispatch({\n                type: 'ADD_EVENTS',\n                eventStore: eventTupleToStore(tuple)\n            });\n            return new EventApi(this, tuple.def, tuple.def.recurringDef ? null : tuple.instance);\n        }\n        return null;\n    };\n    // TODO: optimize\n    Calendar.prototype.getEventById = function (id) {\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\n        id = String(id);\n        for (var defId in defs) {\n            var def = defs[defId];\n            if (def.publicId === id) {\n                if (def.recurringDef) {\n                    return new EventApi(this, def, null);\n                }\n                else {\n                    for (var instanceId in instances) {\n                        var instance = instances[instanceId];\n                        if (instance.defId === def.defId) {\n                            return new EventApi(this, def, instance);\n                        }\n                    }\n                }\n            }\n        }\n        return null;\n    };\n    Calendar.prototype.getEvents = function () {\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\n        var eventApis = [];\n        for (var id in instances) {\n            var instance = instances[id];\n            var def = defs[instance.defId];\n            eventApis.push(new EventApi(this, def, instance));\n        }\n        return eventApis;\n    };\n    Calendar.prototype.removeAllEvents = function () {\n        this.dispatch({ type: 'REMOVE_ALL_EVENTS' });\n    };\n    Calendar.prototype.rerenderEvents = function () {\n        this.dispatch({ type: 'RESET_EVENTS' });\n    };\n    // Public Event Sources API\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.getEventSources = function () {\n        var sourceHash = this.state.eventSources;\n        var sourceApis = [];\n        for (var internalId in sourceHash) {\n            sourceApis.push(new EventSourceApi(this, sourceHash[internalId]));\n        }\n        return sourceApis;\n    };\n    Calendar.prototype.getEventSourceById = function (id) {\n        var sourceHash = this.state.eventSources;\n        id = String(id);\n        for (var sourceId in sourceHash) {\n            if (sourceHash[sourceId].publicId === id) {\n                return new EventSourceApi(this, sourceHash[sourceId]);\n            }\n        }\n        return null;\n    };\n    Calendar.prototype.addEventSource = function (sourceInput) {\n        if (sourceInput instanceof EventSourceApi) {\n            // not already present? don't want to add an old snapshot\n            if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\n                this.dispatch({\n                    type: 'ADD_EVENT_SOURCES',\n                    sources: [sourceInput.internalEventSource]\n                });\n            }\n            return sourceInput;\n        }\n        var eventSource = parseEventSource(sourceInput, this);\n        if (eventSource) { // TODO: error otherwise?\n            this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: [eventSource] });\n            return new EventSourceApi(this, eventSource);\n        }\n        return null;\n    };\n    Calendar.prototype.removeAllEventSources = function () {\n        this.dispatch({ type: 'REMOVE_ALL_EVENT_SOURCES' });\n    };\n    Calendar.prototype.refetchEvents = function () {\n        this.dispatch({ type: 'FETCH_EVENT_SOURCES' });\n    };\n    // Scroll\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.scrollToTime = function (timeInput) {\n        var duration = createDuration(timeInput);\n        if (duration) {\n            this.component.view.scrollToDuration(duration);\n        }\n    };\n    return Calendar;\n}());\nEmitterMixin.mixInto(Calendar);\n// for memoizers\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildDateEnv(locale, timeZone, namedTimeZoneImpl, firstDay, weekNumberCalculation, weekLabel, cmdFormatter) {\n    return new DateEnv({\n        calendarSystem: 'gregory',\n        timeZone: timeZone,\n        namedTimeZoneImpl: namedTimeZoneImpl,\n        locale: locale,\n        weekNumberCalculation: weekNumberCalculation,\n        firstDay: firstDay,\n        weekLabel: weekLabel,\n        cmdFormatter: cmdFormatter\n    });\n}\nfunction buildTheme(calendarOptions) {\n    var themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme;\n    return new themeClass(calendarOptions);\n}\nfunction buildDelayedRerender(wait) {\n    var func = this.tryRerender.bind(this);\n    if (wait != null) {\n        func = debounce(func, wait);\n    }\n    return func;\n}\nfunction buildEventUiBySource(eventSources) {\n    return mapHash(eventSources, function (eventSource) {\n        return eventSource.ui;\n    });\n}\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n    var eventUiBases = { '': eventUiSingleBase };\n    for (var defId in eventDefs) {\n        var def = eventDefs[defId];\n        if (def.sourceId && eventUiBySource[def.sourceId]) {\n            eventUiBases[defId] = eventUiBySource[def.sourceId];\n        }\n    }\n    return eventUiBases;\n}\n\nvar View = /** @class */ (function (_super) {\n    __extends(View, _super);\n    function View(context, viewSpec, dateProfileGenerator, parentEl) {\n        var _this = _super.call(this, context, createElement('div', { className: 'fc-view fc-' + viewSpec.type + '-view' }), true // isView (HACK)\n        ) || this;\n        _this.renderDatesMem = memoizeRendering(_this.renderDatesWrap, _this.unrenderDatesWrap);\n        _this.renderBusinessHoursMem = memoizeRendering(_this.renderBusinessHours, _this.unrenderBusinessHours, [_this.renderDatesMem]);\n        _this.renderDateSelectionMem = memoizeRendering(_this.renderDateSelectionWrap, _this.unrenderDateSelectionWrap, [_this.renderDatesMem]);\n        _this.renderEventsMem = memoizeRendering(_this.renderEvents, _this.unrenderEvents, [_this.renderDatesMem]);\n        _this.renderEventSelectionMem = memoizeRendering(_this.renderEventSelectionWrap, _this.unrenderEventSelectionWrap, [_this.renderEventsMem]);\n        _this.renderEventDragMem = memoizeRendering(_this.renderEventDragWrap, _this.unrenderEventDragWrap, [_this.renderDatesMem]);\n        _this.renderEventResizeMem = memoizeRendering(_this.renderEventResizeWrap, _this.unrenderEventResizeWrap, [_this.renderDatesMem]);\n        _this.viewSpec = viewSpec;\n        _this.dateProfileGenerator = dateProfileGenerator;\n        _this.type = viewSpec.type;\n        _this.eventOrderSpecs = parseFieldSpecs(_this.opt('eventOrder'));\n        _this.nextDayThreshold = createDuration(_this.opt('nextDayThreshold'));\n        parentEl.appendChild(_this.el);\n        _this.initialize();\n        return _this;\n    }\n    View.prototype.initialize = function () {\n    };\n    Object.defineProperty(View.prototype, \"activeStart\", {\n        // Date Setting/Unsetting\n        // -----------------------------------------------------------------------------------------------------------------\n        get: function () {\n            return this.dateEnv.toDate(this.props.dateProfile.activeRange.start);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"activeEnd\", {\n        get: function () {\n            return this.dateEnv.toDate(this.props.dateProfile.activeRange.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"currentStart\", {\n        get: function () {\n            return this.dateEnv.toDate(this.props.dateProfile.currentRange.start);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"currentEnd\", {\n        get: function () {\n            return this.dateEnv.toDate(this.props.dateProfile.currentRange.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // General Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.render = function (props) {\n        this.renderDatesMem(props.dateProfile);\n        this.renderBusinessHoursMem(props.businessHours);\n        this.renderDateSelectionMem(props.dateSelection);\n        this.renderEventsMem(props.eventStore);\n        this.renderEventSelectionMem(props.eventSelection);\n        this.renderEventDragMem(props.eventDrag);\n        this.renderEventResizeMem(props.eventResize);\n    };\n    View.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.renderDatesMem.unrender(); // should unrender everything else\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n        var calendar = this.calendar;\n        if (isResize || // HACKS...\n            calendar.isViewUpdated ||\n            calendar.isDatesUpdated ||\n            calendar.isEventsUpdated) {\n            // sort of the catch-all sizing\n            // anything that might cause dimension changes\n            this.updateBaseSize(isResize, viewHeight, isAuto);\n        }\n    };\n    View.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {\n    };\n    // Date Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderDatesWrap = function (dateProfile) {\n        this.renderDates(dateProfile);\n        this.addScroll({\n            duration: createDuration(this.opt('scrollTime'))\n        });\n        this.startNowIndicator(dateProfile); // shouldn't render yet because updateSize will be called soon\n    };\n    View.prototype.unrenderDatesWrap = function () {\n        this.stopNowIndicator();\n        this.unrenderDates();\n    };\n    View.prototype.renderDates = function (dateProfile) { };\n    View.prototype.unrenderDates = function () { };\n    // Business Hours\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderBusinessHours = function (businessHours) { };\n    View.prototype.unrenderBusinessHours = function () { };\n    // Date Selection\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderDateSelectionWrap = function (selection) {\n        if (selection) {\n            this.renderDateSelection(selection);\n        }\n    };\n    View.prototype.unrenderDateSelectionWrap = function (selection) {\n        if (selection) {\n            this.unrenderDateSelection(selection);\n        }\n    };\n    View.prototype.renderDateSelection = function (selection) { };\n    View.prototype.unrenderDateSelection = function (selection) { };\n    // Event Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEvents = function (eventStore) { };\n    View.prototype.unrenderEvents = function () { };\n    // util for subclasses\n    View.prototype.sliceEvents = function (eventStore, allDay) {\n        var props = this.props;\n        return sliceEventStore(eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? this.nextDayThreshold : null).fg;\n    };\n    View.prototype.computeEventDraggable = function (eventDef, eventUi) {\n        var transformers = this.calendar.pluginSystem.hooks.isDraggableTransformers;\n        var val = eventUi.startEditable;\n        for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n            var transformer = transformers_1[_i];\n            val = transformer(val, eventDef, eventUi, this);\n        }\n        return val;\n    };\n    View.prototype.computeEventStartResizable = function (eventDef, eventUi) {\n        return eventUi.durationEditable && this.opt('eventResizableFromStart');\n    };\n    View.prototype.computeEventEndResizable = function (eventDef, eventUi) {\n        return eventUi.durationEditable;\n    };\n    // Event Selection\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventSelectionWrap = function (instanceId) {\n        if (instanceId) {\n            this.renderEventSelection(instanceId);\n        }\n    };\n    View.prototype.unrenderEventSelectionWrap = function (instanceId) {\n        if (instanceId) {\n            this.unrenderEventSelection(instanceId);\n        }\n    };\n    View.prototype.renderEventSelection = function (instanceId) { };\n    View.prototype.unrenderEventSelection = function (instanceId) { };\n    // Event Drag\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventDragWrap = function (state) {\n        if (state) {\n            this.renderEventDrag(state);\n        }\n    };\n    View.prototype.unrenderEventDragWrap = function (state) {\n        if (state) {\n            this.unrenderEventDrag(state);\n        }\n    };\n    View.prototype.renderEventDrag = function (state) { };\n    View.prototype.unrenderEventDrag = function (state) { };\n    // Event Resize\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventResizeWrap = function (state) {\n        if (state) {\n            this.renderEventResize(state);\n        }\n    };\n    View.prototype.unrenderEventResizeWrap = function (state) {\n        if (state) {\n            this.unrenderEventResize(state);\n        }\n    };\n    View.prototype.renderEventResize = function (state) { };\n    View.prototype.unrenderEventResize = function (state) { };\n    /* Now Indicator\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Immediately render the current time indicator and begins re-rendering it at an interval,\n    // which is defined by this.getNowIndicatorUnit().\n    // TODO: somehow do this for the current whole day's background too\n    View.prototype.startNowIndicator = function (dateProfile) {\n        var _this = this;\n        var dateEnv = this.dateEnv;\n        var unit;\n        var update;\n        var delay; // ms wait value\n        if (this.opt('nowIndicator')) {\n            unit = this.getNowIndicatorUnit(dateProfile);\n            if (unit) {\n                update = this.updateNowIndicator.bind(this);\n                this.initialNowDate = this.calendar.getNow();\n                this.initialNowQueriedMs = new Date().valueOf();\n                // wait until the beginning of the next interval\n                delay = dateEnv.add(dateEnv.startOf(this.initialNowDate, unit), createDuration(1, unit)).valueOf() - this.initialNowDate.valueOf();\n                // TODO: maybe always use setTimeout, waiting until start of next unit\n                this.nowIndicatorTimeoutID = setTimeout(function () {\n                    _this.nowIndicatorTimeoutID = null;\n                    update();\n                    if (unit === 'second') {\n                        delay = 1000; // every second\n                    }\n                    else {\n                        delay = 1000 * 60; // otherwise, every minute\n                    }\n                    _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval\n                }, delay);\n            }\n            // rendering will be initiated in updateSize\n        }\n    };\n    // rerenders the now indicator, computing the new current time from the amount of time that has passed\n    // since the initial getNow call.\n    View.prototype.updateNowIndicator = function () {\n        if (this.props.dateProfile && // a way to determine if dates were rendered yet\n            this.initialNowDate // activated before?\n        ) {\n            this.unrenderNowIndicator(); // won't unrender if unnecessary\n            this.renderNowIndicator(addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs));\n            this.isNowIndicatorRendered = true;\n        }\n    };\n    // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\n    // Won't cause side effects if indicator isn't rendered.\n    View.prototype.stopNowIndicator = function () {\n        if (this.isNowIndicatorRendered) {\n            if (this.nowIndicatorTimeoutID) {\n                clearTimeout(this.nowIndicatorTimeoutID);\n                this.nowIndicatorTimeoutID = null;\n            }\n            if (this.nowIndicatorIntervalID) {\n                clearInterval(this.nowIndicatorIntervalID);\n                this.nowIndicatorIntervalID = null;\n            }\n            this.unrenderNowIndicator();\n            this.isNowIndicatorRendered = false;\n        }\n    };\n    View.prototype.getNowIndicatorUnit = function (dateProfile) {\n        // subclasses should implement\n    };\n    // Renders a current time indicator at the given datetime\n    View.prototype.renderNowIndicator = function (date) {\n        // SUBCLASSES MUST PASS TO CHILDREN!\n    };\n    // Undoes the rendering actions from renderNowIndicator\n    View.prototype.unrenderNowIndicator = function () {\n        // SUBCLASSES MUST PASS TO CHILDREN!\n    };\n    /* Scroller\n    ------------------------------------------------------------------------------------------------------------------*/\n    View.prototype.addScroll = function (scroll) {\n        var queuedScroll = this.queuedScroll || (this.queuedScroll = {});\n        __assign(queuedScroll, scroll);\n    };\n    View.prototype.popScroll = function (isResize) {\n        this.applyQueuedScroll(isResize);\n        this.queuedScroll = null;\n    };\n    View.prototype.applyQueuedScroll = function (isResize) {\n        this.applyScroll(this.queuedScroll || {}, isResize);\n    };\n    View.prototype.queryScroll = function () {\n        var scroll = {};\n        if (this.props.dateProfile) { // dates rendered yet?\n            __assign(scroll, this.queryDateScroll());\n        }\n        return scroll;\n    };\n    View.prototype.applyScroll = function (scroll, isResize) {\n        var duration = scroll.duration;\n        if (duration != null) {\n            delete scroll.duration;\n            if (this.props.dateProfile) { // dates rendered yet?\n                __assign(scroll, this.computeDateScroll(duration));\n            }\n        }\n        if (this.props.dateProfile) { // dates rendered yet?\n            this.applyDateScroll(scroll);\n        }\n    };\n    View.prototype.computeDateScroll = function (duration) {\n        return {}; // subclasses must implement\n    };\n    View.prototype.queryDateScroll = function () {\n        return {}; // subclasses must implement\n    };\n    View.prototype.applyDateScroll = function (scroll) {\n        // subclasses must implement\n    };\n    // for API\n    View.prototype.scrollToDuration = function (duration) {\n        this.applyScroll({ duration: duration }, false);\n    };\n    return View;\n}(DateComponent));\nEmitterMixin.mixInto(View);\nView.prototype.usesMinMaxTime = false;\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator;\n\nvar FgEventRenderer = /** @class */ (function () {\n    function FgEventRenderer(context) {\n        this.segs = [];\n        this.isSizeDirty = false;\n        this.context = context;\n    }\n    FgEventRenderer.prototype.renderSegs = function (segs, mirrorInfo) {\n        this.rangeUpdated(); // called too frequently :(\n        // render an `.el` on each seg\n        // returns a subset of the segs. segs that were actually rendered\n        segs = this.renderSegEls(segs, mirrorInfo);\n        this.segs = segs;\n        this.attachSegs(segs, mirrorInfo);\n        this.isSizeDirty = true;\n        this.context.view.triggerRenderedSegs(this.segs, Boolean(mirrorInfo));\n    };\n    FgEventRenderer.prototype.unrender = function (_segs, mirrorInfo) {\n        this.context.view.triggerWillRemoveSegs(this.segs, Boolean(mirrorInfo));\n        this.detachSegs(this.segs);\n        this.segs = [];\n    };\n    // Updates values that rely on options and also relate to range\n    FgEventRenderer.prototype.rangeUpdated = function () {\n        var options = this.context.options;\n        var displayEventTime;\n        var displayEventEnd;\n        this.eventTimeFormat = createFormatter(options.eventTimeFormat || this.computeEventTimeFormat(), options.defaultRangeSeparator);\n        displayEventTime = options.displayEventTime;\n        if (displayEventTime == null) {\n            displayEventTime = this.computeDisplayEventTime(); // might be based off of range\n        }\n        displayEventEnd = options.displayEventEnd;\n        if (displayEventEnd == null) {\n            displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range\n        }\n        this.displayEventTime = displayEventTime;\n        this.displayEventEnd = displayEventEnd;\n    };\n    // Renders and assigns an `el` property for each foreground event segment.\n    // Only returns segments that successfully rendered.\n    FgEventRenderer.prototype.renderSegEls = function (segs, mirrorInfo) {\n        var html = '';\n        var i;\n        if (segs.length) { // don't build an empty html string\n            // build a large concatenation of event segment HTML\n            for (i = 0; i < segs.length; i++) {\n                html += this.renderSegHtml(segs[i], mirrorInfo);\n            }\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\n            // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\n            htmlToElements(html).forEach(function (el, i) {\n                var seg = segs[i];\n                if (el) {\n                    seg.el = el;\n                }\n            });\n            segs = filterSegsViaEls(this.context.view, segs, Boolean(mirrorInfo));\n        }\n        return segs;\n    };\n    // Generic utility for generating the HTML classNames for an event segment's element\n    FgEventRenderer.prototype.getSegClasses = function (seg, isDraggable, isResizable, mirrorInfo) {\n        var classes = [\n            'fc-event',\n            seg.isStart ? 'fc-start' : 'fc-not-start',\n            seg.isEnd ? 'fc-end' : 'fc-not-end'\n        ].concat(seg.eventRange.ui.classNames);\n        if (isDraggable) {\n            classes.push('fc-draggable');\n        }\n        if (isResizable) {\n            classes.push('fc-resizable');\n        }\n        if (mirrorInfo) {\n            classes.push('fc-mirror');\n            if (mirrorInfo.isDragging) {\n                classes.push('fc-dragging');\n            }\n            if (mirrorInfo.isResizing) {\n                classes.push('fc-resizing');\n            }\n        }\n        return classes;\n    };\n    // Compute the text that should be displayed on an event's element.\n    // `range` can be the Event object itself, or something range-like, with at least a `start`.\n    // If event times are disabled, or the event has no time, will return a blank string.\n    // If not specified, formatter will default to the eventTimeFormat setting,\n    // and displayEnd will default to the displayEventEnd setting.\n    FgEventRenderer.prototype.getTimeText = function (eventRange, formatter, displayEnd) {\n        var def = eventRange.def, instance = eventRange.instance;\n        return this._getTimeText(instance.range.start, def.hasEnd ? instance.range.end : null, def.allDay, formatter, displayEnd, instance.forcedStartTzo, instance.forcedEndTzo);\n    };\n    FgEventRenderer.prototype._getTimeText = function (start, end, allDay, formatter, displayEnd, forcedStartTzo, forcedEndTzo) {\n        var dateEnv = this.context.dateEnv;\n        if (formatter == null) {\n            formatter = this.eventTimeFormat;\n        }\n        if (displayEnd == null) {\n            displayEnd = this.displayEventEnd;\n        }\n        if (this.displayEventTime && !allDay) {\n            if (displayEnd && end) {\n                return dateEnv.formatRange(start, end, formatter, {\n                    forcedStartTzo: forcedStartTzo,\n                    forcedEndTzo: forcedEndTzo\n                });\n            }\n            else {\n                return dateEnv.format(start, formatter, {\n                    forcedTzo: forcedStartTzo\n                });\n            }\n        }\n        return '';\n    };\n    FgEventRenderer.prototype.computeEventTimeFormat = function () {\n        return {\n            hour: 'numeric',\n            minute: '2-digit',\n            omitZeroMinute: true\n        };\n    };\n    FgEventRenderer.prototype.computeDisplayEventTime = function () {\n        return true;\n    };\n    FgEventRenderer.prototype.computeDisplayEventEnd = function () {\n        return true;\n    };\n    // Utility for generating event skin-related CSS properties\n    FgEventRenderer.prototype.getSkinCss = function (ui) {\n        return {\n            'background-color': ui.backgroundColor,\n            'border-color': ui.borderColor,\n            color: ui.textColor\n        };\n    };\n    FgEventRenderer.prototype.sortEventSegs = function (segs) {\n        var specs = this.context.view.eventOrderSpecs;\n        var objs = segs.map(buildSegCompareObj);\n        objs.sort(function (obj0, obj1) {\n            return compareByFieldSpecs(obj0, obj1, specs);\n        });\n        return objs.map(function (c) {\n            return c._seg;\n        });\n    };\n    FgEventRenderer.prototype.computeSizes = function (force) {\n        if (force || this.isSizeDirty) {\n            this.computeSegSizes(this.segs);\n        }\n    };\n    FgEventRenderer.prototype.assignSizes = function (force) {\n        if (force || this.isSizeDirty) {\n            this.assignSegSizes(this.segs);\n            this.isSizeDirty = false;\n        }\n    };\n    FgEventRenderer.prototype.computeSegSizes = function (segs) {\n    };\n    FgEventRenderer.prototype.assignSegSizes = function (segs) {\n    };\n    // Manipulation on rendered segs\n    FgEventRenderer.prototype.hideByHash = function (hash) {\n        if (hash) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (hash[seg.eventRange.instance.instanceId]) {\n                    seg.el.style.visibility = 'hidden';\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.showByHash = function (hash) {\n        if (hash) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (hash[seg.eventRange.instance.instanceId]) {\n                    seg.el.style.visibility = '';\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.selectByInstanceId = function (instanceId) {\n        if (instanceId) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                var eventInstance = seg.eventRange.instance;\n                if (eventInstance && eventInstance.instanceId === instanceId &&\n                    seg.el // necessary?\n                ) {\n                    seg.el.classList.add('fc-selected');\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.unselectByInstanceId = function (instanceId) {\n        if (instanceId) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (seg.el) { // necessary?\n                    seg.el.classList.remove('fc-selected');\n                }\n            }\n        }\n    };\n    return FgEventRenderer;\n}());\n// returns a object with all primitive props that can be compared\nfunction buildSegCompareObj(seg) {\n    var eventDef = seg.eventRange.def;\n    var range = seg.eventRange.instance.range;\n    var start = range.start ? range.start.valueOf() : 0; // TODO: better support for open-range events\n    var end = range.end ? range.end.valueOf() : 0; // \"\n    return __assign({}, eventDef.extendedProps, eventDef, { id: eventDef.publicId, start: start,\n        end: end, duration: end - start, allDay: Number(eventDef.allDay), _seg: seg // for later retrieval\n     });\n}\n\nvar FillRenderer = /** @class */ (function () {\n    function FillRenderer(context) {\n        this.fillSegTag = 'div';\n        this.dirtySizeFlags = {};\n        this.context = context;\n        this.containerElsByType = {};\n        this.segsByType = {};\n    }\n    FillRenderer.prototype.getSegsByType = function (type) {\n        return this.segsByType[type] || [];\n    };\n    FillRenderer.prototype.renderSegs = function (type, segs) {\n        var _a;\n        var renderedSegs = this.renderSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs\n        var containerEls = this.attachSegs(type, renderedSegs);\n        if (containerEls) {\n            (_a = (this.containerElsByType[type] || (this.containerElsByType[type] = []))).push.apply(_a, containerEls);\n        }\n        this.segsByType[type] = renderedSegs;\n        if (type === 'bgEvent') {\n            this.context.view.triggerRenderedSegs(renderedSegs, false); // isMirror=false\n        }\n        this.dirtySizeFlags[type] = true;\n    };\n    // Unrenders a specific type of fill that is currently rendered on the grid\n    FillRenderer.prototype.unrender = function (type) {\n        var segs = this.segsByType[type];\n        if (segs) {\n            if (type === 'bgEvent') {\n                this.context.view.triggerWillRemoveSegs(segs, false); // isMirror=false\n            }\n            this.detachSegs(type, segs);\n        }\n    };\n    // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\n    // Only returns segments that successfully rendered.\n    FillRenderer.prototype.renderSegEls = function (type, segs) {\n        var _this = this;\n        var html = '';\n        var i;\n        if (segs.length) {\n            // build a large concatenation of segment HTML\n            for (i = 0; i < segs.length; i++) {\n                html += this.renderSegHtml(type, segs[i]);\n            }\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\n            // Then, compute the 'el' for each segment.\n            htmlToElements(html).forEach(function (el, i) {\n                var seg = segs[i];\n                if (el) {\n                    seg.el = el;\n                }\n            });\n            if (type === 'bgEvent') {\n                segs = filterSegsViaEls(this.context.view, segs, false // isMirror. background events can never be mirror elements\n                );\n            }\n            // correct element type? (would be bad if a non-TD were inserted into a table for example)\n            segs = segs.filter(function (seg) {\n                return elementMatches(seg.el, _this.fillSegTag);\n            });\n        }\n        return segs;\n    };\n    // Builds the HTML needed for one fill segment. Generic enough to work with different types.\n    FillRenderer.prototype.renderSegHtml = function (type, seg) {\n        var css = null;\n        var classNames = [];\n        if (type !== 'highlight' && type !== 'businessHours') {\n            css = {\n                'background-color': seg.eventRange.ui.backgroundColor\n            };\n        }\n        if (type !== 'highlight') {\n            classNames = classNames.concat(seg.eventRange.ui.classNames);\n        }\n        if (type === 'businessHours') {\n            classNames.push('fc-bgevent');\n        }\n        else {\n            classNames.push('fc-' + type.toLowerCase());\n        }\n        return '<' + this.fillSegTag +\n            (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') +\n            (css ? ' style=\"' + cssToStr(css) + '\"' : '') +\n            '></' + this.fillSegTag + '>';\n    };\n    FillRenderer.prototype.detachSegs = function (type, segs) {\n        var containerEls = this.containerElsByType[type];\n        if (containerEls) {\n            containerEls.forEach(removeElement);\n            delete this.containerElsByType[type];\n        }\n    };\n    FillRenderer.prototype.computeSizes = function (force) {\n        for (var type in this.segsByType) {\n            if (force || this.dirtySizeFlags[type]) {\n                this.computeSegSizes(this.segsByType[type]);\n            }\n        }\n    };\n    FillRenderer.prototype.assignSizes = function (force) {\n        for (var type in this.segsByType) {\n            if (force || this.dirtySizeFlags[type]) {\n                this.assignSegSizes(this.segsByType[type]);\n            }\n        }\n        this.dirtySizeFlags = {};\n    };\n    FillRenderer.prototype.computeSegSizes = function (segs) {\n    };\n    FillRenderer.prototype.assignSegSizes = function (segs) {\n    };\n    return FillRenderer;\n}());\n\nvar NamedTimeZoneImpl = /** @class */ (function () {\n    function NamedTimeZoneImpl(timeZoneName) {\n        this.timeZoneName = timeZoneName;\n    }\n    return NamedTimeZoneImpl;\n}());\n\n/*\nAn abstraction for a dragging interaction originating on an event.\nDoes higher-level things than PointerDragger, such as possibly:\n- a \"mirror\" that moves with the pointer\n- a minimum number of pixels or other criteria for a true drag to begin\n\nsubclasses must emit:\n- pointerdown\n- dragstart\n- dragmove\n- pointerup\n- dragend\n*/\nvar ElementDragging = /** @class */ (function () {\n    function ElementDragging(el) {\n        this.emitter = new EmitterMixin();\n    }\n    ElementDragging.prototype.destroy = function () {\n    };\n    ElementDragging.prototype.setMirrorIsVisible = function (bool) {\n        // optional if subclass doesn't want to support a mirror\n    };\n    ElementDragging.prototype.setMirrorNeedsRevert = function (bool) {\n        // optional if subclass doesn't want to support a mirror\n    };\n    ElementDragging.prototype.setAutoScrollEnabled = function (bool) {\n        // optional\n    };\n    return ElementDragging;\n}());\n\nfunction formatDate(dateInput, settings) {\n    if (settings === void 0) { settings = {}; }\n    var dateEnv = buildDateEnv$1(settings);\n    var formatter = createFormatter(settings);\n    var dateMeta = dateEnv.createMarkerMeta(dateInput);\n    if (!dateMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.format(dateMeta.marker, formatter, {\n        forcedTzo: dateMeta.forcedTzo\n    });\n}\nfunction formatRange(startInput, endInput, settings // mixture of env and formatter settings\n) {\n    var dateEnv = buildDateEnv$1(typeof settings === 'object' && settings ? settings : {}); // pass in if non-null object\n    var formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator);\n    var startMeta = dateEnv.createMarkerMeta(startInput);\n    var endMeta = dateEnv.createMarkerMeta(endInput);\n    if (!startMeta || !endMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n        forcedStartTzo: startMeta.forcedTzo,\n        forcedEndTzo: endMeta.forcedTzo,\n        isEndExclusive: settings.isEndExclusive\n    });\n}\n// TODO: more DRY and optimized\nfunction buildDateEnv$1(settings) {\n    var locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n    // ensure required settings\n    settings = __assign({ timeZone: globalDefaults.timeZone, calendarSystem: 'gregory' }, settings, { locale: locale });\n    return new DateEnv(settings);\n}\n\nvar DRAG_META_PROPS = {\n    startTime: createDuration,\n    duration: createDuration,\n    create: Boolean,\n    sourceId: String\n};\nvar DRAG_META_DEFAULTS = {\n    create: true\n};\nfunction parseDragMeta(raw) {\n    var leftoverProps = {};\n    var refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps);\n    refined.leftoverProps = leftoverProps;\n    return refined;\n}\n\n// Computes a default column header formatting string if `colFormat` is not explicitly defined\nfunction computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt) {\n    // if more than one week row, or if there are a lot of columns with not much space,\n    // put just the day numbers will be in each cell\n    if (!datesRepDistinctDays || dayCnt > 10) {\n        return { weekday: 'short' }; // \"Sat\"\n    }\n    else if (dayCnt > 1) {\n        return { weekday: 'short', month: 'numeric', day: 'numeric', omitCommas: true }; // \"Sat 11/12\"\n    }\n    else {\n        return { weekday: 'long' }; // \"Saturday\"\n    }\n}\nfunction renderDateCell(dateMarker, dateProfile, datesRepDistinctDays, colCnt, colHeadFormat, context, colspan, otherAttrs) {\n    var view = context.view, dateEnv = context.dateEnv, theme = context.theme, options = context.options;\n    var isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker); // TODO: called too frequently. cache somehow.\n    var classNames = [\n        'fc-day-header',\n        theme.getClass('widgetHeader')\n    ];\n    var innerHtml;\n    if (typeof options.columnHeaderHtml === 'function') {\n        innerHtml = options.columnHeaderHtml(dateEnv.toDate(dateMarker));\n    }\n    else if (typeof options.columnHeaderText === 'function') {\n        innerHtml = htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));\n    }\n    else {\n        innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat));\n    }\n    // if only one row of days, the classNames on the header can represent the specific days beneath\n    if (datesRepDistinctDays) {\n        classNames = classNames.concat(\n        // includes the day-of-week class\n        // noThemeHighlight=true (don't highlight the header)\n        getDayClasses(dateMarker, dateProfile, context, true));\n    }\n    else {\n        classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]); // only add the day-of-week class\n    }\n    return '' +\n        '<th class=\"' + classNames.join(' ') + '\"' +\n        ((isDateValid && datesRepDistinctDays) ?\n            ' data-date=\"' + dateEnv.formatIso(dateMarker, { omitTime: true }) + '\"' :\n            '') +\n        (colspan > 1 ?\n            ' colspan=\"' + colspan + '\"' :\n            '') +\n        (otherAttrs ?\n            ' ' + otherAttrs :\n            '') +\n        '>' +\n        (isDateValid ?\n            // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\n            buildGotoAnchorHtml(view, { date: dateMarker, forceOff: !datesRepDistinctDays || colCnt === 1 }, innerHtml) :\n            // if not valid, display text, but no link\n            innerHtml) +\n        '</th>';\n}\n\nvar DayHeader = /** @class */ (function (_super) {\n    __extends(DayHeader, _super);\n    function DayHeader(context, parentEl) {\n        var _this = _super.call(this, context) || this;\n        parentEl.innerHTML = ''; // because might be nbsp\n        parentEl.appendChild(_this.el = htmlToElement('<div class=\"fc-row ' + _this.theme.getClass('headerRow') + '\">' +\n            '<table class=\"' + _this.theme.getClass('tableGrid') + '\">' +\n            '<thead></thead>' +\n            '</table>' +\n            '</div>'));\n        _this.thead = _this.el.querySelector('thead');\n        return _this;\n    }\n    DayHeader.prototype.destroy = function () {\n        removeElement(this.el);\n    };\n    DayHeader.prototype.render = function (props) {\n        var dates = props.dates, datesRepDistinctDays = props.datesRepDistinctDays;\n        var parts = [];\n        if (props.renderIntroHtml) {\n            parts.push(props.renderIntroHtml());\n        }\n        var colHeadFormat = createFormatter(this.opt('columnHeaderFormat') ||\n            computeFallbackHeaderFormat(datesRepDistinctDays, dates.length));\n        for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\n            var date = dates_1[_i];\n            parts.push(renderDateCell(date, props.dateProfile, datesRepDistinctDays, dates.length, colHeadFormat, this.context));\n        }\n        if (this.isRtl) {\n            parts.reverse();\n        }\n        this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>';\n    };\n    return DayHeader;\n}(Component));\n\nvar DaySeries = /** @class */ (function () {\n    function DaySeries(range, dateProfileGenerator) {\n        var date = range.start;\n        var end = range.end;\n        var indices = [];\n        var dates = [];\n        var dayIndex = -1;\n        while (date < end) { // loop each day from start to end\n            if (dateProfileGenerator.isHiddenDay(date)) {\n                indices.push(dayIndex + 0.5); // mark that it's between indices\n            }\n            else {\n                dayIndex++;\n                indices.push(dayIndex);\n                dates.push(date);\n            }\n            date = addDays(date, 1);\n        }\n        this.dates = dates;\n        this.indices = indices;\n        this.cnt = dates.length;\n    }\n    DaySeries.prototype.sliceRange = function (range) {\n        var firstIndex = this.getDateDayIndex(range.start); // inclusive first index\n        var lastIndex = this.getDateDayIndex(addDays(range.end, -1)); // inclusive last index\n        var clippedFirstIndex = Math.max(0, firstIndex);\n        var clippedLastIndex = Math.min(this.cnt - 1, lastIndex);\n        // deal with in-between indices\n        clippedFirstIndex = Math.ceil(clippedFirstIndex); // in-between starts round to next cell\n        clippedLastIndex = Math.floor(clippedLastIndex); // in-between ends round to prev cell\n        if (clippedFirstIndex <= clippedLastIndex) {\n            return {\n                firstIndex: clippedFirstIndex,\n                lastIndex: clippedLastIndex,\n                isStart: firstIndex === clippedFirstIndex,\n                isEnd: lastIndex === clippedLastIndex\n            };\n        }\n        else {\n            return null;\n        }\n    };\n    // Given a date, returns its chronolocial cell-index from the first cell of the grid.\n    // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\n    // If before the first offset, returns a negative number.\n    // If after the last offset, returns an offset past the last cell offset.\n    // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\n    DaySeries.prototype.getDateDayIndex = function (date) {\n        var indices = this.indices;\n        var dayOffset = Math.floor(diffDays(this.dates[0], date));\n        if (dayOffset < 0) {\n            return indices[0] - 1;\n        }\n        else if (dayOffset >= indices.length) {\n            return indices[indices.length - 1] + 1;\n        }\n        else {\n            return indices[dayOffset];\n        }\n    };\n    return DaySeries;\n}());\n\nvar DayTable = /** @class */ (function () {\n    function DayTable(daySeries, breakOnWeeks) {\n        var dates = daySeries.dates;\n        var daysPerRow;\n        var firstDay;\n        var rowCnt;\n        if (breakOnWeeks) {\n            // count columns until the day-of-week repeats\n            firstDay = dates[0].getUTCDay();\n            for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\n                if (dates[daysPerRow].getUTCDay() === firstDay) {\n                    break;\n                }\n            }\n            rowCnt = Math.ceil(dates.length / daysPerRow);\n        }\n        else {\n            rowCnt = 1;\n            daysPerRow = dates.length;\n        }\n        this.rowCnt = rowCnt;\n        this.colCnt = daysPerRow;\n        this.daySeries = daySeries;\n        this.cells = this.buildCells();\n        this.headerDates = this.buildHeaderDates();\n    }\n    DayTable.prototype.buildCells = function () {\n        var rows = [];\n        for (var row = 0; row < this.rowCnt; row++) {\n            var cells = [];\n            for (var col = 0; col < this.colCnt; col++) {\n                cells.push(this.buildCell(row, col));\n            }\n            rows.push(cells);\n        }\n        return rows;\n    };\n    DayTable.prototype.buildCell = function (row, col) {\n        return {\n            date: this.daySeries.dates[row * this.colCnt + col]\n        };\n    };\n    DayTable.prototype.buildHeaderDates = function () {\n        var dates = [];\n        for (var col = 0; col < this.colCnt; col++) {\n            dates.push(this.cells[0][col].date);\n        }\n        return dates;\n    };\n    DayTable.prototype.sliceRange = function (range) {\n        var colCnt = this.colCnt;\n        var seriesSeg = this.daySeries.sliceRange(range);\n        var segs = [];\n        if (seriesSeg) {\n            var firstIndex = seriesSeg.firstIndex, lastIndex = seriesSeg.lastIndex;\n            var index = firstIndex;\n            while (index <= lastIndex) {\n                var row = Math.floor(index / colCnt);\n                var nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1);\n                segs.push({\n                    row: row,\n                    firstCol: index % colCnt,\n                    lastCol: (nextIndex - 1) % colCnt,\n                    isStart: seriesSeg.isStart && index === firstIndex,\n                    isEnd: seriesSeg.isEnd && (nextIndex - 1) === lastIndex\n                });\n                index = nextIndex;\n            }\n        }\n        return segs;\n    };\n    return DayTable;\n}());\n\nvar Slicer = /** @class */ (function () {\n    function Slicer() {\n        this.sliceBusinessHours = memoize(this._sliceBusinessHours);\n        this.sliceDateSelection = memoize(this._sliceDateSpan);\n        this.sliceEventStore = memoize(this._sliceEventStore);\n        this.sliceEventDrag = memoize(this._sliceInteraction);\n        this.sliceEventResize = memoize(this._sliceInteraction);\n    }\n    Slicer.prototype.sliceProps = function (props, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 4; _i < arguments.length; _i++) {\n            extraArgs[_i - 4] = arguments[_i];\n        }\n        var eventUiBases = props.eventUiBases;\n        var eventSegs = this.sliceEventStore.apply(this, [props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs));\n        return {\n            dateSelectionSegs: this.sliceDateSelection.apply(this, [props.dateSelection, eventUiBases, component].concat(extraArgs)),\n            businessHourSegs: this.sliceBusinessHours.apply(this, [props.businessHours, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n            fgEventSegs: eventSegs.fg,\n            bgEventSegs: eventSegs.bg,\n            eventDrag: this.sliceEventDrag.apply(this, [props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n            eventResize: this.sliceEventResize.apply(this, [props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n            eventSelection: props.eventSelection\n        }; // TODO: give interactionSegs?\n    };\n    Slicer.prototype.sliceNowDate = function (// does not memoize\n    date, component) {\n        var extraArgs = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            extraArgs[_i - 2] = arguments[_i];\n        }\n        return this._sliceDateSpan.apply(this, [{ range: { start: date, end: addMs(date, 1) }, allDay: false },\n            {},\n            component].concat(extraArgs));\n    };\n    Slicer.prototype._sliceBusinessHours = function (businessHours, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 4; _i < arguments.length; _i++) {\n            extraArgs[_i - 4] = arguments[_i];\n        }\n        if (!businessHours) {\n            return [];\n        }\n        return this._sliceEventStore.apply(this, [expandRecurring(businessHours, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), component.calendar),\n            {},\n            dateProfile,\n            nextDayThreshold,\n            component].concat(extraArgs)).bg;\n    };\n    Slicer.prototype._sliceEventStore = function (eventStore, eventUiBases, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        if (eventStore) {\n            var rangeRes = sliceEventStore(eventStore, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n            return {\n                bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\n                fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\n            };\n        }\n        else {\n            return { bg: [], fg: [] };\n        }\n    };\n    Slicer.prototype._sliceInteraction = function (interaction, eventUiBases, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        if (!interaction) {\n            return null;\n        }\n        var rangeRes = sliceEventStore(interaction.mutatedEvents, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n        return {\n            segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\n            affectedInstances: interaction.affectedEvents.instances,\n            isEvent: interaction.isEvent,\n            sourceSeg: interaction.origSeg\n        };\n    };\n    Slicer.prototype._sliceDateSpan = function (dateSpan, eventUiBases, component) {\n        var extraArgs = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            extraArgs[_i - 3] = arguments[_i];\n        }\n        if (!dateSpan) {\n            return [];\n        }\n        var eventRange = fabricateEventRange(dateSpan, eventUiBases, component.calendar);\n        var segs = this.sliceRange.apply(this, [dateSpan.range].concat(extraArgs));\n        for (var _a = 0, segs_1 = segs; _a < segs_1.length; _a++) {\n            var seg = segs_1[_a];\n            seg.component = component;\n            seg.eventRange = eventRange;\n        }\n        return segs;\n    };\n    /*\n    \"complete\" seg means it has component and eventRange\n    */\n    Slicer.prototype.sliceEventRanges = function (eventRanges, component, // TODO: kill\n    extraArgs) {\n        var segs = [];\n        for (var _i = 0, eventRanges_1 = eventRanges; _i < eventRanges_1.length; _i++) {\n            var eventRange = eventRanges_1[_i];\n            segs.push.apply(segs, this.sliceEventRange(eventRange, component, extraArgs));\n        }\n        return segs;\n    };\n    /*\n    \"complete\" seg means it has component and eventRange\n    */\n    Slicer.prototype.sliceEventRange = function (eventRange, component, // TODO: kill\n    extraArgs) {\n        var segs = this.sliceRange.apply(this, [eventRange.range].concat(extraArgs));\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n            var seg = segs_2[_i];\n            seg.component = component;\n            seg.eventRange = eventRange;\n            seg.isStart = eventRange.isStart && seg.isStart;\n            seg.isEnd = eventRange.isEnd && seg.isEnd;\n        }\n        return segs;\n    };\n    return Slicer;\n}());\n/*\nfor incorporating minTime/maxTime if appropriate\nTODO: should be part of DateProfile!\nTimelineDateProfile already does this btw\n*/\nfunction computeActiveRange(dateProfile, isComponentAllDay) {\n    var range = dateProfile.activeRange;\n    if (isComponentAllDay) {\n        return range;\n    }\n    return {\n        start: addMs(range.start, dateProfile.minTime.milliseconds),\n        end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\n    };\n}\n\n// exports\n// --------------------------------------------------------------------------------------------------\nvar version = '4.3.1';\n\nexport { Calendar, Component, DateComponent, DateEnv, DateProfileGenerator, DayHeader, DaySeries, DayTable, ElementDragging, ElementScrollController, EmitterMixin, EventApi, FgEventRenderer, FillRenderer, Interaction, Mixin, NamedTimeZoneImpl, PositionCache, ScrollComponent, ScrollController, Slicer, Splitter, Theme, View, WindowScrollController, addDays, addDurations, addMs, addWeeks, allowContextMenu, allowSelection, appendToElement, applyAll, applyMutationToEventStore, applyStyle, applyStyleProp, asRoughMinutes, asRoughMs, asRoughSeconds, buildGotoAnchorHtml, buildSegCompareObj, capitaliseFirstLetter, combineEventUis, compareByFieldSpec, compareByFieldSpecs, compareNumbers, compensateScroll, computeClippingRect, computeEdges, computeFallbackHeaderFormat, computeHeightAndMargins, computeInnerRect, computeRect, computeVisibleDayRange, config, constrainPoint, createDuration, createElement, createEmptyEventStore, createEventInstance, createFormatter, createPlugin, cssToStr, debounce, diffDates, diffDayAndTime, diffDays, diffPoints, diffWeeks, diffWholeDays, diffWholeWeeks, disableCursor, distributeHeight, elementClosest, elementMatches, enableCursor, eventTupleToStore, filterEventStoreDefs, filterHash, findChildren, findElements, flexibleCompare, forceClassName, formatDate, formatIsoTimeString, formatRange, getAllDayHtml, getClippingParents, getDayClasses, getElSeg, getRectCenter, getRelevantEvents, globalDefaults, greatestDurationDenominator, hasBgRendering, htmlEscape, htmlToElement, insertAfterElement, interactionSettingsStore, interactionSettingsToStore, intersectRanges, intersectRects, isArraysEqual, isDateSpansEqual, isInt, isInteractionValid, isMultiDayRange, isPropsEqual, isPropsValid, isSingleDay, isValidDate, listenBySelector, mapHash, matchCellWidths, memoize, memoizeOutput, memoizeRendering, mergeEventStores, multiplyDuration, padStart, parseBusinessHours, parseDragMeta, parseEventDef, parseFieldSpecs, parse as parseMarker, pointInsideRect, prependToElement, preventContextMenu, preventDefault, preventSelection, processScopedUiProps, rangeContainsMarker, rangeContainsRange, rangesEqual, rangesIntersect, refineProps, removeElement, removeExact, renderDateCell, requestJson, sliceEventStore, startOfDay, subtractInnerElHeight, translateRect, uncompensateScroll, undistributeHeight, unpromisify, version, whenTransitionDone, wholeDivideDurations };\n","/*\nFullCalendar React Component v4.3.0\nDocs: https://fullcalendar.io/docs/react\nLicense: MIT\n*/\nimport deepEqual from 'fast-deep-equal';\nimport { createElement, createRef, Component } from 'react';\nimport { Calendar } from '@fullcalendar/core';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\n\nvar FullCalendar = /** @class */ (function (_super) {\n    __extends(FullCalendar, _super);\n    function FullCalendar() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.elRef = createRef();\n        return _this;\n    }\n    FullCalendar.prototype.render = function () {\n        return (createElement(\"div\", { ref: this.elRef }));\n    };\n    FullCalendar.prototype.componentDidMount = function () {\n        this.calendar = new Calendar(this.elRef.current, this.props);\n        this.calendar.render();\n    };\n    FullCalendar.prototype.componentDidUpdate = function (oldProps) {\n        var props = this.props;\n        var updates = {};\n        var removals = [];\n        for (var propName in oldProps) {\n            if (!(propName in props)) {\n                removals.push(propName);\n            }\n        }\n        /*\n        Do a deep-comparison for prop changes. We do this because often times the parent component will pass in\n        an object literal that generates a new reference every time its render() function runs.\n        This isn't too much of a performance hit because normally these object literals are rather small.\n        For larger data, the parent component will almost definitely generate a new reference on every mutation,\n        because immutable prop data is the norm in React-world, making the deepEqual function execute really fast.\n        */\n        for (var propName in props) {\n            if (!deepEqual(props[propName], oldProps[propName])) {\n                updates[propName] = props[propName];\n            }\n        }\n        this.calendar.mutateOptions(updates, removals, false, deepEqual);\n    };\n    FullCalendar.prototype.componentWillUnmount = function () {\n        this.calendar.destroy();\n    };\n    FullCalendar.prototype.getApi = function () {\n        return this.calendar;\n    };\n    return FullCalendar;\n}(Component));\n\nexport default FullCalendar;\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","/*!\nFullCalendar Day Grid Plugin v4.3.0\nDocs & License: https://fullcalendar.io/\n(c) 2019 Adam Shaw\n*/\n\nimport { addWeeks, diffWeeks, DateProfileGenerator, createElement, listenBySelector, removeElement, computeRect, computeClippingRect, applyStyle, cssToStr, htmlEscape, FgEventRenderer, appendToElement, prependToElement, htmlToElement, FillRenderer, memoizeRendering, createFormatter, addDays, DateComponent, rangeContainsMarker, getDayClasses, findElements, PositionCache, buildGotoAnchorHtml, findChildren, insertAfterElement, intersectRanges, ScrollComponent, matchCellWidths, uncompensateScroll, compensateScroll, subtractInnerElHeight, distributeHeight, undistributeHeight, View, Slicer, memoize, DayHeader, DaySeries, DayTable, createPlugin } from '@fullcalendar/core';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar DayGridDateProfileGenerator = /** @class */ (function (_super) {\n    __extends(DayGridDateProfileGenerator, _super);\n    function DayGridDateProfileGenerator() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // Computes the date range that will be rendered.\n    DayGridDateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n        var dateEnv = this.dateEnv;\n        var renderRange = _super.prototype.buildRenderRange.call(this, currentRange, currentRangeUnit, isRangeAllDay);\n        var start = renderRange.start;\n        var end = renderRange.end;\n        var endOfWeek;\n        // year and month views should be aligned with weeks. this is already done for week\n        if (/^(year|month)$/.test(currentRangeUnit)) {\n            start = dateEnv.startOfWeek(start);\n            // make end-of-week if not already\n            endOfWeek = dateEnv.startOfWeek(end);\n            if (endOfWeek.valueOf() !== end.valueOf()) {\n                end = addWeeks(endOfWeek, 1);\n            }\n        }\n        // ensure 6 weeks\n        if (this.options.monthMode &&\n            this.options.fixedWeekCount) {\n            var rowCnt = Math.ceil(// could be partial weeks due to hiddenDays\n            diffWeeks(start, end));\n            end = addWeeks(end, 6 - rowCnt);\n        }\n        return { start: start, end: end };\n    };\n    return DayGridDateProfileGenerator;\n}(DateProfileGenerator));\n\n/* A rectangular panel that is absolutely positioned over other content\n------------------------------------------------------------------------------------------------------------------------\nOptions:\n  - className (string)\n  - content (HTML string, element, or element array)\n  - parentEl\n  - top\n  - left\n  - right (the x coord of where the right edge should be. not a \"CSS\" right)\n  - autoHide (boolean)\n  - show (callback)\n  - hide (callback)\n*/\nvar Popover = /** @class */ (function () {\n    function Popover(options) {\n        var _this = this;\n        this.isHidden = true;\n        this.margin = 10; // the space required between the popover and the edges of the scroll container\n        // Triggered when the user clicks *anywhere* in the document, for the autoHide feature\n        this.documentMousedown = function (ev) {\n            // only hide the popover if the click happened outside the popover\n            if (_this.el && !_this.el.contains(ev.target)) {\n                _this.hide();\n            }\n        };\n        this.options = options;\n    }\n    // Shows the popover on the specified position. Renders it if not already\n    Popover.prototype.show = function () {\n        if (this.isHidden) {\n            if (!this.el) {\n                this.render();\n            }\n            this.el.style.display = '';\n            this.position();\n            this.isHidden = false;\n            this.trigger('show');\n        }\n    };\n    // Hides the popover, through CSS, but does not remove it from the DOM\n    Popover.prototype.hide = function () {\n        if (!this.isHidden) {\n            this.el.style.display = 'none';\n            this.isHidden = true;\n            this.trigger('hide');\n        }\n    };\n    // Creates `this.el` and renders content inside of it\n    Popover.prototype.render = function () {\n        var _this = this;\n        var options = this.options;\n        var el = this.el = createElement('div', {\n            className: 'fc-popover ' + (options.className || ''),\n            style: {\n                top: '0',\n                left: '0'\n            }\n        });\n        if (typeof options.content === 'function') {\n            options.content(el);\n        }\n        options.parentEl.appendChild(el);\n        // when a click happens on anything inside with a 'fc-close' className, hide the popover\n        listenBySelector(el, 'click', '.fc-close', function (ev) {\n            _this.hide();\n        });\n        if (options.autoHide) {\n            document.addEventListener('mousedown', this.documentMousedown);\n        }\n    };\n    // Hides and unregisters any handlers\n    Popover.prototype.destroy = function () {\n        this.hide();\n        if (this.el) {\n            removeElement(this.el);\n            this.el = null;\n        }\n        document.removeEventListener('mousedown', this.documentMousedown);\n    };\n    // Positions the popover optimally, using the top/left/right options\n    Popover.prototype.position = function () {\n        var options = this.options;\n        var el = this.el;\n        var elDims = el.getBoundingClientRect(); // only used for width,height\n        var origin = computeRect(el.offsetParent);\n        var clippingRect = computeClippingRect(options.parentEl);\n        var top; // the \"position\" (not \"offset\") values for the popover\n        var left; //\n        // compute top and left\n        top = options.top || 0;\n        if (options.left !== undefined) {\n            left = options.left;\n        }\n        else if (options.right !== undefined) {\n            left = options.right - elDims.width; // derive the left value from the right value\n        }\n        else {\n            left = 0;\n        }\n        // constrain to the view port. if constrained by two edges, give precedence to top/left\n        top = Math.min(top, clippingRect.bottom - elDims.height - this.margin);\n        top = Math.max(top, clippingRect.top + this.margin);\n        left = Math.min(left, clippingRect.right - elDims.width - this.margin);\n        left = Math.max(left, clippingRect.left + this.margin);\n        applyStyle(el, {\n            top: top - origin.top,\n            left: left - origin.left\n        });\n    };\n    // Triggers a callback. Calls a function in the option hash of the same name.\n    // Arguments beyond the first `name` are forwarded on.\n    // TODO: better code reuse for this. Repeat code\n    // can kill this???\n    Popover.prototype.trigger = function (name) {\n        if (this.options[name]) {\n            this.options[name].apply(this, Array.prototype.slice.call(arguments, 1));\n        }\n    };\n    return Popover;\n}());\n\n/* Event-rendering methods for the DayGrid class\n----------------------------------------------------------------------------------------------------------------------*/\n// \"Simple\" is bad a name. has nothing to do with SimpleDayGrid\nvar SimpleDayGridEventRenderer = /** @class */ (function (_super) {\n    __extends(SimpleDayGridEventRenderer, _super);\n    function SimpleDayGridEventRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // Builds the HTML to be used for the default element for an individual segment\n    SimpleDayGridEventRenderer.prototype.renderSegHtml = function (seg, mirrorInfo) {\n        var _a = this.context, view = _a.view, options = _a.options;\n        var eventRange = seg.eventRange;\n        var eventDef = eventRange.def;\n        var eventUi = eventRange.ui;\n        var allDay = eventDef.allDay;\n        var isDraggable = view.computeEventDraggable(eventDef, eventUi);\n        var isResizableFromStart = allDay && seg.isStart && view.computeEventStartResizable(eventDef, eventUi);\n        var isResizableFromEnd = allDay && seg.isEnd && view.computeEventEndResizable(eventDef, eventUi);\n        var classes = this.getSegClasses(seg, isDraggable, isResizableFromStart || isResizableFromEnd, mirrorInfo);\n        var skinCss = cssToStr(this.getSkinCss(eventUi));\n        var timeHtml = '';\n        var timeText;\n        var titleHtml;\n        classes.unshift('fc-day-grid-event', 'fc-h-event');\n        // Only display a timed events time if it is the starting segment\n        if (seg.isStart) {\n            timeText = this.getTimeText(eventRange);\n            if (timeText) {\n                timeHtml = '<span class=\"fc-time\">' + htmlEscape(timeText) + '</span>';\n            }\n        }\n        titleHtml =\n            '<span class=\"fc-title\">' +\n                (htmlEscape(eventDef.title || '') || '&nbsp;') + // we always want one line of height\n                '</span>';\n        return '<a class=\"' + classes.join(' ') + '\"' +\n            (eventDef.url ?\n                ' href=\"' + htmlEscape(eventDef.url) + '\"' :\n                '') +\n            (skinCss ?\n                ' style=\"' + skinCss + '\"' :\n                '') +\n            '>' +\n            '<div class=\"fc-content\">' +\n            (options.dir === 'rtl' ?\n                titleHtml + ' ' + timeHtml : // put a natural space in between\n                timeHtml + ' ' + titleHtml //\n            ) +\n            '</div>' +\n            (isResizableFromStart ?\n                '<div class=\"fc-resizer fc-start-resizer\"></div>' :\n                '') +\n            (isResizableFromEnd ?\n                '<div class=\"fc-resizer fc-end-resizer\"></div>' :\n                '') +\n            '</a>';\n    };\n    // Computes a default event time formatting string if `eventTimeFormat` is not explicitly defined\n    SimpleDayGridEventRenderer.prototype.computeEventTimeFormat = function () {\n        return {\n            hour: 'numeric',\n            minute: '2-digit',\n            omitZeroMinute: true,\n            meridiem: 'narrow'\n        };\n    };\n    SimpleDayGridEventRenderer.prototype.computeDisplayEventEnd = function () {\n        return false; // TODO: somehow consider the originating DayGrid's column count\n    };\n    return SimpleDayGridEventRenderer;\n}(FgEventRenderer));\n\n/* Event-rendering methods for the DayGrid class\n----------------------------------------------------------------------------------------------------------------------*/\nvar DayGridEventRenderer = /** @class */ (function (_super) {\n    __extends(DayGridEventRenderer, _super);\n    function DayGridEventRenderer(dayGrid) {\n        var _this = _super.call(this, dayGrid.context) || this;\n        _this.dayGrid = dayGrid;\n        return _this;\n    }\n    // Renders the given foreground event segments onto the grid\n    DayGridEventRenderer.prototype.attachSegs = function (segs, mirrorInfo) {\n        var rowStructs = this.rowStructs = this.renderSegRows(segs);\n        // append to each row's content skeleton\n        this.dayGrid.rowEls.forEach(function (rowNode, i) {\n            rowNode.querySelector('.fc-content-skeleton > table').appendChild(rowStructs[i].tbodyEl);\n        });\n        // removes the \"more..\" events popover\n        if (!mirrorInfo) {\n            this.dayGrid.removeSegPopover();\n        }\n    };\n    // Unrenders all currently rendered foreground event segments\n    DayGridEventRenderer.prototype.detachSegs = function () {\n        var rowStructs = this.rowStructs || [];\n        var rowStruct;\n        while ((rowStruct = rowStructs.pop())) {\n            removeElement(rowStruct.tbodyEl);\n        }\n        this.rowStructs = null;\n    };\n    // Uses the given events array to generate <tbody> elements that should be appended to each row's content skeleton.\n    // Returns an array of rowStruct objects (see the bottom of `renderSegRow`).\n    // PRECONDITION: each segment shoud already have a rendered and assigned `.el`\n    DayGridEventRenderer.prototype.renderSegRows = function (segs) {\n        var rowStructs = [];\n        var segRows;\n        var row;\n        segRows = this.groupSegRows(segs); // group into nested arrays\n        // iterate each row of segment groupings\n        for (row = 0; row < segRows.length; row++) {\n            rowStructs.push(this.renderSegRow(row, segRows[row]));\n        }\n        return rowStructs;\n    };\n    // Given a row # and an array of segments all in the same row, render a <tbody> element, a skeleton that contains\n    // the segments. Returns object with a bunch of internal data about how the render was calculated.\n    // NOTE: modifies rowSegs\n    DayGridEventRenderer.prototype.renderSegRow = function (row, rowSegs) {\n        var dayGrid = this.dayGrid;\n        var colCnt = dayGrid.colCnt, isRtl = dayGrid.isRtl;\n        var segLevels = this.buildSegLevels(rowSegs); // group into sub-arrays of levels\n        var levelCnt = Math.max(1, segLevels.length); // ensure at least one level\n        var tbody = document.createElement('tbody');\n        var segMatrix = []; // lookup for which segments are rendered into which level+col cells\n        var cellMatrix = []; // lookup for all <td> elements of the level+col matrix\n        var loneCellMatrix = []; // lookup for <td> elements that only take up a single column\n        var i;\n        var levelSegs;\n        var col;\n        var tr;\n        var j;\n        var seg;\n        var td;\n        // populates empty cells from the current column (`col`) to `endCol`\n        function emptyCellsUntil(endCol) {\n            while (col < endCol) {\n                // try to grab a cell from the level above and extend its rowspan. otherwise, create a fresh cell\n                td = (loneCellMatrix[i - 1] || [])[col];\n                if (td) {\n                    td.rowSpan = (td.rowSpan || 1) + 1;\n                }\n                else {\n                    td = document.createElement('td');\n                    tr.appendChild(td);\n                }\n                cellMatrix[i][col] = td;\n                loneCellMatrix[i][col] = td;\n                col++;\n            }\n        }\n        for (i = 0; i < levelCnt; i++) { // iterate through all levels\n            levelSegs = segLevels[i];\n            col = 0;\n            tr = document.createElement('tr');\n            segMatrix.push([]);\n            cellMatrix.push([]);\n            loneCellMatrix.push([]);\n            // levelCnt might be 1 even though there are no actual levels. protect against this.\n            // this single empty row is useful for styling.\n            if (levelSegs) {\n                for (j = 0; j < levelSegs.length; j++) { // iterate through segments in level\n                    seg = levelSegs[j];\n                    var leftCol = isRtl ? (colCnt - 1 - seg.lastCol) : seg.firstCol;\n                    var rightCol = isRtl ? (colCnt - 1 - seg.firstCol) : seg.lastCol;\n                    emptyCellsUntil(leftCol);\n                    // create a container that occupies or more columns. append the event element.\n                    td = createElement('td', { className: 'fc-event-container' }, seg.el);\n                    if (leftCol !== rightCol) {\n                        td.colSpan = rightCol - leftCol + 1;\n                    }\n                    else { // a single-column segment\n                        loneCellMatrix[i][col] = td;\n                    }\n                    while (col <= rightCol) {\n                        cellMatrix[i][col] = td;\n                        segMatrix[i][col] = seg;\n                        col++;\n                    }\n                    tr.appendChild(td);\n                }\n            }\n            emptyCellsUntil(colCnt); // finish off the row\n            var introHtml = dayGrid.renderProps.renderIntroHtml();\n            if (introHtml) {\n                if (dayGrid.isRtl) {\n                    appendToElement(tr, introHtml);\n                }\n                else {\n                    prependToElement(tr, introHtml);\n                }\n            }\n            tbody.appendChild(tr);\n        }\n        return {\n            row: row,\n            tbodyEl: tbody,\n            cellMatrix: cellMatrix,\n            segMatrix: segMatrix,\n            segLevels: segLevels,\n            segs: rowSegs\n        };\n    };\n    // Stacks a flat array of segments, which are all assumed to be in the same row, into subarrays of vertical levels.\n    // NOTE: modifies segs\n    DayGridEventRenderer.prototype.buildSegLevels = function (segs) {\n        var _a = this.dayGrid, isRtl = _a.isRtl, colCnt = _a.colCnt;\n        var levels = [];\n        var i;\n        var seg;\n        var j;\n        // Give preference to elements with certain criteria, so they have\n        // a chance to be closer to the top.\n        segs = this.sortEventSegs(segs);\n        for (i = 0; i < segs.length; i++) {\n            seg = segs[i];\n            // loop through levels, starting with the topmost, until the segment doesn't collide with other segments\n            for (j = 0; j < levels.length; j++) {\n                if (!isDaySegCollision(seg, levels[j])) {\n                    break;\n                }\n            }\n            // `j` now holds the desired subrow index\n            seg.level = j;\n            seg.leftCol = isRtl ? (colCnt - 1 - seg.lastCol) : seg.firstCol; // for sorting only\n            seg.rightCol = isRtl ? (colCnt - 1 - seg.firstCol) : seg.lastCol // for sorting only\n            ;\n            (levels[j] || (levels[j] = [])).push(seg);\n        }\n        // order segments left-to-right. very important if calendar is RTL\n        for (j = 0; j < levels.length; j++) {\n            levels[j].sort(compareDaySegCols);\n        }\n        return levels;\n    };\n    // Given a flat array of segments, return an array of sub-arrays, grouped by each segment's row\n    DayGridEventRenderer.prototype.groupSegRows = function (segs) {\n        var segRows = [];\n        var i;\n        for (i = 0; i < this.dayGrid.rowCnt; i++) {\n            segRows.push([]);\n        }\n        for (i = 0; i < segs.length; i++) {\n            segRows[segs[i].row].push(segs[i]);\n        }\n        return segRows;\n    };\n    // Computes a default `displayEventEnd` value if one is not expliclty defined\n    DayGridEventRenderer.prototype.computeDisplayEventEnd = function () {\n        return this.dayGrid.colCnt === 1; // we'll likely have space if there's only one day\n    };\n    return DayGridEventRenderer;\n}(SimpleDayGridEventRenderer));\n// Computes whether two segments' columns collide. They are assumed to be in the same row.\nfunction isDaySegCollision(seg, otherSegs) {\n    var i;\n    var otherSeg;\n    for (i = 0; i < otherSegs.length; i++) {\n        otherSeg = otherSegs[i];\n        if (otherSeg.firstCol <= seg.lastCol &&\n            otherSeg.lastCol >= seg.firstCol) {\n            return true;\n        }\n    }\n    return false;\n}\n// A cmp function for determining the leftmost event\nfunction compareDaySegCols(a, b) {\n    return a.leftCol - b.leftCol;\n}\n\nvar DayGridMirrorRenderer = /** @class */ (function (_super) {\n    __extends(DayGridMirrorRenderer, _super);\n    function DayGridMirrorRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DayGridMirrorRenderer.prototype.attachSegs = function (segs, mirrorInfo) {\n        var sourceSeg = mirrorInfo.sourceSeg;\n        var rowStructs = this.rowStructs = this.renderSegRows(segs);\n        // inject each new event skeleton into each associated row\n        this.dayGrid.rowEls.forEach(function (rowNode, row) {\n            var skeletonEl = htmlToElement('<div class=\"fc-mirror-skeleton\"><table></table></div>'); // will be absolutely positioned\n            var skeletonTopEl;\n            var skeletonTop;\n            // If there is an original segment, match the top position. Otherwise, put it at the row's top level\n            if (sourceSeg && sourceSeg.row === row) {\n                skeletonTopEl = sourceSeg.el;\n            }\n            else {\n                skeletonTopEl = rowNode.querySelector('.fc-content-skeleton tbody');\n                if (!skeletonTopEl) { // when no events\n                    skeletonTopEl = rowNode.querySelector('.fc-content-skeleton table');\n                }\n            }\n            skeletonTop = skeletonTopEl.getBoundingClientRect().top -\n                rowNode.getBoundingClientRect().top; // the offsetParent origin\n            skeletonEl.style.top = skeletonTop + 'px';\n            skeletonEl.querySelector('table').appendChild(rowStructs[row].tbodyEl);\n            rowNode.appendChild(skeletonEl);\n        });\n    };\n    return DayGridMirrorRenderer;\n}(DayGridEventRenderer));\n\nvar EMPTY_CELL_HTML = '<td style=\"pointer-events:none\"></td>';\nvar DayGridFillRenderer = /** @class */ (function (_super) {\n    __extends(DayGridFillRenderer, _super);\n    function DayGridFillRenderer(dayGrid) {\n        var _this = _super.call(this, dayGrid.context) || this;\n        _this.fillSegTag = 'td'; // override the default tag name\n        _this.dayGrid = dayGrid;\n        return _this;\n    }\n    DayGridFillRenderer.prototype.renderSegs = function (type, segs) {\n        // don't render timed background events\n        if (type === 'bgEvent') {\n            segs = segs.filter(function (seg) {\n                return seg.eventRange.def.allDay;\n            });\n        }\n        _super.prototype.renderSegs.call(this, type, segs);\n    };\n    DayGridFillRenderer.prototype.attachSegs = function (type, segs) {\n        var els = [];\n        var i;\n        var seg;\n        var skeletonEl;\n        for (i = 0; i < segs.length; i++) {\n            seg = segs[i];\n            skeletonEl = this.renderFillRow(type, seg);\n            this.dayGrid.rowEls[seg.row].appendChild(skeletonEl);\n            els.push(skeletonEl);\n        }\n        return els;\n    };\n    // Generates the HTML needed for one row of a fill. Requires the seg's el to be rendered.\n    DayGridFillRenderer.prototype.renderFillRow = function (type, seg) {\n        var dayGrid = this.dayGrid;\n        var colCnt = dayGrid.colCnt, isRtl = dayGrid.isRtl;\n        var leftCol = isRtl ? (colCnt - 1 - seg.lastCol) : seg.firstCol;\n        var rightCol = isRtl ? (colCnt - 1 - seg.firstCol) : seg.lastCol;\n        var startCol = leftCol;\n        var endCol = rightCol + 1;\n        var className;\n        var skeletonEl;\n        var trEl;\n        if (type === 'businessHours') {\n            className = 'bgevent';\n        }\n        else {\n            className = type.toLowerCase();\n        }\n        skeletonEl = htmlToElement('<div class=\"fc-' + className + '-skeleton\">' +\n            '<table><tr></tr></table>' +\n            '</div>');\n        trEl = skeletonEl.getElementsByTagName('tr')[0];\n        if (startCol > 0) {\n            appendToElement(trEl, \n            // will create (startCol + 1) td's\n            new Array(startCol + 1).join(EMPTY_CELL_HTML));\n        }\n        seg.el.colSpan = endCol - startCol;\n        trEl.appendChild(seg.el);\n        if (endCol < colCnt) {\n            appendToElement(trEl, \n            // will create (colCnt - endCol) td's\n            new Array(colCnt - endCol + 1).join(EMPTY_CELL_HTML));\n        }\n        var introHtml = dayGrid.renderProps.renderIntroHtml();\n        if (introHtml) {\n            if (dayGrid.isRtl) {\n                appendToElement(trEl, introHtml);\n            }\n            else {\n                prependToElement(trEl, introHtml);\n            }\n        }\n        return skeletonEl;\n    };\n    return DayGridFillRenderer;\n}(FillRenderer));\n\nvar DayTile = /** @class */ (function (_super) {\n    __extends(DayTile, _super);\n    function DayTile(context, el) {\n        var _this = _super.call(this, context, el) || this;\n        var eventRenderer = _this.eventRenderer = new DayTileEventRenderer(_this);\n        var renderFrame = _this.renderFrame = memoizeRendering(_this._renderFrame);\n        _this.renderFgEvents = memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer), eventRenderer.unrender.bind(eventRenderer), [renderFrame]);\n        _this.renderEventSelection = memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer), eventRenderer.unselectByInstanceId.bind(eventRenderer), [_this.renderFgEvents]);\n        _this.renderEventDrag = memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer), eventRenderer.showByHash.bind(eventRenderer), [renderFrame]);\n        _this.renderEventResize = memoizeRendering(eventRenderer.hideByHash.bind(eventRenderer), eventRenderer.showByHash.bind(eventRenderer), [renderFrame]);\n        context.calendar.registerInteractiveComponent(_this, {\n            el: _this.el,\n            useEventCenter: false\n        });\n        return _this;\n    }\n    DayTile.prototype.render = function (props) {\n        this.renderFrame(props.date);\n        this.renderFgEvents(props.fgSegs);\n        this.renderEventSelection(props.eventSelection);\n        this.renderEventDrag(props.eventDragInstances);\n        this.renderEventResize(props.eventResizeInstances);\n    };\n    DayTile.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.renderFrame.unrender(); // should unrender everything else\n        this.calendar.unregisterInteractiveComponent(this);\n    };\n    DayTile.prototype._renderFrame = function (date) {\n        var _a = this, theme = _a.theme, dateEnv = _a.dateEnv;\n        var title = dateEnv.format(date, createFormatter(this.opt('dayPopoverFormat')) // TODO: cache\n        );\n        this.el.innerHTML =\n            '<div class=\"fc-header ' + theme.getClass('popoverHeader') + '\">' +\n                '<span class=\"fc-title\">' +\n                htmlEscape(title) +\n                '</span>' +\n                '<span class=\"fc-close ' + theme.getIconClass('close') + '\"></span>' +\n                '</div>' +\n                '<div class=\"fc-body ' + theme.getClass('popoverContent') + '\">' +\n                '<div class=\"fc-event-container\"></div>' +\n                '</div>';\n        this.segContainerEl = this.el.querySelector('.fc-event-container');\n    };\n    DayTile.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n        var date = this.props.date; // HACK\n        if (positionLeft < elWidth && positionTop < elHeight) {\n            return {\n                component: this,\n                dateSpan: {\n                    allDay: true,\n                    range: { start: date, end: addDays(date, 1) }\n                },\n                dayEl: this.el,\n                rect: {\n                    left: 0,\n                    top: 0,\n                    right: elWidth,\n                    bottom: elHeight\n                },\n                layer: 1\n            };\n        }\n    };\n    return DayTile;\n}(DateComponent));\nvar DayTileEventRenderer = /** @class */ (function (_super) {\n    __extends(DayTileEventRenderer, _super);\n    function DayTileEventRenderer(dayTile) {\n        var _this = _super.call(this, dayTile.context) || this;\n        _this.dayTile = dayTile;\n        return _this;\n    }\n    DayTileEventRenderer.prototype.attachSegs = function (segs) {\n        for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n            var seg = segs_1[_i];\n            this.dayTile.segContainerEl.appendChild(seg.el);\n        }\n    };\n    DayTileEventRenderer.prototype.detachSegs = function (segs) {\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n            var seg = segs_2[_i];\n            removeElement(seg.el);\n        }\n    };\n    return DayTileEventRenderer;\n}(SimpleDayGridEventRenderer));\n\nvar DayBgRow = /** @class */ (function () {\n    function DayBgRow(context) {\n        this.context = context;\n    }\n    DayBgRow.prototype.renderHtml = function (props) {\n        var parts = [];\n        if (props.renderIntroHtml) {\n            parts.push(props.renderIntroHtml());\n        }\n        for (var _i = 0, _a = props.cells; _i < _a.length; _i++) {\n            var cell = _a[_i];\n            parts.push(renderCellHtml(cell.date, props.dateProfile, this.context, cell.htmlAttrs));\n        }\n        if (!props.cells.length) {\n            parts.push('<td class=\"fc-day ' + this.context.theme.getClass('widgetContent') + '\"></td>');\n        }\n        if (this.context.options.dir === 'rtl') {\n            parts.reverse();\n        }\n        return '<tr>' + parts.join('') + '</tr>';\n    };\n    return DayBgRow;\n}());\nfunction renderCellHtml(date, dateProfile, context, otherAttrs) {\n    var dateEnv = context.dateEnv, theme = context.theme;\n    var isDateValid = rangeContainsMarker(dateProfile.activeRange, date); // TODO: called too frequently. cache somehow.\n    var classes = getDayClasses(date, dateProfile, context);\n    classes.unshift('fc-day', theme.getClass('widgetContent'));\n    return '<td class=\"' + classes.join(' ') + '\"' +\n        (isDateValid ?\n            ' data-date=\"' + dateEnv.formatIso(date, { omitTime: true }) + '\"' :\n            '') +\n        (otherAttrs ?\n            ' ' + otherAttrs :\n            '') +\n        '></td>';\n}\n\nvar DAY_NUM_FORMAT = createFormatter({ day: 'numeric' });\nvar WEEK_NUM_FORMAT = createFormatter({ week: 'numeric' });\nvar DayGrid = /** @class */ (function (_super) {\n    __extends(DayGrid, _super);\n    function DayGrid(context, el, renderProps) {\n        var _this = _super.call(this, context, el) || this;\n        _this.bottomCoordPadding = 0; // hack for extending the hit area for the last row of the coordinate grid\n        _this.isCellSizesDirty = false;\n        var eventRenderer = _this.eventRenderer = new DayGridEventRenderer(_this);\n        var fillRenderer = _this.fillRenderer = new DayGridFillRenderer(_this);\n        _this.mirrorRenderer = new DayGridMirrorRenderer(_this);\n        var renderCells = _this.renderCells = memoizeRendering(_this._renderCells, _this._unrenderCells);\n        _this.renderBusinessHours = memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer, 'businessHours'), fillRenderer.unrender.bind(fillRenderer, 'businessHours'), [renderCells]);\n        _this.renderDateSelection = memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer, 'highlight'), fillRenderer.unrender.bind(fillRenderer, 'highlight'), [renderCells]);\n        _this.renderBgEvents = memoizeRendering(fillRenderer.renderSegs.bind(fillRenderer, 'bgEvent'), fillRenderer.unrender.bind(fillRenderer, 'bgEvent'), [renderCells]);\n        _this.renderFgEvents = memoizeRendering(eventRenderer.renderSegs.bind(eventRenderer), eventRenderer.unrender.bind(eventRenderer), [renderCells]);\n        _this.renderEventSelection = memoizeRendering(eventRenderer.selectByInstanceId.bind(eventRenderer), eventRenderer.unselectByInstanceId.bind(eventRenderer), [_this.renderFgEvents]);\n        _this.renderEventDrag = memoizeRendering(_this._renderEventDrag, _this._unrenderEventDrag, [renderCells]);\n        _this.renderEventResize = memoizeRendering(_this._renderEventResize, _this._unrenderEventResize, [renderCells]);\n        _this.renderProps = renderProps;\n        return _this;\n    }\n    DayGrid.prototype.render = function (props) {\n        var cells = props.cells;\n        this.rowCnt = cells.length;\n        this.colCnt = cells[0].length;\n        this.renderCells(cells, props.isRigid);\n        this.renderBusinessHours(props.businessHourSegs);\n        this.renderDateSelection(props.dateSelectionSegs);\n        this.renderBgEvents(props.bgEventSegs);\n        this.renderFgEvents(props.fgEventSegs);\n        this.renderEventSelection(props.eventSelection);\n        this.renderEventDrag(props.eventDrag);\n        this.renderEventResize(props.eventResize);\n        if (this.segPopoverTile) {\n            this.updateSegPopoverTile();\n        }\n    };\n    DayGrid.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.renderCells.unrender(); // will unrender everything else\n    };\n    DayGrid.prototype.getCellRange = function (row, col) {\n        var start = this.props.cells[row][col].date;\n        var end = addDays(start, 1);\n        return { start: start, end: end };\n    };\n    DayGrid.prototype.updateSegPopoverTile = function (date, segs) {\n        var ownProps = this.props;\n        this.segPopoverTile.receiveProps({\n            date: date || this.segPopoverTile.props.date,\n            fgSegs: segs || this.segPopoverTile.props.fgSegs,\n            eventSelection: ownProps.eventSelection,\n            eventDragInstances: ownProps.eventDrag ? ownProps.eventDrag.affectedInstances : null,\n            eventResizeInstances: ownProps.eventResize ? ownProps.eventResize.affectedInstances : null\n        });\n    };\n    /* Date Rendering\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype._renderCells = function (cells, isRigid) {\n        var _a = this, view = _a.view, dateEnv = _a.dateEnv;\n        var _b = this, rowCnt = _b.rowCnt, colCnt = _b.colCnt;\n        var html = '';\n        var row;\n        var col;\n        for (row = 0; row < rowCnt; row++) {\n            html += this.renderDayRowHtml(row, isRigid);\n        }\n        this.el.innerHTML = html;\n        this.rowEls = findElements(this.el, '.fc-row');\n        this.cellEls = findElements(this.el, '.fc-day, .fc-disabled-day');\n        if (this.isRtl) {\n            this.cellEls.reverse();\n        }\n        this.rowPositions = new PositionCache(this.el, this.rowEls, false, true // vertical\n        );\n        this.colPositions = new PositionCache(this.el, this.cellEls.slice(0, colCnt), // only the first row\n        true, false // horizontal\n        );\n        // trigger dayRender with each cell's element\n        for (row = 0; row < rowCnt; row++) {\n            for (col = 0; col < colCnt; col++) {\n                this.publiclyTrigger('dayRender', [\n                    {\n                        date: dateEnv.toDate(cells[row][col].date),\n                        el: this.getCellEl(row, col),\n                        view: view\n                    }\n                ]);\n            }\n        }\n        this.isCellSizesDirty = true;\n    };\n    DayGrid.prototype._unrenderCells = function () {\n        this.removeSegPopover();\n    };\n    // Generates the HTML for a single row, which is a div that wraps a table.\n    // `row` is the row number.\n    DayGrid.prototype.renderDayRowHtml = function (row, isRigid) {\n        var theme = this.theme;\n        var classes = ['fc-row', 'fc-week', theme.getClass('dayRow')];\n        if (isRigid) {\n            classes.push('fc-rigid');\n        }\n        var bgRow = new DayBgRow(this.context);\n        return '' +\n            '<div class=\"' + classes.join(' ') + '\">' +\n            '<div class=\"fc-bg\">' +\n            '<table class=\"' + theme.getClass('tableGrid') + '\">' +\n            bgRow.renderHtml({\n                cells: this.props.cells[row],\n                dateProfile: this.props.dateProfile,\n                renderIntroHtml: this.renderProps.renderBgIntroHtml\n            }) +\n            '</table>' +\n            '</div>' +\n            '<div class=\"fc-content-skeleton\">' +\n            '<table>' +\n            (this.getIsNumbersVisible() ?\n                '<thead>' +\n                    this.renderNumberTrHtml(row) +\n                    '</thead>' :\n                '') +\n            '</table>' +\n            '</div>' +\n            '</div>';\n    };\n    DayGrid.prototype.getIsNumbersVisible = function () {\n        return this.getIsDayNumbersVisible() ||\n            this.renderProps.cellWeekNumbersVisible ||\n            this.renderProps.colWeekNumbersVisible;\n    };\n    DayGrid.prototype.getIsDayNumbersVisible = function () {\n        return this.rowCnt > 1;\n    };\n    /* Grid Number Rendering\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype.renderNumberTrHtml = function (row) {\n        var intro = this.renderProps.renderNumberIntroHtml(row, this);\n        return '' +\n            '<tr>' +\n            (this.isRtl ? '' : intro) +\n            this.renderNumberCellsHtml(row) +\n            (this.isRtl ? intro : '') +\n            '</tr>';\n    };\n    DayGrid.prototype.renderNumberCellsHtml = function (row) {\n        var htmls = [];\n        var col;\n        var date;\n        for (col = 0; col < this.colCnt; col++) {\n            date = this.props.cells[row][col].date;\n            htmls.push(this.renderNumberCellHtml(date));\n        }\n        if (this.isRtl) {\n            htmls.reverse();\n        }\n        return htmls.join('');\n    };\n    // Generates the HTML for the <td>s of the \"number\" row in the DayGrid's content skeleton.\n    // The number row will only exist if either day numbers or week numbers are turned on.\n    DayGrid.prototype.renderNumberCellHtml = function (date) {\n        var _a = this, view = _a.view, dateEnv = _a.dateEnv;\n        var html = '';\n        var isDateValid = rangeContainsMarker(this.props.dateProfile.activeRange, date); // TODO: called too frequently. cache somehow.\n        var isDayNumberVisible = this.getIsDayNumbersVisible() && isDateValid;\n        var classes;\n        var weekCalcFirstDow;\n        if (!isDayNumberVisible && !this.renderProps.cellWeekNumbersVisible) {\n            // no numbers in day cell (week number must be along the side)\n            return '<td></td>'; //  will create an empty space above events :(\n        }\n        classes = getDayClasses(date, this.props.dateProfile, this.context);\n        classes.unshift('fc-day-top');\n        if (this.renderProps.cellWeekNumbersVisible) {\n            weekCalcFirstDow = dateEnv.weekDow;\n        }\n        html += '<td class=\"' + classes.join(' ') + '\"' +\n            (isDateValid ?\n                ' data-date=\"' + dateEnv.formatIso(date, { omitTime: true }) + '\"' :\n                '') +\n            '>';\n        if (this.renderProps.cellWeekNumbersVisible && (date.getUTCDay() === weekCalcFirstDow)) {\n            html += buildGotoAnchorHtml(view, { date: date, type: 'week' }, { 'class': 'fc-week-number' }, dateEnv.format(date, WEEK_NUM_FORMAT) // inner HTML\n            );\n        }\n        if (isDayNumberVisible) {\n            html += buildGotoAnchorHtml(view, date, { 'class': 'fc-day-number' }, dateEnv.format(date, DAY_NUM_FORMAT) // inner HTML\n            );\n        }\n        html += '</td>';\n        return html;\n    };\n    /* Sizing\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype.updateSize = function (isResize) {\n        var _a = this, fillRenderer = _a.fillRenderer, eventRenderer = _a.eventRenderer, mirrorRenderer = _a.mirrorRenderer;\n        if (isResize ||\n            this.isCellSizesDirty ||\n            this.view.calendar.isEventsUpdated // hack\n        ) {\n            this.buildPositionCaches();\n            this.isCellSizesDirty = false;\n        }\n        fillRenderer.computeSizes(isResize);\n        eventRenderer.computeSizes(isResize);\n        mirrorRenderer.computeSizes(isResize);\n        fillRenderer.assignSizes(isResize);\n        eventRenderer.assignSizes(isResize);\n        mirrorRenderer.assignSizes(isResize);\n    };\n    DayGrid.prototype.buildPositionCaches = function () {\n        this.buildColPositions();\n        this.buildRowPositions();\n    };\n    DayGrid.prototype.buildColPositions = function () {\n        this.colPositions.build();\n    };\n    DayGrid.prototype.buildRowPositions = function () {\n        this.rowPositions.build();\n        this.rowPositions.bottoms[this.rowCnt - 1] += this.bottomCoordPadding; // hack\n    };\n    /* Hit System\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype.positionToHit = function (leftPosition, topPosition) {\n        var _a = this, colPositions = _a.colPositions, rowPositions = _a.rowPositions;\n        var col = colPositions.leftToIndex(leftPosition);\n        var row = rowPositions.topToIndex(topPosition);\n        if (row != null && col != null) {\n            return {\n                row: row,\n                col: col,\n                dateSpan: {\n                    range: this.getCellRange(row, col),\n                    allDay: true\n                },\n                dayEl: this.getCellEl(row, col),\n                relativeRect: {\n                    left: colPositions.lefts[col],\n                    right: colPositions.rights[col],\n                    top: rowPositions.tops[row],\n                    bottom: rowPositions.bottoms[row]\n                }\n            };\n        }\n    };\n    /* Cell System\n    ------------------------------------------------------------------------------------------------------------------*/\n    // FYI: the first column is the leftmost column, regardless of date\n    DayGrid.prototype.getCellEl = function (row, col) {\n        return this.cellEls[row * this.colCnt + col];\n    };\n    /* Event Drag Visualization\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype._renderEventDrag = function (state) {\n        if (state) {\n            this.eventRenderer.hideByHash(state.affectedInstances);\n            this.fillRenderer.renderSegs('highlight', state.segs);\n        }\n    };\n    DayGrid.prototype._unrenderEventDrag = function (state) {\n        if (state) {\n            this.eventRenderer.showByHash(state.affectedInstances);\n            this.fillRenderer.unrender('highlight');\n        }\n    };\n    /* Event Resize Visualization\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype._renderEventResize = function (state) {\n        if (state) {\n            this.eventRenderer.hideByHash(state.affectedInstances);\n            this.fillRenderer.renderSegs('highlight', state.segs);\n            this.mirrorRenderer.renderSegs(state.segs, { isResizing: true, sourceSeg: state.sourceSeg });\n        }\n    };\n    DayGrid.prototype._unrenderEventResize = function (state) {\n        if (state) {\n            this.eventRenderer.showByHash(state.affectedInstances);\n            this.fillRenderer.unrender('highlight');\n            this.mirrorRenderer.unrender(state.segs, { isResizing: true, sourceSeg: state.sourceSeg });\n        }\n    };\n    /* More+ Link Popover\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGrid.prototype.removeSegPopover = function () {\n        if (this.segPopover) {\n            this.segPopover.hide(); // in handler, will call segPopover's removeElement\n        }\n    };\n    // Limits the number of \"levels\" (vertically stacking layers of events) for each row of the grid.\n    // `levelLimit` can be false (don't limit), a number, or true (should be computed).\n    DayGrid.prototype.limitRows = function (levelLimit) {\n        var rowStructs = this.eventRenderer.rowStructs || [];\n        var row; // row #\n        var rowLevelLimit;\n        for (row = 0; row < rowStructs.length; row++) {\n            this.unlimitRow(row);\n            if (!levelLimit) {\n                rowLevelLimit = false;\n            }\n            else if (typeof levelLimit === 'number') {\n                rowLevelLimit = levelLimit;\n            }\n            else {\n                rowLevelLimit = this.computeRowLevelLimit(row);\n            }\n            if (rowLevelLimit !== false) {\n                this.limitRow(row, rowLevelLimit);\n            }\n        }\n    };\n    // Computes the number of levels a row will accomodate without going outside its bounds.\n    // Assumes the row is \"rigid\" (maintains a constant height regardless of what is inside).\n    // `row` is the row number.\n    DayGrid.prototype.computeRowLevelLimit = function (row) {\n        var rowEl = this.rowEls[row]; // the containing \"fake\" row div\n        var rowBottom = rowEl.getBoundingClientRect().bottom; // relative to viewport!\n        var trEls = findChildren(this.eventRenderer.rowStructs[row].tbodyEl);\n        var i;\n        var trEl;\n        // Reveal one level <tr> at a time and stop when we find one out of bounds\n        for (i = 0; i < trEls.length; i++) {\n            trEl = trEls[i];\n            trEl.classList.remove('fc-limited'); // reset to original state (reveal)\n            if (trEl.getBoundingClientRect().bottom > rowBottom) {\n                return i;\n            }\n        }\n        return false; // should not limit at all\n    };\n    // Limits the given grid row to the maximum number of levels and injects \"more\" links if necessary.\n    // `row` is the row number.\n    // `levelLimit` is a number for the maximum (inclusive) number of levels allowed.\n    DayGrid.prototype.limitRow = function (row, levelLimit) {\n        var _this = this;\n        var _a = this, colCnt = _a.colCnt, isRtl = _a.isRtl;\n        var rowStruct = this.eventRenderer.rowStructs[row];\n        var moreNodes = []; // array of \"more\" <a> links and <td> DOM nodes\n        var col = 0; // col #, left-to-right (not chronologically)\n        var levelSegs; // array of segment objects in the last allowable level, ordered left-to-right\n        var cellMatrix; // a matrix (by level, then column) of all <td> elements in the row\n        var limitedNodes; // array of temporarily hidden level <tr> and segment <td> DOM nodes\n        var i;\n        var seg;\n        var segsBelow; // array of segment objects below `seg` in the current `col`\n        var totalSegsBelow; // total number of segments below `seg` in any of the columns `seg` occupies\n        var colSegsBelow; // array of segment arrays, below seg, one for each column (offset from segs's first column)\n        var td;\n        var rowSpan;\n        var segMoreNodes; // array of \"more\" <td> cells that will stand-in for the current seg's cell\n        var j;\n        var moreTd;\n        var moreWrap;\n        var moreLink;\n        // Iterates through empty level cells and places \"more\" links inside if need be\n        var emptyCellsUntil = function (endCol) {\n            while (col < endCol) {\n                segsBelow = _this.getCellSegs(row, col, levelLimit);\n                if (segsBelow.length) {\n                    td = cellMatrix[levelLimit - 1][col];\n                    moreLink = _this.renderMoreLink(row, col, segsBelow);\n                    moreWrap = createElement('div', null, moreLink);\n                    td.appendChild(moreWrap);\n                    moreNodes.push(moreWrap);\n                }\n                col++;\n            }\n        };\n        if (levelLimit && levelLimit < rowStruct.segLevels.length) { // is it actually over the limit?\n            levelSegs = rowStruct.segLevels[levelLimit - 1];\n            cellMatrix = rowStruct.cellMatrix;\n            limitedNodes = findChildren(rowStruct.tbodyEl).slice(levelLimit); // get level <tr> elements past the limit\n            limitedNodes.forEach(function (node) {\n                node.classList.add('fc-limited'); // hide elements and get a simple DOM-nodes array\n            });\n            // iterate though segments in the last allowable level\n            for (i = 0; i < levelSegs.length; i++) {\n                seg = levelSegs[i];\n                var leftCol = isRtl ? (colCnt - 1 - seg.lastCol) : seg.firstCol;\n                var rightCol = isRtl ? (colCnt - 1 - seg.firstCol) : seg.lastCol;\n                emptyCellsUntil(leftCol); // process empty cells before the segment\n                // determine *all* segments below `seg` that occupy the same columns\n                colSegsBelow = [];\n                totalSegsBelow = 0;\n                while (col <= rightCol) {\n                    segsBelow = this.getCellSegs(row, col, levelLimit);\n                    colSegsBelow.push(segsBelow);\n                    totalSegsBelow += segsBelow.length;\n                    col++;\n                }\n                if (totalSegsBelow) { // do we need to replace this segment with one or many \"more\" links?\n                    td = cellMatrix[levelLimit - 1][leftCol]; // the segment's parent cell\n                    rowSpan = td.rowSpan || 1;\n                    segMoreNodes = [];\n                    // make a replacement <td> for each column the segment occupies. will be one for each colspan\n                    for (j = 0; j < colSegsBelow.length; j++) {\n                        moreTd = createElement('td', { className: 'fc-more-cell', rowSpan: rowSpan });\n                        segsBelow = colSegsBelow[j];\n                        moreLink = this.renderMoreLink(row, leftCol + j, [seg].concat(segsBelow) // count seg as hidden too\n                        );\n                        moreWrap = createElement('div', null, moreLink);\n                        moreTd.appendChild(moreWrap);\n                        segMoreNodes.push(moreTd);\n                        moreNodes.push(moreTd);\n                    }\n                    td.classList.add('fc-limited');\n                    insertAfterElement(td, segMoreNodes);\n                    limitedNodes.push(td);\n                }\n            }\n            emptyCellsUntil(this.colCnt); // finish off the level\n            rowStruct.moreEls = moreNodes; // for easy undoing later\n            rowStruct.limitedEls = limitedNodes; // for easy undoing later\n        }\n    };\n    // Reveals all levels and removes all \"more\"-related elements for a grid's row.\n    // `row` is a row number.\n    DayGrid.prototype.unlimitRow = function (row) {\n        var rowStruct = this.eventRenderer.rowStructs[row];\n        if (rowStruct.moreEls) {\n            rowStruct.moreEls.forEach(removeElement);\n            rowStruct.moreEls = null;\n        }\n        if (rowStruct.limitedEls) {\n            rowStruct.limitedEls.forEach(function (limitedEl) {\n                limitedEl.classList.remove('fc-limited');\n            });\n            rowStruct.limitedEls = null;\n        }\n    };\n    // Renders an <a> element that represents hidden event element for a cell.\n    // Responsible for attaching click handler as well.\n    DayGrid.prototype.renderMoreLink = function (row, col, hiddenSegs) {\n        var _this = this;\n        var _a = this, view = _a.view, dateEnv = _a.dateEnv;\n        var a = createElement('a', { className: 'fc-more' });\n        a.innerText = this.getMoreLinkText(hiddenSegs.length);\n        a.addEventListener('click', function (ev) {\n            var clickOption = _this.opt('eventLimitClick');\n            var _col = _this.isRtl ? _this.colCnt - col - 1 : col; // HACK: props.cells has different dir system?\n            var date = _this.props.cells[row][_col].date;\n            var moreEl = ev.currentTarget;\n            var dayEl = _this.getCellEl(row, col);\n            var allSegs = _this.getCellSegs(row, col);\n            // rescope the segments to be within the cell's date\n            var reslicedAllSegs = _this.resliceDaySegs(allSegs, date);\n            var reslicedHiddenSegs = _this.resliceDaySegs(hiddenSegs, date);\n            if (typeof clickOption === 'function') {\n                // the returned value can be an atomic option\n                clickOption = _this.publiclyTrigger('eventLimitClick', [\n                    {\n                        date: dateEnv.toDate(date),\n                        allDay: true,\n                        dayEl: dayEl,\n                        moreEl: moreEl,\n                        segs: reslicedAllSegs,\n                        hiddenSegs: reslicedHiddenSegs,\n                        jsEvent: ev,\n                        view: view\n                    }\n                ]);\n            }\n            if (clickOption === 'popover') {\n                _this.showSegPopover(row, col, moreEl, reslicedAllSegs);\n            }\n            else if (typeof clickOption === 'string') { // a view name\n                view.calendar.zoomTo(date, clickOption);\n            }\n        });\n        return a;\n    };\n    // Reveals the popover that displays all events within a cell\n    DayGrid.prototype.showSegPopover = function (row, col, moreLink, segs) {\n        var _this = this;\n        var _a = this, calendar = _a.calendar, view = _a.view, theme = _a.theme;\n        var _col = this.isRtl ? this.colCnt - col - 1 : col; // HACK: props.cells has different dir system?\n        var moreWrap = moreLink.parentNode; // the <div> wrapper around the <a>\n        var topEl; // the element we want to match the top coordinate of\n        var options;\n        if (this.rowCnt === 1) {\n            topEl = view.el; // will cause the popover to cover any sort of header\n        }\n        else {\n            topEl = this.rowEls[row]; // will align with top of row\n        }\n        options = {\n            className: 'fc-more-popover ' + theme.getClass('popover'),\n            parentEl: view.el,\n            top: computeRect(topEl).top,\n            autoHide: true,\n            content: function (el) {\n                _this.segPopoverTile = new DayTile(_this.context, el);\n                _this.updateSegPopoverTile(_this.props.cells[row][_col].date, segs);\n            },\n            hide: function () {\n                _this.segPopoverTile.destroy();\n                _this.segPopoverTile = null;\n                _this.segPopover.destroy();\n                _this.segPopover = null;\n            }\n        };\n        // Determine horizontal coordinate.\n        // We use the moreWrap instead of the <td> to avoid border confusion.\n        if (this.isRtl) {\n            options.right = computeRect(moreWrap).right + 1; // +1 to be over cell border\n        }\n        else {\n            options.left = computeRect(moreWrap).left - 1; // -1 to be over cell border\n        }\n        this.segPopover = new Popover(options);\n        this.segPopover.show();\n        calendar.releaseAfterSizingTriggers(); // hack for eventPositioned\n    };\n    // Given the events within an array of segment objects, reslice them to be in a single day\n    DayGrid.prototype.resliceDaySegs = function (segs, dayDate) {\n        var dayStart = dayDate;\n        var dayEnd = addDays(dayStart, 1);\n        var dayRange = { start: dayStart, end: dayEnd };\n        var newSegs = [];\n        for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n            var seg = segs_1[_i];\n            var eventRange = seg.eventRange;\n            var origRange = eventRange.range;\n            var slicedRange = intersectRanges(origRange, dayRange);\n            if (slicedRange) {\n                newSegs.push(__assign({}, seg, { eventRange: {\n                        def: eventRange.def,\n                        ui: __assign({}, eventRange.ui, { durationEditable: false }),\n                        instance: eventRange.instance,\n                        range: slicedRange\n                    }, isStart: seg.isStart && slicedRange.start.valueOf() === origRange.start.valueOf(), isEnd: seg.isEnd && slicedRange.end.valueOf() === origRange.end.valueOf() }));\n            }\n        }\n        return newSegs;\n    };\n    // Generates the text that should be inside a \"more\" link, given the number of events it represents\n    DayGrid.prototype.getMoreLinkText = function (num) {\n        var opt = this.opt('eventLimitText');\n        if (typeof opt === 'function') {\n            return opt(num);\n        }\n        else {\n            return '+' + num + ' ' + opt;\n        }\n    };\n    // Returns segments within a given cell.\n    // If `startLevel` is specified, returns only events including and below that level. Otherwise returns all segs.\n    DayGrid.prototype.getCellSegs = function (row, col, startLevel) {\n        var segMatrix = this.eventRenderer.rowStructs[row].segMatrix;\n        var level = startLevel || 0;\n        var segs = [];\n        var seg;\n        while (level < segMatrix.length) {\n            seg = segMatrix[level][col];\n            if (seg) {\n                segs.push(seg);\n            }\n            level++;\n        }\n        return segs;\n    };\n    return DayGrid;\n}(DateComponent));\n\nvar WEEK_NUM_FORMAT$1 = createFormatter({ week: 'numeric' });\n/* An abstract class for the daygrid views, as well as month view. Renders one or more rows of day cells.\n----------------------------------------------------------------------------------------------------------------------*/\n// It is a manager for a DayGrid subcomponent, which does most of the heavy lifting.\n// It is responsible for managing width/height.\nvar DayGridView = /** @class */ (function (_super) {\n    __extends(DayGridView, _super);\n    function DayGridView(context, viewSpec, dateProfileGenerator, parentEl) {\n        var _this = _super.call(this, context, viewSpec, dateProfileGenerator, parentEl) || this;\n        /* Header Rendering\n        ------------------------------------------------------------------------------------------------------------------*/\n        // Generates the HTML that will go before the day-of week header cells\n        _this.renderHeadIntroHtml = function () {\n            var theme = _this.theme;\n            if (_this.colWeekNumbersVisible) {\n                return '' +\n                    '<th class=\"fc-week-number ' + theme.getClass('widgetHeader') + '\" ' + _this.weekNumberStyleAttr() + '>' +\n                    '<span>' + // needed for matchCellWidths\n                    htmlEscape(_this.opt('weekLabel')) +\n                    '</span>' +\n                    '</th>';\n            }\n            return '';\n        };\n        /* Day Grid Rendering\n        ------------------------------------------------------------------------------------------------------------------*/\n        // Generates the HTML that will go before content-skeleton cells that display the day/week numbers\n        _this.renderDayGridNumberIntroHtml = function (row, dayGrid) {\n            var dateEnv = _this.dateEnv;\n            var weekStart = dayGrid.props.cells[row][0].date;\n            if (_this.colWeekNumbersVisible) {\n                return '' +\n                    '<td class=\"fc-week-number\" ' + _this.weekNumberStyleAttr() + '>' +\n                    buildGotoAnchorHtml(// aside from link, important for matchCellWidths\n                    _this, { date: weekStart, type: 'week', forceOff: dayGrid.colCnt === 1 }, dateEnv.format(weekStart, WEEK_NUM_FORMAT$1) // inner HTML\n                    ) +\n                    '</td>';\n            }\n            return '';\n        };\n        // Generates the HTML that goes before the day bg cells for each day-row\n        _this.renderDayGridBgIntroHtml = function () {\n            var theme = _this.theme;\n            if (_this.colWeekNumbersVisible) {\n                return '<td class=\"fc-week-number ' + theme.getClass('widgetContent') + '\" ' + _this.weekNumberStyleAttr() + '></td>';\n            }\n            return '';\n        };\n        // Generates the HTML that goes before every other type of row generated by DayGrid.\n        // Affects mirror-skeleton and highlight-skeleton rows.\n        _this.renderDayGridIntroHtml = function () {\n            if (_this.colWeekNumbersVisible) {\n                return '<td class=\"fc-week-number\" ' + _this.weekNumberStyleAttr() + '></td>';\n            }\n            return '';\n        };\n        _this.el.classList.add('fc-dayGrid-view');\n        _this.el.innerHTML = _this.renderSkeletonHtml();\n        _this.scroller = new ScrollComponent('hidden', // overflow x\n        'auto' // overflow y\n        );\n        var dayGridContainerEl = _this.scroller.el;\n        _this.el.querySelector('.fc-body > tr > td').appendChild(dayGridContainerEl);\n        dayGridContainerEl.classList.add('fc-day-grid-container');\n        var dayGridEl = createElement('div', { className: 'fc-day-grid' });\n        dayGridContainerEl.appendChild(dayGridEl);\n        var cellWeekNumbersVisible;\n        if (_this.opt('weekNumbers')) {\n            if (_this.opt('weekNumbersWithinDays')) {\n                cellWeekNumbersVisible = true;\n                _this.colWeekNumbersVisible = false;\n            }\n            else {\n                cellWeekNumbersVisible = false;\n                _this.colWeekNumbersVisible = true;\n            }\n        }\n        else {\n            _this.colWeekNumbersVisible = false;\n            cellWeekNumbersVisible = false;\n        }\n        _this.dayGrid = new DayGrid(_this.context, dayGridEl, {\n            renderNumberIntroHtml: _this.renderDayGridNumberIntroHtml,\n            renderBgIntroHtml: _this.renderDayGridBgIntroHtml,\n            renderIntroHtml: _this.renderDayGridIntroHtml,\n            colWeekNumbersVisible: _this.colWeekNumbersVisible,\n            cellWeekNumbersVisible: cellWeekNumbersVisible\n        });\n        return _this;\n    }\n    DayGridView.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.dayGrid.destroy();\n        this.scroller.destroy();\n    };\n    // Builds the HTML skeleton for the view.\n    // The day-grid component will render inside of a container defined by this HTML.\n    DayGridView.prototype.renderSkeletonHtml = function () {\n        var theme = this.theme;\n        return '' +\n            '<table class=\"' + theme.getClass('tableGrid') + '\">' +\n            (this.opt('columnHeader') ?\n                '<thead class=\"fc-head\">' +\n                    '<tr>' +\n                    '<td class=\"fc-head-container ' + theme.getClass('widgetHeader') + '\">&nbsp;</td>' +\n                    '</tr>' +\n                    '</thead>' :\n                '') +\n            '<tbody class=\"fc-body\">' +\n            '<tr>' +\n            '<td class=\"' + theme.getClass('widgetContent') + '\"></td>' +\n            '</tr>' +\n            '</tbody>' +\n            '</table>';\n    };\n    // Generates an HTML attribute string for setting the width of the week number column, if it is known\n    DayGridView.prototype.weekNumberStyleAttr = function () {\n        if (this.weekNumberWidth != null) {\n            return 'style=\"width:' + this.weekNumberWidth + 'px\"';\n        }\n        return '';\n    };\n    // Determines whether each row should have a constant height\n    DayGridView.prototype.hasRigidRows = function () {\n        var eventLimit = this.opt('eventLimit');\n        return eventLimit && typeof eventLimit !== 'number';\n    };\n    /* Dimensions\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGridView.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n        _super.prototype.updateSize.call(this, isResize, viewHeight, isAuto); // will call updateBaseSize. important that executes first\n        this.dayGrid.updateSize(isResize);\n    };\n    // Refreshes the horizontal dimensions of the view\n    DayGridView.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {\n        var dayGrid = this.dayGrid;\n        var eventLimit = this.opt('eventLimit');\n        var headRowEl = this.header ? this.header.el : null; // HACK\n        var scrollerHeight;\n        var scrollbarWidths;\n        // hack to give the view some height prior to dayGrid's columns being rendered\n        // TODO: separate setting height from scroller VS dayGrid.\n        if (!dayGrid.rowEls) {\n            if (!isAuto) {\n                scrollerHeight = this.computeScrollerHeight(viewHeight);\n                this.scroller.setHeight(scrollerHeight);\n            }\n            return;\n        }\n        if (this.colWeekNumbersVisible) {\n            // Make sure all week number cells running down the side have the same width.\n            this.weekNumberWidth = matchCellWidths(findElements(this.el, '.fc-week-number'));\n        }\n        // reset all heights to be natural\n        this.scroller.clear();\n        if (headRowEl) {\n            uncompensateScroll(headRowEl);\n        }\n        dayGrid.removeSegPopover(); // kill the \"more\" popover if displayed\n        // is the event limit a constant level number?\n        if (eventLimit && typeof eventLimit === 'number') {\n            dayGrid.limitRows(eventLimit); // limit the levels first so the height can redistribute after\n        }\n        // distribute the height to the rows\n        // (viewHeight is a \"recommended\" value if isAuto)\n        scrollerHeight = this.computeScrollerHeight(viewHeight);\n        this.setGridHeight(scrollerHeight, isAuto);\n        // is the event limit dynamically calculated?\n        if (eventLimit && typeof eventLimit !== 'number') {\n            dayGrid.limitRows(eventLimit); // limit the levels after the grid's row heights have been set\n        }\n        if (!isAuto) { // should we force dimensions of the scroll container?\n            this.scroller.setHeight(scrollerHeight);\n            scrollbarWidths = this.scroller.getScrollbarWidths();\n            if (scrollbarWidths.left || scrollbarWidths.right) { // using scrollbars?\n                if (headRowEl) {\n                    compensateScroll(headRowEl, scrollbarWidths);\n                }\n                // doing the scrollbar compensation might have created text overflow which created more height. redo\n                scrollerHeight = this.computeScrollerHeight(viewHeight);\n                this.scroller.setHeight(scrollerHeight);\n            }\n            // guarantees the same scrollbar widths\n            this.scroller.lockOverflow(scrollbarWidths);\n        }\n    };\n    // given a desired total height of the view, returns what the height of the scroller should be\n    DayGridView.prototype.computeScrollerHeight = function (viewHeight) {\n        return viewHeight -\n            subtractInnerElHeight(this.el, this.scroller.el); // everything that's NOT the scroller\n    };\n    // Sets the height of just the DayGrid component in this view\n    DayGridView.prototype.setGridHeight = function (height, isAuto) {\n        if (this.opt('monthMode')) {\n            // if auto, make the height of each row the height that it would be if there were 6 weeks\n            if (isAuto) {\n                height *= this.dayGrid.rowCnt / 6;\n            }\n            distributeHeight(this.dayGrid.rowEls, height, !isAuto); // if auto, don't compensate for height-hogging rows\n        }\n        else {\n            if (isAuto) {\n                undistributeHeight(this.dayGrid.rowEls); // let the rows be their natural height with no expanding\n            }\n            else {\n                distributeHeight(this.dayGrid.rowEls, height, true); // true = compensate for height-hogging rows\n            }\n        }\n    };\n    /* Scroll\n    ------------------------------------------------------------------------------------------------------------------*/\n    DayGridView.prototype.computeDateScroll = function (duration) {\n        return { top: 0 };\n    };\n    DayGridView.prototype.queryDateScroll = function () {\n        return { top: this.scroller.getScrollTop() };\n    };\n    DayGridView.prototype.applyDateScroll = function (scroll) {\n        if (scroll.top !== undefined) {\n            this.scroller.setScrollTop(scroll.top);\n        }\n    };\n    return DayGridView;\n}(View));\nDayGridView.prototype.dateProfileGeneratorClass = DayGridDateProfileGenerator;\n\nvar SimpleDayGrid = /** @class */ (function (_super) {\n    __extends(SimpleDayGrid, _super);\n    function SimpleDayGrid(context, dayGrid) {\n        var _this = _super.call(this, context, dayGrid.el) || this;\n        _this.slicer = new DayGridSlicer();\n        _this.dayGrid = dayGrid;\n        context.calendar.registerInteractiveComponent(_this, { el: _this.dayGrid.el });\n        return _this;\n    }\n    SimpleDayGrid.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.calendar.unregisterInteractiveComponent(this);\n    };\n    SimpleDayGrid.prototype.render = function (props) {\n        var dayGrid = this.dayGrid;\n        var dateProfile = props.dateProfile, dayTable = props.dayTable;\n        dayGrid.receiveProps(__assign({}, this.slicer.sliceProps(props, dateProfile, props.nextDayThreshold, dayGrid, dayTable), { dateProfile: dateProfile, cells: dayTable.cells, isRigid: props.isRigid }));\n    };\n    SimpleDayGrid.prototype.buildPositionCaches = function () {\n        this.dayGrid.buildPositionCaches();\n    };\n    SimpleDayGrid.prototype.queryHit = function (positionLeft, positionTop) {\n        var rawHit = this.dayGrid.positionToHit(positionLeft, positionTop);\n        if (rawHit) {\n            return {\n                component: this.dayGrid,\n                dateSpan: rawHit.dateSpan,\n                dayEl: rawHit.dayEl,\n                rect: {\n                    left: rawHit.relativeRect.left,\n                    right: rawHit.relativeRect.right,\n                    top: rawHit.relativeRect.top,\n                    bottom: rawHit.relativeRect.bottom\n                },\n                layer: 0\n            };\n        }\n    };\n    return SimpleDayGrid;\n}(DateComponent));\nvar DayGridSlicer = /** @class */ (function (_super) {\n    __extends(DayGridSlicer, _super);\n    function DayGridSlicer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DayGridSlicer.prototype.sliceRange = function (dateRange, dayTable) {\n        return dayTable.sliceRange(dateRange);\n    };\n    return DayGridSlicer;\n}(Slicer));\n\nvar DayGridView$1 = /** @class */ (function (_super) {\n    __extends(DayGridView, _super);\n    function DayGridView(_context, viewSpec, dateProfileGenerator, parentEl) {\n        var _this = _super.call(this, _context, viewSpec, dateProfileGenerator, parentEl) || this;\n        _this.buildDayTable = memoize(buildDayTable);\n        if (_this.opt('columnHeader')) {\n            _this.header = new DayHeader(_this.context, _this.el.querySelector('.fc-head-container'));\n        }\n        _this.simpleDayGrid = new SimpleDayGrid(_this.context, _this.dayGrid);\n        return _this;\n    }\n    DayGridView.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (this.header) {\n            this.header.destroy();\n        }\n        this.simpleDayGrid.destroy();\n    };\n    DayGridView.prototype.render = function (props) {\n        _super.prototype.render.call(this, props);\n        var dateProfile = this.props.dateProfile;\n        var dayTable = this.dayTable =\n            this.buildDayTable(dateProfile, this.dateProfileGenerator);\n        if (this.header) {\n            this.header.receiveProps({\n                dateProfile: dateProfile,\n                dates: dayTable.headerDates,\n                datesRepDistinctDays: dayTable.rowCnt === 1,\n                renderIntroHtml: this.renderHeadIntroHtml\n            });\n        }\n        this.simpleDayGrid.receiveProps({\n            dateProfile: dateProfile,\n            dayTable: dayTable,\n            businessHours: props.businessHours,\n            dateSelection: props.dateSelection,\n            eventStore: props.eventStore,\n            eventUiBases: props.eventUiBases,\n            eventSelection: props.eventSelection,\n            eventDrag: props.eventDrag,\n            eventResize: props.eventResize,\n            isRigid: this.hasRigidRows(),\n            nextDayThreshold: this.nextDayThreshold\n        });\n    };\n    return DayGridView;\n}(DayGridView));\nfunction buildDayTable(dateProfile, dateProfileGenerator) {\n    var daySeries = new DaySeries(dateProfile.renderRange, dateProfileGenerator);\n    return new DayTable(daySeries, /year|month|week/.test(dateProfile.currentRangeUnit));\n}\n\nvar main = createPlugin({\n    defaultView: 'dayGridMonth',\n    views: {\n        dayGrid: DayGridView$1,\n        dayGridDay: {\n            type: 'dayGrid',\n            duration: { days: 1 }\n        },\n        dayGridWeek: {\n            type: 'dayGrid',\n            duration: { weeks: 1 }\n        },\n        dayGridMonth: {\n            type: 'dayGrid',\n            duration: { months: 1 },\n            monthMode: true,\n            fixedWeekCount: true\n        }\n    }\n});\n\nexport default main;\nexport { DayGridView as AbstractDayGridView, DayBgRow, DayGrid, DayGridSlicer, DayGridView$1 as DayGridView, SimpleDayGrid, buildDayTable as buildBasicDayTable };\n"],"sourceRoot":""}